function yd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fl={exports:{}},_s={},bl={exports:{}},V={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mr=Symbol.for("react.element"),vd=Symbol.for("react.portal"),wd=Symbol.for("react.fragment"),xd=Symbol.for("react.strict_mode"),Sd=Symbol.for("react.profiler"),kd=Symbol.for("react.provider"),Pd=Symbol.for("react.context"),Cd=Symbol.for("react.forward_ref"),Ed=Symbol.for("react.suspense"),Nd=Symbol.for("react.memo"),Ad=Symbol.for("react.lazy"),No=Symbol.iterator;function Td(e){return e===null||typeof e!="object"?null:(e=No&&e[No]||e["@@iterator"],typeof e=="function"?e:null)}var zl={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bl=Object.assign,Ol={};function Wn(e,t,n){this.props=e,this.context=t,this.refs=Ol,this.updater=n||zl}Wn.prototype.isReactComponent={};Wn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ul(){}Ul.prototype=Wn.prototype;function wa(e,t,n){this.props=e,this.context=t,this.refs=Ol,this.updater=n||zl}var xa=wa.prototype=new Ul;xa.constructor=wa;Bl(xa,Wn.prototype);xa.isPureReactComponent=!0;var Ao=Array.isArray,Wl=Object.prototype.hasOwnProperty,Sa={current:null},$l={key:!0,ref:!0,__self:!0,__source:!0};function ql(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Wl.call(t,r)&&!$l.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Mr,type:e,key:i,ref:a,props:s,_owner:Sa.current}}function jd(e,t){return{$$typeof:Mr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ka(e){return typeof e=="object"&&e!==null&&e.$$typeof===Mr}function Md(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var To=/\/+/g;function ei(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Md(""+e.key):t.toString(36)}function Jr(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Mr:case vd:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+ei(a,0):r,Ao(s)?(n="",e!=null&&(n=e.replace(To,"$&/")+"/"),Jr(s,t,n,"",function(u){return u})):s!=null&&(ka(s)&&(s=jd(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(To,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",Ao(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+ei(i,l);a+=Jr(i,t,n,c,s)}else if(c=Td(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+ei(i,l++),a+=Jr(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function _r(e,t,n){if(e==null)return e;var r=[],s=0;return Jr(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Id(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Le={current:null},Zr={transition:null},Ld={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:Zr,ReactCurrentOwner:Sa};function Vl(){throw Error("act(...) is not supported in production builds of React.")}V.Children={map:_r,forEach:function(e,t,n){_r(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _r(e,function(){t++}),t},toArray:function(e){return _r(e,function(t){return t})||[]},only:function(e){if(!ka(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};V.Component=Wn;V.Fragment=wd;V.Profiler=Sd;V.PureComponent=wa;V.StrictMode=xd;V.Suspense=Ed;V.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ld;V.act=Vl;V.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Bl({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Sa.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Wl.call(t,c)&&!$l.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Mr,type:e.type,key:s,ref:i,props:r,_owner:a}};V.createContext=function(e){return e={$$typeof:Pd,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kd,_context:e},e.Consumer=e};V.createElement=ql;V.createFactory=function(e){var t=ql.bind(null,e);return t.type=e,t};V.createRef=function(){return{current:null}};V.forwardRef=function(e){return{$$typeof:Cd,render:e}};V.isValidElement=ka;V.lazy=function(e){return{$$typeof:Ad,_payload:{_status:-1,_result:e},_init:Id}};V.memo=function(e,t){return{$$typeof:Nd,type:e,compare:t===void 0?null:t}};V.startTransition=function(e){var t=Zr.transition;Zr.transition={};try{e()}finally{Zr.transition=t}};V.unstable_act=Vl;V.useCallback=function(e,t){return Le.current.useCallback(e,t)};V.useContext=function(e){return Le.current.useContext(e)};V.useDebugValue=function(){};V.useDeferredValue=function(e){return Le.current.useDeferredValue(e)};V.useEffect=function(e,t){return Le.current.useEffect(e,t)};V.useId=function(){return Le.current.useId()};V.useImperativeHandle=function(e,t,n){return Le.current.useImperativeHandle(e,t,n)};V.useInsertionEffect=function(e,t){return Le.current.useInsertionEffect(e,t)};V.useLayoutEffect=function(e,t){return Le.current.useLayoutEffect(e,t)};V.useMemo=function(e,t){return Le.current.useMemo(e,t)};V.useReducer=function(e,t,n){return Le.current.useReducer(e,t,n)};V.useRef=function(e){return Le.current.useRef(e)};V.useState=function(e){return Le.current.useState(e)};V.useSyncExternalStore=function(e,t,n){return Le.current.useSyncExternalStore(e,t,n)};V.useTransition=function(){return Le.current.useTransition()};V.version="18.3.1";bl.exports=V;var T=bl.exports;const Qe=yd(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd=T,Dd=Symbol.for("react.element"),_d=Symbol.for("react.fragment"),Fd=Object.prototype.hasOwnProperty,bd=Rd.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zd={key:!0,ref:!0,__self:!0,__source:!0};function Gl(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Fd.call(t,r)&&!zd.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Dd,type:e,key:i,ref:a,props:s,_owner:bd.current}}_s.Fragment=_d;_s.jsx=Gl;_s.jsxs=Gl;Fl.exports=_s;var o=Fl.exports,_e={},Hl={exports:{}},Ge={},Ql={exports:{}},Kl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,b){var O=D.length;D.push(b);e:for(;0<O;){var J=O-1>>>1,ue=D[J];if(0<s(ue,b))D[J]=b,D[O]=ue,O=J;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var b=D[0],O=D.pop();if(O!==b){D[0]=O;e:for(var J=0,ue=D.length,R=ue>>>1;J<R;){var z=2*(J+1)-1,$=D[z],q=z+1,Y=D[q];if(0>s($,O))q<ue&&0>s(Y,$)?(D[J]=Y,D[q]=O,J=q):(D[J]=$,D[z]=O,J=z);else if(q<ue&&0>s(Y,O))D[J]=Y,D[q]=O,J=q;else break e}}return b}function s(D,b){var O=D.sortIndex-b.sortIndex;return O!==0?O:D.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,g=3,S=!1,m=!1,v=!1,k=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(D){for(var b=n(u);b!==null;){if(b.callback===null)r(u);else if(b.startTime<=D)r(u),b.sortIndex=b.expirationTime,t(c,b);else break;b=n(u)}}function w(D){if(v=!1,y(D),!m)if(n(c)!==null)m=!0,nt(x);else{var b=n(u);b!==null&&se(w,b.startTime-D)}}function x(D,b){m=!1,v&&(v=!1,p(M),M=-1),S=!0;var O=g;try{for(y(b),d=n(c);d!==null&&(!(d.expirationTime>b)||D&&!U());){var J=d.callback;if(typeof J=="function"){d.callback=null,g=d.priorityLevel;var ue=J(d.expirationTime<=b);b=e.unstable_now(),typeof ue=="function"?d.callback=ue:d===n(c)&&r(c),y(b)}else r(c);d=n(c)}if(d!==null)var R=!0;else{var z=n(u);z!==null&&se(w,z.startTime-b),R=!1}return R}finally{d=null,g=O,S=!1}}var C=!1,E=null,M=-1,I=5,N=-1;function U(){return!(e.unstable_now()-N<I)}function B(){if(E!==null){var D=e.unstable_now();N=D;var b=!0;try{b=E(!0,D)}finally{b?G():(C=!1,E=null)}}else C=!1}var G;if(typeof f=="function")G=function(){f(B)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,he=ae.port2;ae.port1.onmessage=B,G=function(){he.postMessage(null)}}else G=function(){k(B,0)};function nt(D){E=D,C||(C=!0,G())}function se(D,b){M=k(function(){D(e.unstable_now())},b)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){m||S||(m=!0,nt(x))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(D){switch(g){case 1:case 2:case 3:var b=3;break;default:b=g}var O=g;g=b;try{return D()}finally{g=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,b){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var O=g;g=D;try{return b()}finally{g=O}},e.unstable_scheduleCallback=function(D,b,O){var J=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?J+O:J):O=J,D){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=O+ue,D={id:h++,callback:b,priorityLevel:D,startTime:O,expirationTime:ue,sortIndex:-1},O>J?(D.sortIndex=O,t(u,D),n(c)===null&&D===n(u)&&(v?(p(M),M=-1):v=!0,se(w,O-J))):(D.sortIndex=ue,t(c,D),m||S||(m=!0,nt(x))),D},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(D){var b=g;return function(){var O=g;g=b;try{return D.apply(this,arguments)}finally{g=O}}}})(Kl);Ql.exports=Kl;var Bd=Ql.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Od=T,Ve=Bd;function j(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yl=new Set,hr={};function cn(e,t){_n(e,t),_n(e+"Capture",t)}function _n(e,t){for(hr[e]=t,e=0;e<t.length;e++)Yl.add(t[e])}var Pt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ni=Object.prototype.hasOwnProperty,Ud=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jo={},Mo={};function Wd(e){return Ni.call(Mo,e)?!0:Ni.call(jo,e)?!1:Ud.test(e)?Mo[e]=!0:(jo[e]=!0,!1)}function $d(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qd(e,t,n,r){if(t===null||typeof t>"u"||$d(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Re(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Pe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pe[e]=new Re(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pe[t]=new Re(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pe[e]=new Re(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pe[e]=new Re(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pe[e]=new Re(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pe[e]=new Re(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pe[e]=new Re(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pe[e]=new Re(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pe[e]=new Re(e,5,!1,e.toLowerCase(),null,!1,!1)});var Pa=/[\-:]([a-z])/g;function Ca(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Pa,Ca);Pe[t]=new Re(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Pa,Ca);Pe[t]=new Re(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Pa,Ca);Pe[t]=new Re(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pe[e]=new Re(e,1,!1,e.toLowerCase(),null,!1,!1)});Pe.xlinkHref=new Re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pe[e]=new Re(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ea(e,t,n,r){var s=Pe.hasOwnProperty(t)?Pe[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qd(t,n,s,r)&&(n=null),r||s===null?Wd(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var At=Od.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fr=Symbol.for("react.element"),yn=Symbol.for("react.portal"),vn=Symbol.for("react.fragment"),Na=Symbol.for("react.strict_mode"),Ai=Symbol.for("react.profiler"),Xl=Symbol.for("react.provider"),Jl=Symbol.for("react.context"),Aa=Symbol.for("react.forward_ref"),Ti=Symbol.for("react.suspense"),ji=Symbol.for("react.suspense_list"),Ta=Symbol.for("react.memo"),jt=Symbol.for("react.lazy"),Zl=Symbol.for("react.offscreen"),Io=Symbol.iterator;function Vn(e){return e===null||typeof e!="object"?null:(e=Io&&e[Io]||e["@@iterator"],typeof e=="function"?e:null)}var ce=Object.assign,ti;function er(e){if(ti===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ti=t&&t[1]||""}return`
`+ti+e}var ni=!1;function ri(e,t){if(!e||ni)return"";ni=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{ni=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?er(e):""}function Vd(e){switch(e.tag){case 5:return er(e.type);case 16:return er("Lazy");case 13:return er("Suspense");case 19:return er("SuspenseList");case 0:case 2:case 15:return e=ri(e.type,!1),e;case 11:return e=ri(e.type.render,!1),e;case 1:return e=ri(e.type,!0),e;default:return""}}function Mi(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vn:return"Fragment";case yn:return"Portal";case Ai:return"Profiler";case Na:return"StrictMode";case Ti:return"Suspense";case ji:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jl:return(e.displayName||"Context")+".Consumer";case Xl:return(e._context.displayName||"Context")+".Provider";case Aa:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ta:return t=e.displayName||null,t!==null?t:Mi(e.type)||"Memo";case jt:t=e._payload,e=e._init;try{return Mi(e(t))}catch{}}return null}function Gd(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mi(t);case 8:return t===Na?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $t(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ec(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Hd(e){var t=ec(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function br(e){e._valueTracker||(e._valueTracker=Hd(e))}function tc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ec(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function us(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ii(e,t){var n=t.checked;return ce({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Lo(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$t(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nc(e,t){t=t.checked,t!=null&&Ea(e,"checked",t,!1)}function Li(e,t){nc(e,t);var n=$t(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ri(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ri(e,t.type,$t(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ro(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ri(e,t,n){(t!=="number"||us(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var tr=Array.isArray;function jn(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$t(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Di(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(j(91));return ce({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Do(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(j(92));if(tr(n)){if(1<n.length)throw Error(j(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$t(n)}}function rc(e,t){var n=$t(t.value),r=$t(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function _o(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _i(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zr,ic=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zr=zr||document.createElement("div"),zr.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var sr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qd=["Webkit","ms","Moz","O"];Object.keys(sr).forEach(function(e){Qd.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),sr[t]=sr[e]})});function ac(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||sr.hasOwnProperty(e)&&sr[e]?(""+t).trim():t+"px"}function oc(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ac(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Kd=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fi(e,t){if(t){if(Kd[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(j(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(j(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(j(61))}if(t.style!=null&&typeof t.style!="object")throw Error(j(62))}}function bi(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=null;function ja(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bi=null,Mn=null,In=null;function Fo(e){if(e=Rr(e)){if(typeof Bi!="function")throw Error(j(280));var t=e.stateNode;t&&(t=Os(t),Bi(e.stateNode,e.type,t))}}function lc(e){Mn?In?In.push(e):In=[e]:Mn=e}function cc(){if(Mn){var e=Mn,t=In;if(In=Mn=null,Fo(e),t)for(e=0;e<t.length;e++)Fo(t[e])}}function uc(e,t){return e(t)}function dc(){}var si=!1;function fc(e,t,n){if(si)return e(t,n);si=!0;try{return uc(e,t,n)}finally{si=!1,(Mn!==null||In!==null)&&(dc(),cc())}}function mr(e,t){var n=e.stateNode;if(n===null)return null;var r=Os(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(j(231,t,typeof n));return n}var Oi=!1;if(Pt)try{var Gn={};Object.defineProperty(Gn,"passive",{get:function(){Oi=!0}}),window.addEventListener("test",Gn,Gn),window.removeEventListener("test",Gn,Gn)}catch{Oi=!1}function Yd(e,t,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(h){this.onError(h)}}var ir=!1,ds=null,fs=!1,Ui=null,Xd={onError:function(e){ir=!0,ds=e}};function Jd(e,t,n,r,s,i,a,l,c){ir=!1,ds=null,Yd.apply(Xd,arguments)}function Zd(e,t,n,r,s,i,a,l,c){if(Jd.apply(this,arguments),ir){if(ir){var u=ds;ir=!1,ds=null}else throw Error(j(198));fs||(fs=!0,Ui=u)}}function un(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hc(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bo(e){if(un(e)!==e)throw Error(j(188))}function ef(e){var t=e.alternate;if(!t){if(t=un(e),t===null)throw Error(j(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return bo(s),e;if(i===r)return bo(s),t;i=i.sibling}throw Error(j(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(j(189))}}if(n.alternate!==r)throw Error(j(190))}if(n.tag!==3)throw Error(j(188));return n.stateNode.current===n?e:t}function pc(e){return e=ef(e),e!==null?mc(e):null}function mc(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mc(e);if(t!==null)return t;e=e.sibling}return null}var gc=Ve.unstable_scheduleCallback,zo=Ve.unstable_cancelCallback,tf=Ve.unstable_shouldYield,nf=Ve.unstable_requestPaint,fe=Ve.unstable_now,rf=Ve.unstable_getCurrentPriorityLevel,Ma=Ve.unstable_ImmediatePriority,yc=Ve.unstable_UserBlockingPriority,hs=Ve.unstable_NormalPriority,sf=Ve.unstable_LowPriority,vc=Ve.unstable_IdlePriority,Fs=null,gt=null;function af(e){if(gt&&typeof gt.onCommitFiberRoot=="function")try{gt.onCommitFiberRoot(Fs,e,void 0,(e.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:cf,of=Math.log,lf=Math.LN2;function cf(e){return e>>>=0,e===0?32:31-(of(e)/lf|0)|0}var Br=64,Or=4194304;function nr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ps(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=nr(l):(i&=a,i!==0&&(r=nr(i)))}else a=n&~s,a!==0?r=nr(a):i!==0&&(r=nr(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-lt(t),s=1<<n,r|=e[n],t&=~s;return r}function uf(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function df(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-lt(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=uf(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Wi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wc(){var e=Br;return Br<<=1,!(Br&4194240)&&(Br=64),e}function ii(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ir(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-lt(t),e[t]=n}function ff(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-lt(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Ia(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-lt(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var X=0;function xc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sc,La,kc,Pc,Cc,$i=!1,Ur=[],_t=null,Ft=null,bt=null,gr=new Map,yr=new Map,It=[],hf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bo(e,t){switch(e){case"focusin":case"focusout":_t=null;break;case"dragenter":case"dragleave":Ft=null;break;case"mouseover":case"mouseout":bt=null;break;case"pointerover":case"pointerout":gr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yr.delete(t.pointerId)}}function Hn(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Rr(t),t!==null&&La(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function pf(e,t,n,r,s){switch(t){case"focusin":return _t=Hn(_t,e,t,n,r,s),!0;case"dragenter":return Ft=Hn(Ft,e,t,n,r,s),!0;case"mouseover":return bt=Hn(bt,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return gr.set(i,Hn(gr.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,yr.set(i,Hn(yr.get(i)||null,e,t,n,r,s)),!0}return!1}function Ec(e){var t=Jt(e.target);if(t!==null){var n=un(t);if(n!==null){if(t=n.tag,t===13){if(t=hc(n),t!==null){e.blockedOn=t,Cc(e.priority,function(){kc(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function es(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=qi(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);zi=r,n.target.dispatchEvent(r),zi=null}else return t=Rr(n),t!==null&&La(t),e.blockedOn=n,!1;t.shift()}return!0}function Oo(e,t,n){es(e)&&n.delete(t)}function mf(){$i=!1,_t!==null&&es(_t)&&(_t=null),Ft!==null&&es(Ft)&&(Ft=null),bt!==null&&es(bt)&&(bt=null),gr.forEach(Oo),yr.forEach(Oo)}function Qn(e,t){e.blockedOn===t&&(e.blockedOn=null,$i||($i=!0,Ve.unstable_scheduleCallback(Ve.unstable_NormalPriority,mf)))}function vr(e){function t(s){return Qn(s,e)}if(0<Ur.length){Qn(Ur[0],e);for(var n=1;n<Ur.length;n++){var r=Ur[n];r.blockedOn===e&&(r.blockedOn=null)}}for(_t!==null&&Qn(_t,e),Ft!==null&&Qn(Ft,e),bt!==null&&Qn(bt,e),gr.forEach(t),yr.forEach(t),n=0;n<It.length;n++)r=It[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&(n=It[0],n.blockedOn===null);)Ec(n),n.blockedOn===null&&It.shift()}var Ln=At.ReactCurrentBatchConfig,ms=!0;function gf(e,t,n,r){var s=X,i=Ln.transition;Ln.transition=null;try{X=1,Ra(e,t,n,r)}finally{X=s,Ln.transition=i}}function yf(e,t,n,r){var s=X,i=Ln.transition;Ln.transition=null;try{X=4,Ra(e,t,n,r)}finally{X=s,Ln.transition=i}}function Ra(e,t,n,r){if(ms){var s=qi(e,t,n,r);if(s===null)mi(e,t,r,gs,n),Bo(e,r);else if(pf(s,e,t,n,r))r.stopPropagation();else if(Bo(e,r),t&4&&-1<hf.indexOf(e)){for(;s!==null;){var i=Rr(s);if(i!==null&&Sc(i),i=qi(e,t,n,r),i===null&&mi(e,t,r,gs,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else mi(e,t,r,null,n)}}var gs=null;function qi(e,t,n,r){if(gs=null,e=ja(r),e=Jt(e),e!==null)if(t=un(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hc(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return gs=e,null}function Nc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rf()){case Ma:return 1;case yc:return 4;case hs:case sf:return 16;case vc:return 536870912;default:return 16}default:return 16}}var Rt=null,Da=null,ts=null;function Ac(){if(ts)return ts;var e,t=Da,n=t.length,r,s="value"in Rt?Rt.value:Rt.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return ts=s.slice(e,1<r?1-r:void 0)}function ns(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Wr(){return!0}function Uo(){return!1}function He(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wr:Uo,this.isPropagationStopped=Uo,this}return ce(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),t}var $n={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_a=He($n),Lr=ce({},$n,{view:0,detail:0}),vf=He(Lr),ai,oi,Kn,bs=ce({},Lr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fa,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kn&&(Kn&&e.type==="mousemove"?(ai=e.screenX-Kn.screenX,oi=e.screenY-Kn.screenY):oi=ai=0,Kn=e),ai)},movementY:function(e){return"movementY"in e?e.movementY:oi}}),Wo=He(bs),wf=ce({},bs,{dataTransfer:0}),xf=He(wf),Sf=ce({},Lr,{relatedTarget:0}),li=He(Sf),kf=ce({},$n,{animationName:0,elapsedTime:0,pseudoElement:0}),Pf=He(kf),Cf=ce({},$n,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ef=He(Cf),Nf=ce({},$n,{data:0}),$o=He(Nf),Af={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mf(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jf[e])?!!t[e]:!1}function Fa(){return Mf}var If=ce({},Lr,{key:function(e){if(e.key){var t=Af[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ns(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Tf[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fa,charCode:function(e){return e.type==="keypress"?ns(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ns(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lf=He(If),Rf=ce({},bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qo=He(Rf),Df=ce({},Lr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fa}),_f=He(Df),Ff=ce({},$n,{propertyName:0,elapsedTime:0,pseudoElement:0}),bf=He(Ff),zf=ce({},bs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bf=He(zf),Of=[9,13,27,32],ba=Pt&&"CompositionEvent"in window,ar=null;Pt&&"documentMode"in document&&(ar=document.documentMode);var Uf=Pt&&"TextEvent"in window&&!ar,Tc=Pt&&(!ba||ar&&8<ar&&11>=ar),Vo=" ",Go=!1;function jc(e,t){switch(e){case"keyup":return Of.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wn=!1;function Wf(e,t){switch(e){case"compositionend":return Mc(t);case"keypress":return t.which!==32?null:(Go=!0,Vo);case"textInput":return e=t.data,e===Vo&&Go?null:e;default:return null}}function $f(e,t){if(wn)return e==="compositionend"||!ba&&jc(e,t)?(e=Ac(),ts=Da=Rt=null,wn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tc&&t.locale!=="ko"?null:t.data;default:return null}}var qf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ho(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qf[e.type]:t==="textarea"}function Ic(e,t,n,r){lc(r),t=ys(t,"onChange"),0<t.length&&(n=new _a("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var or=null,wr=null;function Vf(e){Wc(e,0)}function zs(e){var t=kn(e);if(tc(t))return e}function Gf(e,t){if(e==="change")return t}var Lc=!1;if(Pt){var ci;if(Pt){var ui="oninput"in document;if(!ui){var Qo=document.createElement("div");Qo.setAttribute("oninput","return;"),ui=typeof Qo.oninput=="function"}ci=ui}else ci=!1;Lc=ci&&(!document.documentMode||9<document.documentMode)}function Ko(){or&&(or.detachEvent("onpropertychange",Rc),wr=or=null)}function Rc(e){if(e.propertyName==="value"&&zs(wr)){var t=[];Ic(t,wr,e,ja(e)),fc(Vf,t)}}function Hf(e,t,n){e==="focusin"?(Ko(),or=t,wr=n,or.attachEvent("onpropertychange",Rc)):e==="focusout"&&Ko()}function Qf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zs(wr)}function Kf(e,t){if(e==="click")return zs(t)}function Yf(e,t){if(e==="input"||e==="change")return zs(t)}function Xf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ut=typeof Object.is=="function"?Object.is:Xf;function xr(e,t){if(ut(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ni.call(t,s)||!ut(e[s],t[s]))return!1}return!0}function Yo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xo(e,t){var n=Yo(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Yo(n)}}function Dc(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Dc(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _c(){for(var e=window,t=us();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=us(e.document)}return t}function za(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Jf(e){var t=_c(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Dc(n.ownerDocument.documentElement,n)){if(r!==null&&za(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Xo(n,i);var a=Xo(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Zf=Pt&&"documentMode"in document&&11>=document.documentMode,xn=null,Vi=null,lr=null,Gi=!1;function Jo(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Gi||xn==null||xn!==us(r)||(r=xn,"selectionStart"in r&&za(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),lr&&xr(lr,r)||(lr=r,r=ys(Vi,"onSelect"),0<r.length&&(t=new _a("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xn)))}function $r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sn={animationend:$r("Animation","AnimationEnd"),animationiteration:$r("Animation","AnimationIteration"),animationstart:$r("Animation","AnimationStart"),transitionend:$r("Transition","TransitionEnd")},di={},Fc={};Pt&&(Fc=document.createElement("div").style,"AnimationEvent"in window||(delete Sn.animationend.animation,delete Sn.animationiteration.animation,delete Sn.animationstart.animation),"TransitionEvent"in window||delete Sn.transitionend.transition);function Bs(e){if(di[e])return di[e];if(!Sn[e])return e;var t=Sn[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Fc)return di[e]=t[n];return e}var bc=Bs("animationend"),zc=Bs("animationiteration"),Bc=Bs("animationstart"),Oc=Bs("transitionend"),Uc=new Map,Zo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vt(e,t){Uc.set(e,t),cn(t,[e])}for(var fi=0;fi<Zo.length;fi++){var hi=Zo[fi],eh=hi.toLowerCase(),th=hi[0].toUpperCase()+hi.slice(1);Vt(eh,"on"+th)}Vt(bc,"onAnimationEnd");Vt(zc,"onAnimationIteration");Vt(Bc,"onAnimationStart");Vt("dblclick","onDoubleClick");Vt("focusin","onFocus");Vt("focusout","onBlur");Vt(Oc,"onTransitionEnd");_n("onMouseEnter",["mouseout","mouseover"]);_n("onMouseLeave",["mouseout","mouseover"]);_n("onPointerEnter",["pointerout","pointerover"]);_n("onPointerLeave",["pointerout","pointerover"]);cn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cn("onBeforeInput",["compositionend","keypress","textInput","paste"]);cn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nh=new Set("cancel close invalid load scroll toggle".split(" ").concat(rr));function el(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Zd(r,t,void 0,e),e.currentTarget=null}function Wc(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;el(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;el(s,l,u),i=c}}}if(fs)throw e=Ui,fs=!1,Ui=null,e}function ne(e,t){var n=t[Xi];n===void 0&&(n=t[Xi]=new Set);var r=e+"__bubble";n.has(r)||($c(t,e,2,!1),n.add(r))}function pi(e,t,n){var r=0;t&&(r|=4),$c(n,e,r,t)}var qr="_reactListening"+Math.random().toString(36).slice(2);function Sr(e){if(!e[qr]){e[qr]=!0,Yl.forEach(function(n){n!=="selectionchange"&&(nh.has(n)||pi(n,!1,e),pi(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[qr]||(t[qr]=!0,pi("selectionchange",!1,t))}}function $c(e,t,n,r){switch(Nc(t)){case 1:var s=gf;break;case 4:s=yf;break;default:s=Ra}n=s.bind(null,t,n,e),s=void 0,!Oi||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function mi(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Jt(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}fc(function(){var u=i,h=ja(n),d=[];e:{var g=Uc.get(e);if(g!==void 0){var S=_a,m=e;switch(e){case"keypress":if(ns(n)===0)break e;case"keydown":case"keyup":S=Lf;break;case"focusin":m="focus",S=li;break;case"focusout":m="blur",S=li;break;case"beforeblur":case"afterblur":S=li;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=Wo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=xf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=_f;break;case bc:case zc:case Bc:S=Pf;break;case Oc:S=bf;break;case"scroll":S=vf;break;case"wheel":S=Bf;break;case"copy":case"cut":case"paste":S=Ef;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=qo}var v=(t&4)!==0,k=!v&&e==="scroll",p=v?g!==null?g+"Capture":null:g;v=[];for(var f=u,y;f!==null;){y=f;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,p!==null&&(w=mr(f,p),w!=null&&v.push(kr(f,w,y)))),k)break;f=f.return}0<v.length&&(g=new S(g,m,null,n,h),d.push({event:g,listeners:v}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",g&&n!==zi&&(m=n.relatedTarget||n.fromElement)&&(Jt(m)||m[Ct]))break e;if((S||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,S?(m=n.relatedTarget||n.toElement,S=u,m=m?Jt(m):null,m!==null&&(k=un(m),m!==k||m.tag!==5&&m.tag!==6)&&(m=null)):(S=null,m=u),S!==m)){if(v=Wo,w="onMouseLeave",p="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(v=qo,w="onPointerLeave",p="onPointerEnter",f="pointer"),k=S==null?g:kn(S),y=m==null?g:kn(m),g=new v(w,f+"leave",S,n,h),g.target=k,g.relatedTarget=y,w=null,Jt(h)===u&&(v=new v(p,f+"enter",m,n,h),v.target=y,v.relatedTarget=k,w=v),k=w,S&&m)t:{for(v=S,p=m,f=0,y=v;y;y=mn(y))f++;for(y=0,w=p;w;w=mn(w))y++;for(;0<f-y;)v=mn(v),f--;for(;0<y-f;)p=mn(p),y--;for(;f--;){if(v===p||p!==null&&v===p.alternate)break t;v=mn(v),p=mn(p)}v=null}else v=null;S!==null&&tl(d,g,S,v,!1),m!==null&&k!==null&&tl(d,k,m,v,!0)}}e:{if(g=u?kn(u):window,S=g.nodeName&&g.nodeName.toLowerCase(),S==="select"||S==="input"&&g.type==="file")var x=Gf;else if(Ho(g))if(Lc)x=Yf;else{x=Qf;var C=Hf}else(S=g.nodeName)&&S.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(x=Kf);if(x&&(x=x(e,u))){Ic(d,x,n,h);break e}C&&C(e,g,u),e==="focusout"&&(C=g._wrapperState)&&C.controlled&&g.type==="number"&&Ri(g,"number",g.value)}switch(C=u?kn(u):window,e){case"focusin":(Ho(C)||C.contentEditable==="true")&&(xn=C,Vi=u,lr=null);break;case"focusout":lr=Vi=xn=null;break;case"mousedown":Gi=!0;break;case"contextmenu":case"mouseup":case"dragend":Gi=!1,Jo(d,n,h);break;case"selectionchange":if(Zf)break;case"keydown":case"keyup":Jo(d,n,h)}var E;if(ba)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else wn?jc(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Tc&&n.locale!=="ko"&&(wn||M!=="onCompositionStart"?M==="onCompositionEnd"&&wn&&(E=Ac()):(Rt=h,Da="value"in Rt?Rt.value:Rt.textContent,wn=!0)),C=ys(u,M),0<C.length&&(M=new $o(M,e,null,n,h),d.push({event:M,listeners:C}),E?M.data=E:(E=Mc(n),E!==null&&(M.data=E)))),(E=Uf?Wf(e,n):$f(e,n))&&(u=ys(u,"onBeforeInput"),0<u.length&&(h=new $o("onBeforeInput","beforeinput",null,n,h),d.push({event:h,listeners:u}),h.data=E))}Wc(d,t)})}function kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ys(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mr(e,n),i!=null&&r.unshift(kr(e,i,s)),i=mr(e,t),i!=null&&r.push(kr(e,i,s))),e=e.return}return r}function mn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function tl(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=mr(n,i),c!=null&&a.unshift(kr(n,c,l))):s||(c=mr(n,i),c!=null&&a.push(kr(n,c,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var rh=/\r\n?/g,sh=/\u0000|\uFFFD/g;function nl(e){return(typeof e=="string"?e:""+e).replace(rh,`
`).replace(sh,"")}function Vr(e,t,n){if(t=nl(t),nl(e)!==t&&n)throw Error(j(425))}function vs(){}var Hi=null,Qi=null;function Ki(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yi=typeof setTimeout=="function"?setTimeout:void 0,ih=typeof clearTimeout=="function"?clearTimeout:void 0,rl=typeof Promise=="function"?Promise:void 0,ah=typeof queueMicrotask=="function"?queueMicrotask:typeof rl<"u"?function(e){return rl.resolve(null).then(e).catch(oh)}:Yi;function oh(e){setTimeout(function(){throw e})}function gi(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),vr(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);vr(t)}function zt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sl(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var qn=Math.random().toString(36).slice(2),mt="__reactFiber$"+qn,Pr="__reactProps$"+qn,Ct="__reactContainer$"+qn,Xi="__reactEvents$"+qn,lh="__reactListeners$"+qn,ch="__reactHandles$"+qn;function Jt(e){var t=e[mt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ct]||n[mt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=sl(e);e!==null;){if(n=e[mt])return n;e=sl(e)}return t}e=n,n=e.parentNode}return null}function Rr(e){return e=e[mt]||e[Ct],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function kn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(j(33))}function Os(e){return e[Pr]||null}var Ji=[],Pn=-1;function Gt(e){return{current:e}}function re(e){0>Pn||(e.current=Ji[Pn],Ji[Pn]=null,Pn--)}function ee(e,t){Pn++,Ji[Pn]=e.current,e.current=t}var qt={},je=Gt(qt),ze=Gt(!1),rn=qt;function Fn(e,t){var n=e.type.contextTypes;if(!n)return qt;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Be(e){return e=e.childContextTypes,e!=null}function ws(){re(ze),re(je)}function il(e,t,n){if(je.current!==qt)throw Error(j(168));ee(je,t),ee(ze,n)}function qc(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(j(108,Gd(e)||"Unknown",s));return ce({},n,r)}function xs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qt,rn=je.current,ee(je,e),ee(ze,ze.current),!0}function al(e,t,n){var r=e.stateNode;if(!r)throw Error(j(169));n?(e=qc(e,t,rn),r.__reactInternalMemoizedMergedChildContext=e,re(ze),re(je),ee(je,e)):re(ze),ee(ze,n)}var wt=null,Us=!1,yi=!1;function Vc(e){wt===null?wt=[e]:wt.push(e)}function uh(e){Us=!0,Vc(e)}function Ht(){if(!yi&&wt!==null){yi=!0;var e=0,t=X;try{var n=wt;for(X=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}wt=null,Us=!1}catch(s){throw wt!==null&&(wt=wt.slice(e+1)),gc(Ma,Ht),s}finally{X=t,yi=!1}}return null}var Cn=[],En=0,Ss=null,ks=0,Ye=[],Xe=0,sn=null,xt=1,St="";function Yt(e,t){Cn[En++]=ks,Cn[En++]=Ss,Ss=e,ks=t}function Gc(e,t,n){Ye[Xe++]=xt,Ye[Xe++]=St,Ye[Xe++]=sn,sn=e;var r=xt;e=St;var s=32-lt(r)-1;r&=~(1<<s),n+=1;var i=32-lt(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,xt=1<<32-lt(t)+s|n<<s|r,St=i+e}else xt=1<<i|n<<s|r,St=e}function Ba(e){e.return!==null&&(Yt(e,1),Gc(e,1,0))}function Oa(e){for(;e===Ss;)Ss=Cn[--En],Cn[En]=null,ks=Cn[--En],Cn[En]=null;for(;e===sn;)sn=Ye[--Xe],Ye[Xe]=null,St=Ye[--Xe],Ye[Xe]=null,xt=Ye[--Xe],Ye[Xe]=null}var qe=null,$e=null,ie=!1,ot=null;function Hc(e,t){var n=Je(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ol(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,qe=e,$e=zt(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,qe=e,$e=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=sn!==null?{id:xt,overflow:St}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Je(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,qe=e,$e=null,!0):!1;default:return!1}}function Zi(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ea(e){if(ie){var t=$e;if(t){var n=t;if(!ol(e,t)){if(Zi(e))throw Error(j(418));t=zt(n.nextSibling);var r=qe;t&&ol(e,t)?Hc(r,n):(e.flags=e.flags&-4097|2,ie=!1,qe=e)}}else{if(Zi(e))throw Error(j(418));e.flags=e.flags&-4097|2,ie=!1,qe=e}}}function ll(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qe=e}function Gr(e){if(e!==qe)return!1;if(!ie)return ll(e),ie=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ki(e.type,e.memoizedProps)),t&&(t=$e)){if(Zi(e))throw Qc(),Error(j(418));for(;t;)Hc(e,t),t=zt(t.nextSibling)}if(ll(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(j(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){$e=zt(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}$e=null}}else $e=qe?zt(e.stateNode.nextSibling):null;return!0}function Qc(){for(var e=$e;e;)e=zt(e.nextSibling)}function bn(){$e=qe=null,ie=!1}function Ua(e){ot===null?ot=[e]:ot.push(e)}var dh=At.ReactCurrentBatchConfig;function Yn(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(j(309));var r=n.stateNode}if(!r)throw Error(j(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(j(284));if(!n._owner)throw Error(j(290,e))}return e}function Hr(e,t){throw e=Object.prototype.toString.call(t),Error(j(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function cl(e){var t=e._init;return t(e._payload)}function Kc(e){function t(p,f){if(e){var y=p.deletions;y===null?(p.deletions=[f],p.flags|=16):y.push(f)}}function n(p,f){if(!e)return null;for(;f!==null;)t(p,f),f=f.sibling;return null}function r(p,f){for(p=new Map;f!==null;)f.key!==null?p.set(f.key,f):p.set(f.index,f),f=f.sibling;return p}function s(p,f){return p=Wt(p,f),p.index=0,p.sibling=null,p}function i(p,f,y){return p.index=y,e?(y=p.alternate,y!==null?(y=y.index,y<f?(p.flags|=2,f):y):(p.flags|=2,f)):(p.flags|=1048576,f)}function a(p){return e&&p.alternate===null&&(p.flags|=2),p}function l(p,f,y,w){return f===null||f.tag!==6?(f=Ci(y,p.mode,w),f.return=p,f):(f=s(f,y),f.return=p,f)}function c(p,f,y,w){var x=y.type;return x===vn?h(p,f,y.props.children,w,y.key):f!==null&&(f.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===jt&&cl(x)===f.type)?(w=s(f,y.props),w.ref=Yn(p,f,y),w.return=p,w):(w=cs(y.type,y.key,y.props,null,p.mode,w),w.ref=Yn(p,f,y),w.return=p,w)}function u(p,f,y,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==y.containerInfo||f.stateNode.implementation!==y.implementation?(f=Ei(y,p.mode,w),f.return=p,f):(f=s(f,y.children||[]),f.return=p,f)}function h(p,f,y,w,x){return f===null||f.tag!==7?(f=nn(y,p.mode,w,x),f.return=p,f):(f=s(f,y),f.return=p,f)}function d(p,f,y){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ci(""+f,p.mode,y),f.return=p,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Fr:return y=cs(f.type,f.key,f.props,null,p.mode,y),y.ref=Yn(p,null,f),y.return=p,y;case yn:return f=Ei(f,p.mode,y),f.return=p,f;case jt:var w=f._init;return d(p,w(f._payload),y)}if(tr(f)||Vn(f))return f=nn(f,p.mode,y,null),f.return=p,f;Hr(p,f)}return null}function g(p,f,y,w){var x=f!==null?f.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return x!==null?null:l(p,f,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Fr:return y.key===x?c(p,f,y,w):null;case yn:return y.key===x?u(p,f,y,w):null;case jt:return x=y._init,g(p,f,x(y._payload),w)}if(tr(y)||Vn(y))return x!==null?null:h(p,f,y,w,null);Hr(p,y)}return null}function S(p,f,y,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(y)||null,l(f,p,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fr:return p=p.get(w.key===null?y:w.key)||null,c(f,p,w,x);case yn:return p=p.get(w.key===null?y:w.key)||null,u(f,p,w,x);case jt:var C=w._init;return S(p,f,y,C(w._payload),x)}if(tr(w)||Vn(w))return p=p.get(y)||null,h(f,p,w,x,null);Hr(f,w)}return null}function m(p,f,y,w){for(var x=null,C=null,E=f,M=f=0,I=null;E!==null&&M<y.length;M++){E.index>M?(I=E,E=null):I=E.sibling;var N=g(p,E,y[M],w);if(N===null){E===null&&(E=I);break}e&&E&&N.alternate===null&&t(p,E),f=i(N,f,M),C===null?x=N:C.sibling=N,C=N,E=I}if(M===y.length)return n(p,E),ie&&Yt(p,M),x;if(E===null){for(;M<y.length;M++)E=d(p,y[M],w),E!==null&&(f=i(E,f,M),C===null?x=E:C.sibling=E,C=E);return ie&&Yt(p,M),x}for(E=r(p,E);M<y.length;M++)I=S(E,p,M,y[M],w),I!==null&&(e&&I.alternate!==null&&E.delete(I.key===null?M:I.key),f=i(I,f,M),C===null?x=I:C.sibling=I,C=I);return e&&E.forEach(function(U){return t(p,U)}),ie&&Yt(p,M),x}function v(p,f,y,w){var x=Vn(y);if(typeof x!="function")throw Error(j(150));if(y=x.call(y),y==null)throw Error(j(151));for(var C=x=null,E=f,M=f=0,I=null,N=y.next();E!==null&&!N.done;M++,N=y.next()){E.index>M?(I=E,E=null):I=E.sibling;var U=g(p,E,N.value,w);if(U===null){E===null&&(E=I);break}e&&E&&U.alternate===null&&t(p,E),f=i(U,f,M),C===null?x=U:C.sibling=U,C=U,E=I}if(N.done)return n(p,E),ie&&Yt(p,M),x;if(E===null){for(;!N.done;M++,N=y.next())N=d(p,N.value,w),N!==null&&(f=i(N,f,M),C===null?x=N:C.sibling=N,C=N);return ie&&Yt(p,M),x}for(E=r(p,E);!N.done;M++,N=y.next())N=S(E,p,M,N.value,w),N!==null&&(e&&N.alternate!==null&&E.delete(N.key===null?M:N.key),f=i(N,f,M),C===null?x=N:C.sibling=N,C=N);return e&&E.forEach(function(B){return t(p,B)}),ie&&Yt(p,M),x}function k(p,f,y,w){if(typeof y=="object"&&y!==null&&y.type===vn&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Fr:e:{for(var x=y.key,C=f;C!==null;){if(C.key===x){if(x=y.type,x===vn){if(C.tag===7){n(p,C.sibling),f=s(C,y.props.children),f.return=p,p=f;break e}}else if(C.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===jt&&cl(x)===C.type){n(p,C.sibling),f=s(C,y.props),f.ref=Yn(p,C,y),f.return=p,p=f;break e}n(p,C);break}else t(p,C);C=C.sibling}y.type===vn?(f=nn(y.props.children,p.mode,w,y.key),f.return=p,p=f):(w=cs(y.type,y.key,y.props,null,p.mode,w),w.ref=Yn(p,f,y),w.return=p,p=w)}return a(p);case yn:e:{for(C=y.key;f!==null;){if(f.key===C)if(f.tag===4&&f.stateNode.containerInfo===y.containerInfo&&f.stateNode.implementation===y.implementation){n(p,f.sibling),f=s(f,y.children||[]),f.return=p,p=f;break e}else{n(p,f);break}else t(p,f);f=f.sibling}f=Ei(y,p.mode,w),f.return=p,p=f}return a(p);case jt:return C=y._init,k(p,f,C(y._payload),w)}if(tr(y))return m(p,f,y,w);if(Vn(y))return v(p,f,y,w);Hr(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,f!==null&&f.tag===6?(n(p,f.sibling),f=s(f,y),f.return=p,p=f):(n(p,f),f=Ci(y,p.mode,w),f.return=p,p=f),a(p)):n(p,f)}return k}var zn=Kc(!0),Yc=Kc(!1),Ps=Gt(null),Cs=null,Nn=null,Wa=null;function $a(){Wa=Nn=Cs=null}function qa(e){var t=Ps.current;re(Ps),e._currentValue=t}function ta(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Rn(e,t){Cs=e,Wa=Nn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(be=!0),e.firstContext=null)}function et(e){var t=e._currentValue;if(Wa!==e)if(e={context:e,memoizedValue:t,next:null},Nn===null){if(Cs===null)throw Error(j(308));Nn=e,Cs.dependencies={lanes:0,firstContext:e}}else Nn=Nn.next=e;return t}var Zt=null;function Va(e){Zt===null?Zt=[e]:Zt.push(e)}function Xc(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Va(t)):(n.next=s.next,s.next=n),t.interleaved=n,Et(e,r)}function Et(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Mt=!1;function Ga(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bt(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Q&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Et(e,n)}return s=r.interleaved,s===null?(t.next=t,Va(r)):(t.next=s.next,s.next=t),r.interleaved=t,Et(e,n)}function rs(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ia(e,n)}}function ul(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Es(e,t,n,r){var s=e.updateQueue;Mt=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==a&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var d=s.baseState;a=0,h=u=c=null,l=i;do{var g=l.lane,S=l.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,v=l;switch(g=t,S=n,v.tag){case 1:if(m=v.payload,typeof m=="function"){d=m.call(S,d,g);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,g=typeof m=="function"?m.call(S,d,g):m,g==null)break e;d=ce({},d,g);break e;case 2:Mt=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else S={eventTime:S,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=S,c=d):h=h.next=S,a|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);on|=a,e.lanes=a,e.memoizedState=d}}function dl(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(j(191,s));s.call(r)}}}var Dr={},yt=Gt(Dr),Cr=Gt(Dr),Er=Gt(Dr);function en(e){if(e===Dr)throw Error(j(174));return e}function Ha(e,t){switch(ee(Er,t),ee(Cr,e),ee(yt,Dr),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_i(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_i(t,e)}re(yt),ee(yt,t)}function Bn(){re(yt),re(Cr),re(Er)}function Zc(e){en(Er.current);var t=en(yt.current),n=_i(t,e.type);t!==n&&(ee(Cr,e),ee(yt,n))}function Qa(e){Cr.current===e&&(re(yt),re(Cr))}var oe=Gt(0);function Ns(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vi=[];function Ka(){for(var e=0;e<vi.length;e++)vi[e]._workInProgressVersionPrimary=null;vi.length=0}var ss=At.ReactCurrentDispatcher,wi=At.ReactCurrentBatchConfig,an=0,le=null,ge=null,ve=null,As=!1,cr=!1,Nr=0,fh=0;function Ne(){throw Error(j(321))}function Ya(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ut(e[n],t[n]))return!1;return!0}function Xa(e,t,n,r,s,i){if(an=i,le=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ss.current=e===null||e.memoizedState===null?gh:yh,e=n(r,s),cr){i=0;do{if(cr=!1,Nr=0,25<=i)throw Error(j(301));i+=1,ve=ge=null,t.updateQueue=null,ss.current=vh,e=n(r,s)}while(cr)}if(ss.current=Ts,t=ge!==null&&ge.next!==null,an=0,ve=ge=le=null,As=!1,t)throw Error(j(300));return e}function Ja(){var e=Nr!==0;return Nr=0,e}function pt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ve===null?le.memoizedState=ve=e:ve=ve.next=e,ve}function tt(){if(ge===null){var e=le.alternate;e=e!==null?e.memoizedState:null}else e=ge.next;var t=ve===null?le.memoizedState:ve.next;if(t!==null)ve=t,ge=e;else{if(e===null)throw Error(j(310));ge=e,e={memoizedState:ge.memoizedState,baseState:ge.baseState,baseQueue:ge.baseQueue,queue:ge.queue,next:null},ve===null?le.memoizedState=ve=e:ve=ve.next=e}return ve}function Ar(e,t){return typeof t=="function"?t(e):t}function xi(e){var t=tt(),n=t.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=e;var r=ge,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var h=u.lane;if((an&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,a=r):c=c.next=d,le.lanes|=h,on|=h}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,ut(r,t.memoizedState)||(be=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,le.lanes|=i,on|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Si(e){var t=tt(),n=t.queue;if(n===null)throw Error(j(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);ut(i,t.memoizedState)||(be=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function eu(){}function tu(e,t){var n=le,r=tt(),s=t(),i=!ut(r.memoizedState,s);if(i&&(r.memoizedState=s,be=!0),r=r.queue,Za(su.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ve!==null&&ve.memoizedState.tag&1){if(n.flags|=2048,Tr(9,ru.bind(null,n,r,s,t),void 0,null),we===null)throw Error(j(349));an&30||nu(n,t,s)}return s}function nu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=le.updateQueue,t===null?(t={lastEffect:null,stores:null},le.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ru(e,t,n,r){t.value=n,t.getSnapshot=r,iu(t)&&au(e)}function su(e,t,n){return n(function(){iu(t)&&au(e)})}function iu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ut(e,n)}catch{return!0}}function au(e){var t=Et(e,1);t!==null&&ct(t,e,1,-1)}function fl(e){var t=pt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ar,lastRenderedState:e},t.queue=e,e=e.dispatch=mh.bind(null,le,e),[t.memoizedState,e]}function Tr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=le.updateQueue,t===null?(t={lastEffect:null,stores:null},le.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ou(){return tt().memoizedState}function is(e,t,n,r){var s=pt();le.flags|=e,s.memoizedState=Tr(1|t,n,void 0,r===void 0?null:r)}function Ws(e,t,n,r){var s=tt();r=r===void 0?null:r;var i=void 0;if(ge!==null){var a=ge.memoizedState;if(i=a.destroy,r!==null&&Ya(r,a.deps)){s.memoizedState=Tr(t,n,i,r);return}}le.flags|=e,s.memoizedState=Tr(1|t,n,i,r)}function hl(e,t){return is(8390656,8,e,t)}function Za(e,t){return Ws(2048,8,e,t)}function lu(e,t){return Ws(4,2,e,t)}function cu(e,t){return Ws(4,4,e,t)}function uu(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function du(e,t,n){return n=n!=null?n.concat([e]):null,Ws(4,4,uu.bind(null,t,e),n)}function eo(){}function fu(e,t){var n=tt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ya(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function hu(e,t){var n=tt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Ya(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function pu(e,t,n){return an&21?(ut(n,t)||(n=wc(),le.lanes|=n,on|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,be=!0),e.memoizedState=n)}function hh(e,t){var n=X;X=n!==0&&4>n?n:4,e(!0);var r=wi.transition;wi.transition={};try{e(!1),t()}finally{X=n,wi.transition=r}}function mu(){return tt().memoizedState}function ph(e,t,n){var r=Ut(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gu(e))yu(t,n);else if(n=Xc(e,t,n,r),n!==null){var s=Ie();ct(n,e,r,s),vu(n,t,r)}}function mh(e,t,n){var r=Ut(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gu(e))yu(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,ut(l,a)){var c=t.interleaved;c===null?(s.next=s,Va(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Xc(e,t,s,r),n!==null&&(s=Ie(),ct(n,e,r,s),vu(n,t,r))}}function gu(e){var t=e.alternate;return e===le||t!==null&&t===le}function yu(e,t){cr=As=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function vu(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ia(e,n)}}var Ts={readContext:et,useCallback:Ne,useContext:Ne,useEffect:Ne,useImperativeHandle:Ne,useInsertionEffect:Ne,useLayoutEffect:Ne,useMemo:Ne,useReducer:Ne,useRef:Ne,useState:Ne,useDebugValue:Ne,useDeferredValue:Ne,useTransition:Ne,useMutableSource:Ne,useSyncExternalStore:Ne,useId:Ne,unstable_isNewReconciler:!1},gh={readContext:et,useCallback:function(e,t){return pt().memoizedState=[e,t===void 0?null:t],e},useContext:et,useEffect:hl,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,is(4194308,4,uu.bind(null,t,e),n)},useLayoutEffect:function(e,t){return is(4194308,4,e,t)},useInsertionEffect:function(e,t){return is(4,2,e,t)},useMemo:function(e,t){var n=pt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=pt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ph.bind(null,le,e),[r.memoizedState,e]},useRef:function(e){var t=pt();return e={current:e},t.memoizedState=e},useState:fl,useDebugValue:eo,useDeferredValue:function(e){return pt().memoizedState=e},useTransition:function(){var e=fl(!1),t=e[0];return e=hh.bind(null,e[1]),pt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=le,s=pt();if(ie){if(n===void 0)throw Error(j(407));n=n()}else{if(n=t(),we===null)throw Error(j(349));an&30||nu(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,hl(su.bind(null,r,i,e),[e]),r.flags|=2048,Tr(9,ru.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=pt(),t=we.identifierPrefix;if(ie){var n=St,r=xt;n=(r&~(1<<32-lt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Nr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=fh++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yh={readContext:et,useCallback:fu,useContext:et,useEffect:Za,useImperativeHandle:du,useInsertionEffect:lu,useLayoutEffect:cu,useMemo:hu,useReducer:xi,useRef:ou,useState:function(){return xi(Ar)},useDebugValue:eo,useDeferredValue:function(e){var t=tt();return pu(t,ge.memoizedState,e)},useTransition:function(){var e=xi(Ar)[0],t=tt().memoizedState;return[e,t]},useMutableSource:eu,useSyncExternalStore:tu,useId:mu,unstable_isNewReconciler:!1},vh={readContext:et,useCallback:fu,useContext:et,useEffect:Za,useImperativeHandle:du,useInsertionEffect:lu,useLayoutEffect:cu,useMemo:hu,useReducer:Si,useRef:ou,useState:function(){return Si(Ar)},useDebugValue:eo,useDeferredValue:function(e){var t=tt();return ge===null?t.memoizedState=e:pu(t,ge.memoizedState,e)},useTransition:function(){var e=Si(Ar)[0],t=tt().memoizedState;return[e,t]},useMutableSource:eu,useSyncExternalStore:tu,useId:mu,unstable_isNewReconciler:!1};function it(e,t){if(e&&e.defaultProps){t=ce({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function na(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ce({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $s={isMounted:function(e){return(e=e._reactInternals)?un(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ie(),s=Ut(e),i=kt(r,s);i.payload=t,n!=null&&(i.callback=n),t=Bt(e,i,s),t!==null&&(ct(t,e,s,r),rs(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ie(),s=Ut(e),i=kt(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Bt(e,i,s),t!==null&&(ct(t,e,s,r),rs(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ie(),r=Ut(e),s=kt(n,r);s.tag=2,t!=null&&(s.callback=t),t=Bt(e,s,r),t!==null&&(ct(t,e,r,n),rs(t,e,r))}};function pl(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!xr(n,r)||!xr(s,i):!0}function wu(e,t,n){var r=!1,s=qt,i=t.contextType;return typeof i=="object"&&i!==null?i=et(i):(s=Be(t)?rn:je.current,r=t.contextTypes,i=(r=r!=null)?Fn(e,s):qt),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$s,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function ml(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$s.enqueueReplaceState(t,t.state,null)}function ra(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ga(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=et(i):(i=Be(t)?rn:je.current,s.context=Fn(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(na(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&$s.enqueueReplaceState(s,s.state,null),Es(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function On(e,t){try{var n="",r=t;do n+=Vd(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function ki(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function sa(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var wh=typeof WeakMap=="function"?WeakMap:Map;function xu(e,t,n){n=kt(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ms||(Ms=!0,pa=r),sa(e,t)},n}function Su(e,t,n){n=kt(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){sa(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sa(e,t),typeof r!="function"&&(Ot===null?Ot=new Set([this]):Ot.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function gl(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new wh;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Rh.bind(null,e,t,n),t.then(e,e))}function yl(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function vl(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=kt(-1,1),t.tag=2,Bt(n,t,1))),n.lanes|=1),e)}var xh=At.ReactCurrentOwner,be=!1;function Me(e,t,n,r){t.child=e===null?Yc(t,null,n,r):zn(t,e.child,n,r)}function wl(e,t,n,r,s){n=n.render;var i=t.ref;return Rn(t,s),r=Xa(e,t,n,r,i,s),n=Ja(),e!==null&&!be?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Nt(e,t,s)):(ie&&n&&Ba(t),t.flags|=1,Me(e,t,r,s),t.child)}function xl(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!lo(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,ku(e,t,i,r,s)):(e=cs(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xr,n(a,r)&&e.ref===t.ref)return Nt(e,t,s)}return t.flags|=1,e=Wt(i,r),e.ref=t.ref,e.return=t,t.child=e}function ku(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(xr(i,r)&&e.ref===t.ref)if(be=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(be=!0);else return t.lanes=e.lanes,Nt(e,t,s)}return ia(e,t,n,r,s)}function Pu(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ee(Tn,We),We|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ee(Tn,We),We|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ee(Tn,We),We|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,ee(Tn,We),We|=r;return Me(e,t,s,n),t.child}function Cu(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ia(e,t,n,r,s){var i=Be(n)?rn:je.current;return i=Fn(t,i),Rn(t,s),n=Xa(e,t,n,r,i,s),r=Ja(),e!==null&&!be?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Nt(e,t,s)):(ie&&r&&Ba(t),t.flags|=1,Me(e,t,n,s),t.child)}function Sl(e,t,n,r,s){if(Be(n)){var i=!0;xs(t)}else i=!1;if(Rn(t,s),t.stateNode===null)as(e,t),wu(t,n,r),ra(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=et(u):(u=Be(n)?rn:je.current,u=Fn(t,u));var h=n.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&ml(t,a,r,u),Mt=!1;var g=t.memoizedState;a.state=g,Es(t,r,a,s),c=t.memoizedState,l!==r||g!==c||ze.current||Mt?(typeof h=="function"&&(na(t,n,h,r),c=t.memoizedState),(l=Mt||pl(t,n,l,r,g,c,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Jc(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:it(t.type,l),a.props=u,d=t.pendingProps,g=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=et(c):(c=Be(n)?rn:je.current,c=Fn(t,c));var S=n.getDerivedStateFromProps;(h=typeof S=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==d||g!==c)&&ml(t,a,r,c),Mt=!1,g=t.memoizedState,a.state=g,Es(t,r,a,s);var m=t.memoizedState;l!==d||g!==m||ze.current||Mt?(typeof S=="function"&&(na(t,n,S,r),m=t.memoizedState),(u=Mt||pl(t,n,u,r,g,m,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return aa(e,t,n,r,i,s)}function aa(e,t,n,r,s,i){Cu(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&al(t,n,!1),Nt(e,t,i);r=t.stateNode,xh.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=zn(t,e.child,null,i),t.child=zn(t,null,l,i)):Me(e,t,l,i),t.memoizedState=r.state,s&&al(t,n,!0),t.child}function Eu(e){var t=e.stateNode;t.pendingContext?il(e,t.pendingContext,t.pendingContext!==t.context):t.context&&il(e,t.context,!1),Ha(e,t.containerInfo)}function kl(e,t,n,r,s){return bn(),Ua(s),t.flags|=256,Me(e,t,n,r),t.child}var oa={dehydrated:null,treeContext:null,retryLane:0};function la(e){return{baseLanes:e,cachePool:null,transitions:null}}function Nu(e,t,n){var r=t.pendingProps,s=oe.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ee(oe,s&1),e===null)return ea(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Gs(a,r,0,null),e=nn(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=la(n),t.memoizedState=oa,e):to(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Sh(e,t,a,r,l,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Wt(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Wt(l,i):(i=nn(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?la(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=oa,r}return i=e.child,e=i.sibling,r=Wt(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function to(e,t){return t=Gs({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Qr(e,t,n,r){return r!==null&&Ua(r),zn(t,e.child,null,n),e=to(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sh(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=ki(Error(j(422))),Qr(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Gs({mode:"visible",children:r.children},s,0,null),i=nn(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&zn(t,e.child,null,a),t.child.memoizedState=la(a),t.memoizedState=oa,i);if(!(t.mode&1))return Qr(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(j(419)),r=ki(i,r,void 0),Qr(e,t,a,r)}if(l=(a&e.childLanes)!==0,be||l){if(r=we,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Et(e,s),ct(r,e,s,-1))}return oo(),r=ki(Error(j(421))),Qr(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Dh.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,$e=zt(s.nextSibling),qe=t,ie=!0,ot=null,e!==null&&(Ye[Xe++]=xt,Ye[Xe++]=St,Ye[Xe++]=sn,xt=e.id,St=e.overflow,sn=t),t=to(t,r.children),t.flags|=4096,t)}function Pl(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ta(e.return,t,n)}function Pi(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Au(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Me(e,t,r.children,n),r=oe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pl(e,n,t);else if(e.tag===19)Pl(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ee(oe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ns(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Pi(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ns(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Pi(t,!0,n,null,i);break;case"together":Pi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function as(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Nt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),on|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(j(153));if(t.child!==null){for(e=t.child,n=Wt(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Wt(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function kh(e,t,n){switch(t.tag){case 3:Eu(t),bn();break;case 5:Zc(t);break;case 1:Be(t.type)&&xs(t);break;case 4:Ha(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ee(Ps,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ee(oe,oe.current&1),t.flags|=128,null):n&t.child.childLanes?Nu(e,t,n):(ee(oe,oe.current&1),e=Nt(e,t,n),e!==null?e.sibling:null);ee(oe,oe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Au(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ee(oe,oe.current),r)break;return null;case 22:case 23:return t.lanes=0,Pu(e,t,n)}return Nt(e,t,n)}var Tu,ca,ju,Mu;Tu=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ca=function(){};ju=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,en(yt.current);var i=null;switch(n){case"input":s=Ii(e,s),r=Ii(e,r),i=[];break;case"select":s=ce({},s,{value:void 0}),r=ce({},r,{value:void 0}),i=[];break;case"textarea":s=Di(e,s),r=Di(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=vs)}Fi(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hr.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hr.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ne("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Mu=function(e,t,n,r){n!==r&&(t.flags|=4)};function Xn(e,t){if(!ie)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ae(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ph(e,t,n){var r=t.pendingProps;switch(Oa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ae(t),null;case 1:return Be(t.type)&&ws(),Ae(t),null;case 3:return r=t.stateNode,Bn(),re(ze),re(je),Ka(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Gr(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ot!==null&&(ya(ot),ot=null))),ca(e,t),Ae(t),null;case 5:Qa(t);var s=en(Er.current);if(n=t.type,e!==null&&t.stateNode!=null)ju(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(j(166));return Ae(t),null}if(e=en(yt.current),Gr(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[mt]=t,r[Pr]=i,e=(t.mode&1)!==0,n){case"dialog":ne("cancel",r),ne("close",r);break;case"iframe":case"object":case"embed":ne("load",r);break;case"video":case"audio":for(s=0;s<rr.length;s++)ne(rr[s],r);break;case"source":ne("error",r);break;case"img":case"image":case"link":ne("error",r),ne("load",r);break;case"details":ne("toggle",r);break;case"input":Lo(r,i),ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ne("invalid",r);break;case"textarea":Do(r,i),ne("invalid",r)}Fi(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Vr(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Vr(r.textContent,l,e),s=["children",""+l]):hr.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&ne("scroll",r)}switch(n){case"input":br(r),Ro(r,i,!0);break;case"textarea":br(r),_o(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=vs)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[mt]=t,e[Pr]=r,Tu(e,t,!1,!1),t.stateNode=e;e:{switch(a=bi(n,r),n){case"dialog":ne("cancel",e),ne("close",e),s=r;break;case"iframe":case"object":case"embed":ne("load",e),s=r;break;case"video":case"audio":for(s=0;s<rr.length;s++)ne(rr[s],e);s=r;break;case"source":ne("error",e),s=r;break;case"img":case"image":case"link":ne("error",e),ne("load",e),s=r;break;case"details":ne("toggle",e),s=r;break;case"input":Lo(e,r),s=Ii(e,r),ne("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=ce({},r,{value:void 0}),ne("invalid",e);break;case"textarea":Do(e,r),s=Di(e,r),ne("invalid",e);break;default:s=r}Fi(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?oc(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ic(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&pr(e,c):typeof c=="number"&&pr(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(hr.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ne("scroll",e):c!=null&&Ea(e,i,c,a))}switch(n){case"input":br(e),Ro(e,r,!1);break;case"textarea":br(e),_o(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$t(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?jn(e,!!r.multiple,i,!1):r.defaultValue!=null&&jn(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=vs)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ae(t),null;case 6:if(e&&t.stateNode!=null)Mu(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(j(166));if(n=en(Er.current),en(yt.current),Gr(t)){if(r=t.stateNode,n=t.memoizedProps,r[mt]=t,(i=r.nodeValue!==n)&&(e=qe,e!==null))switch(e.tag){case 3:Vr(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vr(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mt]=t,t.stateNode=r}return Ae(t),null;case 13:if(re(oe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ie&&$e!==null&&t.mode&1&&!(t.flags&128))Qc(),bn(),t.flags|=98560,i=!1;else if(i=Gr(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(j(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(j(317));i[mt]=t}else bn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ae(t),i=!1}else ot!==null&&(ya(ot),ot=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||oe.current&1?ye===0&&(ye=3):oo())),t.updateQueue!==null&&(t.flags|=4),Ae(t),null);case 4:return Bn(),ca(e,t),e===null&&Sr(t.stateNode.containerInfo),Ae(t),null;case 10:return qa(t.type._context),Ae(t),null;case 17:return Be(t.type)&&ws(),Ae(t),null;case 19:if(re(oe),i=t.memoizedState,i===null)return Ae(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Xn(i,!1);else{if(ye!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ns(e),a!==null){for(t.flags|=128,Xn(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ee(oe,oe.current&1|2),t.child}e=e.sibling}i.tail!==null&&fe()>Un&&(t.flags|=128,r=!0,Xn(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ns(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Xn(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!ie)return Ae(t),null}else 2*fe()-i.renderingStartTime>Un&&n!==1073741824&&(t.flags|=128,r=!0,Xn(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=fe(),t.sibling=null,n=oe.current,ee(oe,r?n&1|2:n&1),t):(Ae(t),null);case 22:case 23:return ao(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?We&1073741824&&(Ae(t),t.subtreeFlags&6&&(t.flags|=8192)):Ae(t),null;case 24:return null;case 25:return null}throw Error(j(156,t.tag))}function Ch(e,t){switch(Oa(t),t.tag){case 1:return Be(t.type)&&ws(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bn(),re(ze),re(je),Ka(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Qa(t),null;case 13:if(re(oe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(j(340));bn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return re(oe),null;case 4:return Bn(),null;case 10:return qa(t.type._context),null;case 22:case 23:return ao(),null;case 24:return null;default:return null}}var Kr=!1,Te=!1,Eh=typeof WeakSet=="function"?WeakSet:Set,F=null;function An(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){de(e,t,r)}else n.current=null}function ua(e,t,n){try{n()}catch(r){de(e,t,r)}}var Cl=!1;function Nh(e,t){if(Hi=ms,e=_c(),za(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,g=null;t:for(;;){for(var S;d!==n||s!==0&&d.nodeType!==3||(l=a+s),d!==i||r!==0&&d.nodeType!==3||(c=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(S=d.firstChild)!==null;)g=d,d=S;for(;;){if(d===e)break t;if(g===n&&++u===s&&(l=a),g===i&&++h===r&&(c=a),(S=d.nextSibling)!==null)break;d=g,g=d.parentNode}d=S}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qi={focusedElem:e,selectionRange:n},ms=!1,F=t;F!==null;)if(t=F,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,F=e;else for(;F!==null;){t=F;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,k=m.memoizedState,p=t.stateNode,f=p.getSnapshotBeforeUpdate(t.elementType===t.type?v:it(t.type,v),k);p.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(w){de(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,F=e;break}F=t.return}return m=Cl,Cl=!1,m}function ur(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&ua(t,n,i)}s=s.next}while(s!==r)}}function qs(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function da(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Iu(e){var t=e.alternate;t!==null&&(e.alternate=null,Iu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[mt],delete t[Pr],delete t[Xi],delete t[lh],delete t[ch])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Lu(e){return e.tag===5||e.tag===3||e.tag===4}function El(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Lu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fa(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=vs));else if(r!==4&&(e=e.child,e!==null))for(fa(e,t,n),e=e.sibling;e!==null;)fa(e,t,n),e=e.sibling}function ha(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ha(e,t,n),e=e.sibling;e!==null;)ha(e,t,n),e=e.sibling}var Se=null,at=!1;function Tt(e,t,n){for(n=n.child;n!==null;)Ru(e,t,n),n=n.sibling}function Ru(e,t,n){if(gt&&typeof gt.onCommitFiberUnmount=="function")try{gt.onCommitFiberUnmount(Fs,n)}catch{}switch(n.tag){case 5:Te||An(n,t);case 6:var r=Se,s=at;Se=null,Tt(e,t,n),Se=r,at=s,Se!==null&&(at?(e=Se,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Se.removeChild(n.stateNode));break;case 18:Se!==null&&(at?(e=Se,n=n.stateNode,e.nodeType===8?gi(e.parentNode,n):e.nodeType===1&&gi(e,n),vr(e)):gi(Se,n.stateNode));break;case 4:r=Se,s=at,Se=n.stateNode.containerInfo,at=!0,Tt(e,t,n),Se=r,at=s;break;case 0:case 11:case 14:case 15:if(!Te&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ua(n,t,a),s=s.next}while(s!==r)}Tt(e,t,n);break;case 1:if(!Te&&(An(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){de(n,t,l)}Tt(e,t,n);break;case 21:Tt(e,t,n);break;case 22:n.mode&1?(Te=(r=Te)||n.memoizedState!==null,Tt(e,t,n),Te=r):Tt(e,t,n);break;default:Tt(e,t,n)}}function Nl(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Eh),t.forEach(function(r){var s=_h.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function st(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:Se=l.stateNode,at=!1;break e;case 3:Se=l.stateNode.containerInfo,at=!0;break e;case 4:Se=l.stateNode.containerInfo,at=!0;break e}l=l.return}if(Se===null)throw Error(j(160));Ru(i,a,s),Se=null,at=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){de(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Du(t,e),t=t.sibling}function Du(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(st(t,e),ht(e),r&4){try{ur(3,e,e.return),qs(3,e)}catch(v){de(e,e.return,v)}try{ur(5,e,e.return)}catch(v){de(e,e.return,v)}}break;case 1:st(t,e),ht(e),r&512&&n!==null&&An(n,n.return);break;case 5:if(st(t,e),ht(e),r&512&&n!==null&&An(n,n.return),e.flags&32){var s=e.stateNode;try{pr(s,"")}catch(v){de(e,e.return,v)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&nc(s,i),bi(l,a);var u=bi(l,i);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];h==="style"?oc(s,d):h==="dangerouslySetInnerHTML"?ic(s,d):h==="children"?pr(s,d):Ea(s,h,d,u)}switch(l){case"input":Li(s,i);break;case"textarea":rc(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?jn(s,!!i.multiple,S,!1):g!==!!i.multiple&&(i.defaultValue!=null?jn(s,!!i.multiple,i.defaultValue,!0):jn(s,!!i.multiple,i.multiple?[]:"",!1))}s[Pr]=i}catch(v){de(e,e.return,v)}}break;case 6:if(st(t,e),ht(e),r&4){if(e.stateNode===null)throw Error(j(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){de(e,e.return,v)}}break;case 3:if(st(t,e),ht(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vr(t.containerInfo)}catch(v){de(e,e.return,v)}break;case 4:st(t,e),ht(e);break;case 13:st(t,e),ht(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(so=fe())),r&4&&Nl(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(Te=(u=Te)||h,st(t,e),Te=u):st(t,e),ht(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(F=e,h=e.child;h!==null;){for(d=F=h;F!==null;){switch(g=F,S=g.child,g.tag){case 0:case 11:case 14:case 15:ur(4,g,g.return);break;case 1:An(g,g.return);var m=g.stateNode;if(typeof m.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(v){de(r,n,v)}}break;case 5:An(g,g.return);break;case 22:if(g.memoizedState!==null){Tl(d);continue}}S!==null?(S.return=g,F=S):Tl(d)}h=h.sibling}e:for(h=null,d=e;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=d.stateNode,c=d.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ac("display",a))}catch(v){de(e,e.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){de(e,e.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:st(t,e),ht(e),r&4&&Nl(e);break;case 21:break;default:st(t,e),ht(e)}}function ht(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Lu(n)){var r=n;break e}n=n.return}throw Error(j(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(pr(s,""),r.flags&=-33);var i=El(e);ha(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=El(e);fa(e,l,a);break;default:throw Error(j(161))}}catch(c){de(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ah(e,t,n){F=e,_u(e)}function _u(e,t,n){for(var r=(e.mode&1)!==0;F!==null;){var s=F,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Kr;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Te;l=Kr;var u=Te;if(Kr=a,(Te=c)&&!u)for(F=s;F!==null;)a=F,c=a.child,a.tag===22&&a.memoizedState!==null?jl(s):c!==null?(c.return=a,F=c):jl(s);for(;i!==null;)F=i,_u(i),i=i.sibling;F=s,Kr=l,Te=u}Al(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,F=i):Al(e)}}function Al(e){for(;F!==null;){var t=F;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Te||qs(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Te)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:it(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&dl(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}dl(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&vr(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}Te||t.flags&512&&da(t)}catch(g){de(t,t.return,g)}}if(t===e){F=null;break}if(n=t.sibling,n!==null){n.return=t.return,F=n;break}F=t.return}}function Tl(e){for(;F!==null;){var t=F;if(t===e){F=null;break}var n=t.sibling;if(n!==null){n.return=t.return,F=n;break}F=t.return}}function jl(e){for(;F!==null;){var t=F;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{qs(4,t)}catch(c){de(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){de(t,s,c)}}var i=t.return;try{da(t)}catch(c){de(t,i,c)}break;case 5:var a=t.return;try{da(t)}catch(c){de(t,a,c)}}}catch(c){de(t,t.return,c)}if(t===e){F=null;break}var l=t.sibling;if(l!==null){l.return=t.return,F=l;break}F=t.return}}var Th=Math.ceil,js=At.ReactCurrentDispatcher,no=At.ReactCurrentOwner,Ze=At.ReactCurrentBatchConfig,Q=0,we=null,me=null,ke=0,We=0,Tn=Gt(0),ye=0,jr=null,on=0,Vs=0,ro=0,dr=null,Fe=null,so=0,Un=1/0,vt=null,Ms=!1,pa=null,Ot=null,Yr=!1,Dt=null,Is=0,fr=0,ma=null,os=-1,ls=0;function Ie(){return Q&6?fe():os!==-1?os:os=fe()}function Ut(e){return e.mode&1?Q&2&&ke!==0?ke&-ke:dh.transition!==null?(ls===0&&(ls=wc()),ls):(e=X,e!==0||(e=window.event,e=e===void 0?16:Nc(e.type)),e):1}function ct(e,t,n,r){if(50<fr)throw fr=0,ma=null,Error(j(185));Ir(e,n,r),(!(Q&2)||e!==we)&&(e===we&&(!(Q&2)&&(Vs|=n),ye===4&&Lt(e,ke)),Oe(e,r),n===1&&Q===0&&!(t.mode&1)&&(Un=fe()+500,Us&&Ht()))}function Oe(e,t){var n=e.callbackNode;df(e,t);var r=ps(e,e===we?ke:0);if(r===0)n!==null&&zo(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&zo(n),t===1)e.tag===0?uh(Ml.bind(null,e)):Vc(Ml.bind(null,e)),ah(function(){!(Q&6)&&Ht()}),n=null;else{switch(xc(r)){case 1:n=Ma;break;case 4:n=yc;break;case 16:n=hs;break;case 536870912:n=vc;break;default:n=hs}n=$u(n,Fu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Fu(e,t){if(os=-1,ls=0,Q&6)throw Error(j(327));var n=e.callbackNode;if(Dn()&&e.callbackNode!==n)return null;var r=ps(e,e===we?ke:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ls(e,r);else{t=r;var s=Q;Q|=2;var i=zu();(we!==e||ke!==t)&&(vt=null,Un=fe()+500,tn(e,t));do try{Ih();break}catch(l){bu(e,l)}while(!0);$a(),js.current=i,Q=s,me!==null?t=0:(we=null,ke=0,t=ye)}if(t!==0){if(t===2&&(s=Wi(e),s!==0&&(r=s,t=ga(e,s))),t===1)throw n=jr,tn(e,0),Lt(e,r),Oe(e,fe()),n;if(t===6)Lt(e,r);else{if(s=e.current.alternate,!(r&30)&&!jh(s)&&(t=Ls(e,r),t===2&&(i=Wi(e),i!==0&&(r=i,t=ga(e,i))),t===1))throw n=jr,tn(e,0),Lt(e,r),Oe(e,fe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(j(345));case 2:Xt(e,Fe,vt);break;case 3:if(Lt(e,r),(r&130023424)===r&&(t=so+500-fe(),10<t)){if(ps(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ie(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Yi(Xt.bind(null,e,Fe,vt),t);break}Xt(e,Fe,vt);break;case 4:if(Lt(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-lt(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=fe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Th(r/1960))-r,10<r){e.timeoutHandle=Yi(Xt.bind(null,e,Fe,vt),r);break}Xt(e,Fe,vt);break;case 5:Xt(e,Fe,vt);break;default:throw Error(j(329))}}}return Oe(e,fe()),e.callbackNode===n?Fu.bind(null,e):null}function ga(e,t){var n=dr;return e.current.memoizedState.isDehydrated&&(tn(e,t).flags|=256),e=Ls(e,t),e!==2&&(t=Fe,Fe=n,t!==null&&ya(t)),e}function ya(e){Fe===null?Fe=e:Fe.push.apply(Fe,e)}function jh(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ut(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Lt(e,t){for(t&=~ro,t&=~Vs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-lt(t),r=1<<n;e[n]=-1,t&=~r}}function Ml(e){if(Q&6)throw Error(j(327));Dn();var t=ps(e,0);if(!(t&1))return Oe(e,fe()),null;var n=Ls(e,t);if(e.tag!==0&&n===2){var r=Wi(e);r!==0&&(t=r,n=ga(e,r))}if(n===1)throw n=jr,tn(e,0),Lt(e,t),Oe(e,fe()),n;if(n===6)throw Error(j(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xt(e,Fe,vt),Oe(e,fe()),null}function io(e,t){var n=Q;Q|=1;try{return e(t)}finally{Q=n,Q===0&&(Un=fe()+500,Us&&Ht())}}function ln(e){Dt!==null&&Dt.tag===0&&!(Q&6)&&Dn();var t=Q;Q|=1;var n=Ze.transition,r=X;try{if(Ze.transition=null,X=1,e)return e()}finally{X=r,Ze.transition=n,Q=t,!(Q&6)&&Ht()}}function ao(){We=Tn.current,re(Tn)}function tn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ih(n)),me!==null)for(n=me.return;n!==null;){var r=n;switch(Oa(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ws();break;case 3:Bn(),re(ze),re(je),Ka();break;case 5:Qa(r);break;case 4:Bn();break;case 13:re(oe);break;case 19:re(oe);break;case 10:qa(r.type._context);break;case 22:case 23:ao()}n=n.return}if(we=e,me=e=Wt(e.current,null),ke=We=t,ye=0,jr=null,ro=Vs=on=0,Fe=dr=null,Zt!==null){for(t=0;t<Zt.length;t++)if(n=Zt[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Zt=null}return e}function bu(e,t){do{var n=me;try{if($a(),ss.current=Ts,As){for(var r=le.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}As=!1}if(an=0,ve=ge=le=null,cr=!1,Nr=0,no.current=null,n===null||n.return===null){ye=1,jr=t,me=null;break}e:{var i=e,a=n.return,l=n,c=t;if(t=ke,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var S=yl(a);if(S!==null){S.flags&=-257,vl(S,a,l,i,t),S.mode&1&&gl(i,u,t),t=S,c=u;var m=t.updateQueue;if(m===null){var v=new Set;v.add(c),t.updateQueue=v}else m.add(c);break e}else{if(!(t&1)){gl(i,u,t),oo();break e}c=Error(j(426))}}else if(ie&&l.mode&1){var k=yl(a);if(k!==null){!(k.flags&65536)&&(k.flags|=256),vl(k,a,l,i,t),Ua(On(c,l));break e}}i=c=On(c,l),ye!==4&&(ye=2),dr===null?dr=[i]:dr.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var p=xu(i,c,t);ul(i,p);break e;case 1:l=c;var f=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ot===null||!Ot.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=Su(i,l,t);ul(i,w);break e}}i=i.return}while(i!==null)}Ou(n)}catch(x){t=x,me===n&&n!==null&&(me=n=n.return);continue}break}while(!0)}function zu(){var e=js.current;return js.current=Ts,e===null?Ts:e}function oo(){(ye===0||ye===3||ye===2)&&(ye=4),we===null||!(on&268435455)&&!(Vs&268435455)||Lt(we,ke)}function Ls(e,t){var n=Q;Q|=2;var r=zu();(we!==e||ke!==t)&&(vt=null,tn(e,t));do try{Mh();break}catch(s){bu(e,s)}while(!0);if($a(),Q=n,js.current=r,me!==null)throw Error(j(261));return we=null,ke=0,ye}function Mh(){for(;me!==null;)Bu(me)}function Ih(){for(;me!==null&&!tf();)Bu(me)}function Bu(e){var t=Wu(e.alternate,e,We);e.memoizedProps=e.pendingProps,t===null?Ou(e):me=t,no.current=null}function Ou(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ch(n,t),n!==null){n.flags&=32767,me=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ye=6,me=null;return}}else if(n=Ph(n,t,We),n!==null){me=n;return}if(t=t.sibling,t!==null){me=t;return}me=t=e}while(t!==null);ye===0&&(ye=5)}function Xt(e,t,n){var r=X,s=Ze.transition;try{Ze.transition=null,X=1,Lh(e,t,n,r)}finally{Ze.transition=s,X=r}return null}function Lh(e,t,n,r){do Dn();while(Dt!==null);if(Q&6)throw Error(j(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(j(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(ff(e,i),e===we&&(me=we=null,ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yr||(Yr=!0,$u(hs,function(){return Dn(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ze.transition,Ze.transition=null;var a=X;X=1;var l=Q;Q|=4,no.current=null,Nh(e,n),Du(n,e),Jf(Qi),ms=!!Hi,Qi=Hi=null,e.current=n,Ah(n),nf(),Q=l,X=a,Ze.transition=i}else e.current=n;if(Yr&&(Yr=!1,Dt=e,Is=s),i=e.pendingLanes,i===0&&(Ot=null),af(n.stateNode),Oe(e,fe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ms)throw Ms=!1,e=pa,pa=null,e;return Is&1&&e.tag!==0&&Dn(),i=e.pendingLanes,i&1?e===ma?fr++:(fr=0,ma=e):fr=0,Ht(),null}function Dn(){if(Dt!==null){var e=xc(Is),t=Ze.transition,n=X;try{if(Ze.transition=null,X=16>e?16:e,Dt===null)var r=!1;else{if(e=Dt,Dt=null,Is=0,Q&6)throw Error(j(331));var s=Q;for(Q|=4,F=e.current;F!==null;){var i=F,a=i.child;if(F.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(F=u;F!==null;){var h=F;switch(h.tag){case 0:case 11:case 15:ur(8,h,i)}var d=h.child;if(d!==null)d.return=h,F=d;else for(;F!==null;){h=F;var g=h.sibling,S=h.return;if(Iu(h),h===u){F=null;break}if(g!==null){g.return=S,F=g;break}F=S}}}var m=i.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var k=v.sibling;v.sibling=null,v=k}while(v!==null)}}F=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,F=a;else e:for(;F!==null;){if(i=F,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ur(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,F=p;break e}F=i.return}}var f=e.current;for(F=f;F!==null;){a=F;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,F=y;else e:for(a=f;F!==null;){if(l=F,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qs(9,l)}}catch(x){de(l,l.return,x)}if(l===a){F=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,F=w;break e}F=l.return}}if(Q=s,Ht(),gt&&typeof gt.onPostCommitFiberRoot=="function")try{gt.onPostCommitFiberRoot(Fs,e)}catch{}r=!0}return r}finally{X=n,Ze.transition=t}}return!1}function Il(e,t,n){t=On(n,t),t=xu(e,t,1),e=Bt(e,t,1),t=Ie(),e!==null&&(Ir(e,1,t),Oe(e,t))}function de(e,t,n){if(e.tag===3)Il(e,e,n);else for(;t!==null;){if(t.tag===3){Il(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ot===null||!Ot.has(r))){e=On(n,e),e=Su(t,e,1),t=Bt(t,e,1),e=Ie(),t!==null&&(Ir(t,1,e),Oe(t,e));break}}t=t.return}}function Rh(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ie(),e.pingedLanes|=e.suspendedLanes&n,we===e&&(ke&n)===n&&(ye===4||ye===3&&(ke&130023424)===ke&&500>fe()-so?tn(e,0):ro|=n),Oe(e,t)}function Uu(e,t){t===0&&(e.mode&1?(t=Or,Or<<=1,!(Or&130023424)&&(Or=4194304)):t=1);var n=Ie();e=Et(e,t),e!==null&&(Ir(e,t,n),Oe(e,n))}function Dh(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Uu(e,n)}function _h(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(j(314))}r!==null&&r.delete(t),Uu(e,n)}var Wu;Wu=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ze.current)be=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return be=!1,kh(e,t,n);be=!!(e.flags&131072)}else be=!1,ie&&t.flags&1048576&&Gc(t,ks,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;as(e,t),e=t.pendingProps;var s=Fn(t,je.current);Rn(t,n),s=Xa(null,t,r,e,s,n);var i=Ja();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Be(r)?(i=!0,xs(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ga(t),s.updater=$s,t.stateNode=s,s._reactInternals=t,ra(t,r,e,n),t=aa(null,t,r,!0,i,n)):(t.tag=0,ie&&i&&Ba(t),Me(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(as(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=bh(r),e=it(r,e),s){case 0:t=ia(null,t,r,e,n);break e;case 1:t=Sl(null,t,r,e,n);break e;case 11:t=wl(null,t,r,e,n);break e;case 14:t=xl(null,t,r,it(r.type,e),n);break e}throw Error(j(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:it(r,s),ia(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:it(r,s),Sl(e,t,r,s,n);case 3:e:{if(Eu(t),e===null)throw Error(j(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Jc(e,t),Es(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=On(Error(j(423)),t),t=kl(e,t,r,n,s);break e}else if(r!==s){s=On(Error(j(424)),t),t=kl(e,t,r,n,s);break e}else for($e=zt(t.stateNode.containerInfo.firstChild),qe=t,ie=!0,ot=null,n=Yc(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bn(),r===s){t=Nt(e,t,n);break e}Me(e,t,r,n)}t=t.child}return t;case 5:return Zc(t),e===null&&ea(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Ki(r,s)?a=null:i!==null&&Ki(r,i)&&(t.flags|=32),Cu(e,t),Me(e,t,a,n),t.child;case 6:return e===null&&ea(t),null;case 13:return Nu(e,t,n);case 4:return Ha(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=zn(t,null,r,n):Me(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:it(r,s),wl(e,t,r,s,n);case 7:return Me(e,t,t.pendingProps,n),t.child;case 8:return Me(e,t,t.pendingProps.children,n),t.child;case 12:return Me(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ee(Ps,r._currentValue),r._currentValue=a,i!==null)if(ut(i.value,a)){if(i.children===s.children&&!ze.current){t=Nt(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=kt(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ta(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(j(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),ta(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Me(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Rn(t,n),s=et(s),r=r(s),t.flags|=1,Me(e,t,r,n),t.child;case 14:return r=t.type,s=it(r,t.pendingProps),s=it(r.type,s),xl(e,t,r,s,n);case 15:return ku(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:it(r,s),as(e,t),t.tag=1,Be(r)?(e=!0,xs(t)):e=!1,Rn(t,n),wu(t,r,s),ra(t,r,s,n),aa(null,t,r,!0,e,n);case 19:return Au(e,t,n);case 22:return Pu(e,t,n)}throw Error(j(156,t.tag))};function $u(e,t){return gc(e,t)}function Fh(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Je(e,t,n,r){return new Fh(e,t,n,r)}function lo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bh(e){if(typeof e=="function")return lo(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Aa)return 11;if(e===Ta)return 14}return 2}function Wt(e,t){var n=e.alternate;return n===null?(n=Je(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function cs(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")lo(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case vn:return nn(n.children,s,i,t);case Na:a=8,s|=8;break;case Ai:return e=Je(12,n,t,s|2),e.elementType=Ai,e.lanes=i,e;case Ti:return e=Je(13,n,t,s),e.elementType=Ti,e.lanes=i,e;case ji:return e=Je(19,n,t,s),e.elementType=ji,e.lanes=i,e;case Zl:return Gs(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xl:a=10;break e;case Jl:a=9;break e;case Aa:a=11;break e;case Ta:a=14;break e;case jt:a=16,r=null;break e}throw Error(j(130,e==null?e:typeof e,""))}return t=Je(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function nn(e,t,n,r){return e=Je(7,e,r,t),e.lanes=n,e}function Gs(e,t,n,r){return e=Je(22,e,r,t),e.elementType=Zl,e.lanes=n,e.stateNode={isHidden:!1},e}function Ci(e,t,n){return e=Je(6,e,null,t),e.lanes=n,e}function Ei(e,t,n){return t=Je(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zh(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ii(0),this.expirationTimes=ii(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ii(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function co(e,t,n,r,s,i,a,l,c){return e=new zh(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Je(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ga(i),e}function Bh(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yn,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function qu(e){if(!e)return qt;e=e._reactInternals;e:{if(un(e)!==e||e.tag!==1)throw Error(j(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Be(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(j(171))}if(e.tag===1){var n=e.type;if(Be(n))return qc(e,n,t)}return t}function Vu(e,t,n,r,s,i,a,l,c){return e=co(n,r,!0,e,s,i,a,l,c),e.context=qu(null),n=e.current,r=Ie(),s=Ut(n),i=kt(r,s),i.callback=t??null,Bt(n,i,s),e.current.lanes=s,Ir(e,s,r),Oe(e,r),e}function Hs(e,t,n,r){var s=t.current,i=Ie(),a=Ut(s);return n=qu(n),t.context===null?t.context=n:t.pendingContext=n,t=kt(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Bt(s,t,a),e!==null&&(ct(e,s,a,i),rs(e,s,a)),a}function Rs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ll(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function uo(e,t){Ll(e,t),(e=e.alternate)&&Ll(e,t)}function Oh(){return null}var Gu=typeof reportError=="function"?reportError:function(e){console.error(e)};function fo(e){this._internalRoot=e}Qs.prototype.render=fo.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(j(409));Hs(e,t,null,null)};Qs.prototype.unmount=fo.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ln(function(){Hs(null,e,null,null)}),t[Ct]=null}};function Qs(e){this._internalRoot=e}Qs.prototype.unstable_scheduleHydration=function(e){if(e){var t=Pc();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&t!==0&&t<It[n].priority;n++);It.splice(n,0,e),n===0&&Ec(e)}};function ho(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ks(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Rl(){}function Uh(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Rs(a);i.call(u)}}var a=Vu(t,r,e,0,null,!1,!1,"",Rl);return e._reactRootContainer=a,e[Ct]=a.current,Sr(e.nodeType===8?e.parentNode:e),ln(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Rs(c);l.call(u)}}var c=co(e,0,!1,null,null,!1,!1,"",Rl);return e._reactRootContainer=c,e[Ct]=c.current,Sr(e.nodeType===8?e.parentNode:e),ln(function(){Hs(t,c,n,r)}),c}function Ys(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Rs(a);l.call(c)}}Hs(t,a,e,s)}else a=Uh(n,t,e,s,r);return Rs(a)}Sc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=nr(t.pendingLanes);n!==0&&(Ia(t,n|1),Oe(t,fe()),!(Q&6)&&(Un=fe()+500,Ht()))}break;case 13:ln(function(){var r=Et(e,1);if(r!==null){var s=Ie();ct(r,e,1,s)}}),uo(e,1)}};La=function(e){if(e.tag===13){var t=Et(e,134217728);if(t!==null){var n=Ie();ct(t,e,134217728,n)}uo(e,134217728)}};kc=function(e){if(e.tag===13){var t=Ut(e),n=Et(e,t);if(n!==null){var r=Ie();ct(n,e,t,r)}uo(e,t)}};Pc=function(){return X};Cc=function(e,t){var n=X;try{return X=e,t()}finally{X=n}};Bi=function(e,t,n){switch(t){case"input":if(Li(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Os(r);if(!s)throw Error(j(90));tc(r),Li(r,s)}}}break;case"textarea":rc(e,n);break;case"select":t=n.value,t!=null&&jn(e,!!n.multiple,t,!1)}};uc=io;dc=ln;var Wh={usingClientEntryPoint:!1,Events:[Rr,kn,Os,lc,cc,io]},Jn={findFiberByHostInstance:Jt,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$h={bundleType:Jn.bundleType,version:Jn.version,rendererPackageName:Jn.rendererPackageName,rendererConfig:Jn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:At.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pc(e),e===null?null:e.stateNode},findFiberByHostInstance:Jn.findFiberByHostInstance||Oh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xr.isDisabled&&Xr.supportsFiber)try{Fs=Xr.inject($h),gt=Xr}catch{}}Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wh;Ge.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ho(t))throw Error(j(200));return Bh(e,t,null,n)};Ge.createRoot=function(e,t){if(!ho(e))throw Error(j(299));var n=!1,r="",s=Gu;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=co(e,1,!1,null,null,n,!1,r,s),e[Ct]=t.current,Sr(e.nodeType===8?e.parentNode:e),new fo(t)};Ge.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(j(188)):(e=Object.keys(e).join(","),Error(j(268,e)));return e=pc(t),e=e===null?null:e.stateNode,e};Ge.flushSync=function(e){return ln(e)};Ge.hydrate=function(e,t,n){if(!Ks(t))throw Error(j(200));return Ys(null,e,t,!0,n)};Ge.hydrateRoot=function(e,t,n){if(!ho(e))throw Error(j(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Gu;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Vu(t,null,e,1,n??null,s,!1,i,a),e[Ct]=t.current,Sr(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Qs(t)};Ge.render=function(e,t,n){if(!Ks(t))throw Error(j(200));return Ys(null,e,t,!1,n)};Ge.unmountComponentAtNode=function(e){if(!Ks(e))throw Error(j(40));return e._reactRootContainer?(ln(function(){Ys(null,null,e,!1,function(){e._reactRootContainer=null,e[Ct]=null})}),!0):!1};Ge.unstable_batchedUpdates=io;Ge.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Ks(n))throw Error(j(200));if(e==null||e._reactInternals===void 0)throw Error(j(38));return Ys(e,t,n,!1,r)};Ge.version="18.3.1-next-f1338f8080-20240426";function Hu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hu)}catch(e){console.error(e)}}Hu(),Hl.exports=Ge;var qh=Hl.exports,Dl=qh;_e.createRoot=Dl.createRoot,_e.hydrateRoot=Dl.hydrateRoot;class Vh{async play(){throw new Error("play() not implemented")}async pause(){throw new Error("pause() not implemented")}async restart(){throw new Error("restart() not implemented")}async seek(t){throw new Error("seek() not implemented")}async getPlaybackState(){throw new Error("getPlaybackState() not implemented")}async getQueue(){throw new Error("getQueue() not implemented")}async addToQueue(t){throw new Error("addToQueue() not implemented")}async removeFromQueue(t){throw new Error("removeFromQueue() not implemented")}async clearQueue(){throw new Error("clearQueue() not implemented")}async reorderQueue(t,n){throw new Error("reorderQueue() not implemented")}async playNext(){throw new Error("playNext() not implemented")}async getMixerState(){throw new Error("getMixerState() not implemented")}async setMasterGain(t,n){throw new Error("setMasterGain() not implemented")}async toggleMasterMute(t){throw new Error("toggleMasterMute() not implemented")}async setMasterMute(t,n){throw new Error("setMasterMute() not implemented")}async getEffects(){throw new Error("getEffects() not implemented")}async selectEffect(t){throw new Error("selectEffect() not implemented")}async toggleEffect(t,n){throw new Error("toggleEffect() not implemented")}async nextEffect(){throw new Error("nextEffect() not implemented")}async previousEffect(){throw new Error("previousEffect() not implemented")}async randomEffect(){throw new Error("randomEffect() not implemented")}async getLibrary(){throw new Error("getLibrary() not implemented")}async scanLibrary(){throw new Error("scanLibrary() not implemented")}async searchSongs(t){throw new Error("searchSongs() not implemented")}async loadSongForEditing(t){throw new Error("loadSongForEditing() not implemented")}async saveSongEdits(t){throw new Error("saveSongEdits() not implemented")}async getPreferences(){throw new Error("getPreferences() not implemented")}async updateAutoTunePreferences(t){throw new Error("updateAutoTunePreferences() not implemented")}async updateMicrophonePreferences(t){throw new Error("updateMicrophonePreferences() not implemented")}async updateEffectsPreferences(t){throw new Error("updateEffectsPreferences() not implemented")}async getRequests(){throw new Error("getRequests() not implemented")}async approveRequest(t){throw new Error("approveRequest() not implemented")}async rejectRequest(t){throw new Error("rejectRequest() not implemented")}onStateChange(t,n){throw new Error("onStateChange() not implemented")}offStateChange(t,n){throw new Error("offStateChange() not implemented")}async connect(){}async disconnect(){}}function Gh(e,t,n){window.addEventListener(e,t,n)}function Hh(e,t,n){window.removeEventListener(e,t,n)}function Qh(e){window.addEventListener("DOMContentLoaded",e)}function Kh(e){window.addEventListener("resize",e)}function Yh(e){window.addEventListener("beforeunload",e)}function Xh(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}let gn=null;class po extends Vh{constructor(){if(gn)return gn;super(),this.api=window.kaiAPI,this.listeners=new Map,this._app=null,this._playerController=null,Gh("player:initialized",t=>{this._app=t.detail.app,this._playerController=t.detail.player}),gn=this}get playerController(){return this._playerController}get app(){return this._app}static getInstance(){return gn||(gn=new po),gn}async play(){return this._app?(await this._app.togglePlayback(),{success:!0}):{success:!1,error:"App not initialized"}}async pause(){return this._app?(await this._app.togglePlayback(),{success:!0}):{success:!1,error:"App not initialized"}}async restart(){return this._app?(await this._app.restartTrack(),{success:!0}):{success:!1,error:"App not initialized"}}async seek(t){var n;return(n=this._app)!=null&&n.player?(await this._app.player.setPosition(t),{success:!0}):{success:!1,error:"Player not initialized"}}async getPlaybackState(){return(await this.api.app.getState()).playback}async getQueue(){const t=await this.api.app.getState();return{queue:t.queue,currentSong:t.currentSong}}async addToQueue(t){return await this.api.queue.addSong(t)}async removeFromQueue(t){return await this.api.queue.removeSong(t)}async clearQueue(){return await this.api.queue.clear()}async reorderQueue(t,n){return await this.api.queue.reorderQueue(t,n)}async playNext(){return await this.api.player.next()}async playFromQueue(t){return await this.api.queue.load(t)}async getMixerState(){return(await this.api.app.getState()).mixer}async setMasterGain(t,n){return await this.api.mixer.setMasterGain(t,n)}async toggleMasterMute(t){return await this.api.mixer.toggleMasterMute(t)}async setMasterMute(t,n){return await this.api.mixer.toggleMasterMute(t)}async toggleMute(t,n){return await this.api.mixer.toggleMute(t,n)}async getAudioDevices(){try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return console.warn("MediaDevices API not available"),[];await navigator.mediaDevices.getUserMedia({audio:!0}).then(r=>{r.getTracks().forEach(s=>s.stop())}).catch(r=>{console.warn("Microphone permission denied:",r)});const t=await navigator.mediaDevices.enumerateDevices(),n=[];return t.forEach((r,s)=>{(r.kind==="audiooutput"||r.kind==="audioinput")&&n.push({id:r.deviceId,deviceId:r.deviceId,label:r.label||`${r.kind==="audiooutput"?"Speaker":"Microphone"} ${s+1}`,name:r.label||`${r.kind==="audiooutput"?"Speaker":"Microphone"} ${s+1}`,maxInputChannels:r.kind==="audioinput"?2:0,maxOutputChannels:r.kind==="audiooutput"?2:0,defaultSampleRate:48e3,hostApi:"Web Audio API",deviceKind:r.kind,groupId:r.groupId})}),n}catch(t){return console.error("Failed to enumerate audio devices:",t),[]}}async setAudioDevice(t,n){return await this.api.audio.setDevice(t,n)}async getDevicePreferences(){return await this.api.settings.get("devicePreferences",{})}async saveDevicePreferences(t){return await this.api.settings.set("devicePreferences",t)}async getAudioSettings(){const t=await this.api.settings.get("iemMonoVocals",!0),n=await this.api.settings.get("micToSpeakers",!0),r=await this.api.settings.get("enableMic",!0);return{iemMonoVocals:t,micToSpeakers:n,enableMic:r}}async saveAudioSettings(t){if(t.iemMonoVocals!==void 0){await this.api.settings.set("iemMonoVocals",t.iemMonoVocals);const n=this.playerController;n&&n.kaiPlayer&&n.kaiPlayer.setIEMMonoVocals(t.iemMonoVocals)}if(t.micToSpeakers!==void 0){await this.api.settings.set("micToSpeakers",t.micToSpeakers);const n=this.playerController;n&&n.kaiPlayer&&n.kaiPlayer.setMicToSpeakers(t.micToSpeakers),n&&n.karaokeRenderer&&n.karaokeRenderer.setMicToSpeakers(t.micToSpeakers)}if(t.enableMic!==void 0){await this.api.settings.set("enableMic",t.enableMic);const n=this.playerController;n&&n.kaiPlayer&&n.kaiPlayer.setEnableMic(t.enableMic),n&&n.karaokeRenderer&&n.karaokeRenderer.setMicEnabled(t.enableMic)}}async getEffects(){return await this.api.effects.getList()}async selectEffect(t){return await this.api.effects.select(t)}async enableEffect(t){return await this.api.effects.toggle(t,!0)}async disableEffect(t){return await this.api.effects.toggle(t,!1)}async toggleEffect(t,n){return await this.api.effects.toggle(t,n)}async nextEffect(){return await this.api.effects.next()}async previousEffect(){return await this.api.effects.previous()}async randomEffect(){return await this.api.effects.random()}async getLibrary(){return await this.api.library.getSongs()}async scanLibrary(){return await this.api.library.scanFolder()}async searchSongs(t){return await this.api.library.search(t)}async getSongsFolder(){return(await this.api.library.getSongsFolder()).folder}async setSongsFolder(){return(await this.api.library.setSongsFolder()).folder}async getCachedLibrary(){return await this.api.library.getCachedSongs()}async syncLibrary(){return await this.api.library.syncLibrary()}async loadSong(t){return await this.api.file.loadKaiFromPath(t)}async loadSongForEditing(t){var i,a;const n=await this.api.editor.loadKai(t);if(!n.success)return{success:!1,error:n.error};const r=n.data,s=((a=(i=r.audio)==null?void 0:i.sources)==null?void 0:a.map(l=>{const c=new Blob([l.audioData],{type:"audio/mpeg"}),u=URL.createObjectURL(c);return{name:l.name,filename:l.filename,audioData:l.audioData,downloadUrl:u}}))||[];return{success:!0,data:{format:"kai",metadata:r.metadata||{},lyrics:r.lyrics||[],audioFiles:s,songJson:r.originalSongJson||{}}}}async saveSongEdits(t){const{path:n,metadata:r,lyrics:s,format:i}=t;if(i==="kai"){const a={song:{title:r.title,artist:r.artist,album:r.album,year:r.year,genre:r.genre,key:r.key},lyrics:s};return(r.rejections!==void 0||r.suggestions!==void 0)&&(a.meta={corrections:{}},r.rejections!==void 0&&(a.meta.corrections.rejected=r.rejections.map(c=>({line:c.line_num,start:c.start_time,end:c.end_time,old:c.old_text,new:c.new_text,reason:c.reason,word_retention:c.retention_rate}))),r.suggestions!==void 0&&(a.meta.corrections.missing_lines_suggested=r.suggestions.map(c=>({suggested_text:c.suggested_text,start:c.start_time,end:c.end_time,confidence:c.confidence,reason:c.reason,pitch_activity:c.pitch_activity})))),await this.api.editor.saveKai(a,n)}return{success:!1,error:"Unsupported format"}}async getPreferences(){return(await this.api.app.getState()).preferences}async updateAutoTunePreferences(t){return await this.api.preferences.setAutoTune(t)}async updateMicrophonePreferences(t){return await this.api.preferences.setMicrophone(t)}async updateEffectsPreferences(t){return await this.api.preferences.setEffects(t)}async getWaveformPreferences(){return await this.api.settings.get("waveformPreferences",{enableWaveforms:!0,enableEffects:!0,randomEffectOnSong:!1,showUpcomingLyrics:!0,overlayOpacity:.7})}async saveWaveformPreferences(t){const n={enableWaveforms:t.enableWaveforms,enableEffects:t.enableEffects,randomEffectOnSong:t.randomEffectOnSong,showUpcomingLyrics:t.showUpcomingLyrics,overlayOpacity:t.overlayOpacity},r=await this.api.settings.set("waveformPreferences",n),s=this.playerController;if(!s)return console.warn(" Player not initialized yet"),r;const i=s.currentFormat,a=s.karaokeRenderer,l=s.cdgPlayer;return console.log(" Applying settings, format:",i,"prefs:",n),i==="kai"&&a?(console.log(" Applying to KAI player"),n.enableWaveforms!==void 0&&a.setWaveformsEnabled(n.enableWaveforms),n.enableEffects!==void 0&&a.setEffectsEnabled(n.enableEffects),n.showUpcomingLyrics!==void 0&&a.setShowUpcomingLyrics(n.showUpcomingLyrics),n.overlayOpacity!==void 0&&(a.waveformPreferences.overlayOpacity=n.overlayOpacity)):i==="cdg"&&l?(console.log(" Applying to CDG player"),n.enableEffects!==void 0&&l.setEffectsEnabled(n.enableEffects),n.overlayOpacity!==void 0&&l.setOverlayOpacity(n.overlayOpacity)):console.warn(" No active player format or player not ready"),r}async getAutotunePreferences(){return await this.api.settings.get("autoTunePreferences",{enabled:!1,strength:50,speed:20})}async saveAutotunePreferences(t){const n={enabled:t.enabled,strength:t.strength,speed:t.speed},r=await this.api.settings.set("autoTunePreferences",n);return n.enabled!==void 0&&await this.setAutotuneEnabled(n.enabled),(n.strength!==void 0||n.speed!==void 0)&&await this.setAutotuneSettings(n),r}async setAutotuneEnabled(t){return await this.api.autotune.setEnabled(t)}async setAutotuneSettings(t){return await this.api.autotune.setSettings(t)}onSettingsChanged(t,n){const s={waveform:"waveform:settingsChanged",autotune:"autotune:settingsChanged"}[t];if(!s)return()=>{};const i=(a,l)=>{n(l)};return this.api.events.on(s,i),()=>{var a,l;(l=(a=this.api.events).off)==null||l.call(a,s,i)}}async getRequests(){return await this.api.webServer.getSongRequests()}async approveRequest(t){return await this.api.webServer.approveRequest(t)}async rejectRequest(t){return await this.api.webServer.rejectRequest(t)}async getServerUrl(){return await this.api.webServer.getUrl()}async getServerSettings(){return await this.api.webServer.getSettings()}async updateServerSettings(t){return await this.api.webServer.updateSettings(t)}async getAdminPasswordStatus(){return await this.api.settings.get("server.adminPasswordHash")}async setAdminPassword(t){return await this.api.webServer.setAdminPassword(t)}async clearAllRequests(){return await this.api.webServer.clearAllRequests()}async openExternal(t){return await this.api.shell.openExternal(t)}onLatencyUpdate(t){const n=(r,s)=>t(s);return this.api.audio.onLatencyUpdate(n),()=>{var r,s;return(s=(r=this.api.audio).removeLatencyListener)==null?void 0:s.call(r,n)}}onXRunUpdate(t){const n=(r,s)=>t(s);return this.api.audio.onXRun(n),()=>{var r,s;return(s=(r=this.api.audio).removeXRunListener)==null?void 0:s.call(r,n)}}onPlaybackStateChanged(t){const n=(r,s)=>t(s);return this.api.player.onPlaybackState(n),()=>this.api.player.removePlaybackListener(n)}onCurrentSongChanged(t){const n=(r,s)=>t(s);return this.api.song.onChanged(n),()=>this.api.song.removeChangedListener(n)}onQueueChanged(t){const n=(r,s)=>{this.api.app.getState().then(i=>{t({queue:s,currentSong:i.currentSong})})};return this.api.queue.onUpdated(n),()=>this.api.queue.removeUpdatedListener(n)}onMixerChanged(t){const n=(r,s)=>t(s);return this.api.mixer.onStateChange(n),()=>this.api.mixer.removeStateListener(n)}onEffectChanged(t){const n=(r,s)=>t(s);return this.api.effects.onChanged(n),()=>this.api.effects.removeChangedListener(n)}onStateChange(t,n){switch(t){case"playback":return this.onPlaybackStateChanged(n);case"mixer":return this.onMixerChanged(n);case"queue":return this.onQueueChanged(n);case"effects":return this.onEffectChanged(n);case"preferences":{const r=(s,i)=>n(i);return this.api.preferences.onUpdated(r),()=>this.api.preferences.removeUpdatedListener(r)}default:return console.warn(`No state change handler for domain: ${t}`),()=>{}}}offStateChange(t,n){console.warn("offStateChange is deprecated - use the cleanup function returned from onStateChange instead")}async connect(){console.log(" ElectronBridge connected")}async disconnect(){this.listeners.clear(),console.log(" ElectronBridge disconnected")}}function Xs(e){switch(e){case"kai":return"";case"cdg-archive":case"cdg-pair":return"";default:return""}}function Ds(e){if(!e||e<=0)return"-";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n.toString().padStart(2,"0")}`}function Jh({song:e,onClose:t}){return e?(console.log(" SongInfoModal rendering for:",e.title),o.jsx("div",{className:"song-info-modal-overlay",onClick:t,children:o.jsxs("div",{className:"song-info-modal-content",onClick:n=>n.stopPropagation(),children:[o.jsxs("div",{className:"song-info-modal-header",children:[o.jsx("h2",{children:"Song Information"}),o.jsx("button",{className:"song-info-close-btn",onClick:t,children:""})]}),o.jsx("div",{className:"song-info-modal-body",children:o.jsxs("div",{className:"song-info-grid",children:[o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Title:"}),o.jsx("span",{className:"info-value",children:e.title})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Artist:"}),o.jsx("span",{className:"info-value",children:e.artist})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Album:"}),o.jsx("span",{className:"info-value",children:e.album||"N/A"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Genre:"}),o.jsx("span",{className:"info-value",children:e.genre||"N/A"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Key:"}),o.jsx("span",{className:"info-value",children:e.key||"N/A"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Year:"}),o.jsx("span",{className:"info-value",children:e.year||"N/A"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Duration:"}),o.jsx("span",{className:"info-value",children:Ds(e.duration)})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Format:"}),o.jsx("span",{className:"info-value",children:e.format||"N/A"})]}),o.jsxs("div",{className:"info-row",children:[o.jsx("span",{className:"info-label",children:"Path:"}),o.jsx("span",{className:"info-value",style:{wordBreak:"break-all",fontSize:"11px"},children:e.path})]})]})})]})})):null}function Zh({bridge:e,showSetFolder:t=!1,showFullRefresh:n=!1}){const[r,s]=T.useState([]),[i,a]=T.useState([]),[l,c]=T.useState(null),[u,h]=T.useState([]),[d,g]=T.useState(1),[S,m]=T.useState(""),[v,k]=T.useState(null),[p,f]=T.useState(!1),[y,w]=T.useState(null),[x,C]=T.useState(null),E=100;T.useEffect(()=>{var R;if(typeof window<"u"&&((R=window.kaiAPI)!=null&&R.events)){const z=(H,te)=>{C({current:te.current,total:te.total})},$=(H,te)=>{console.log(` Background scan complete: ${te.count} songs`),C(null),M()},q=(H,te)=>{console.log(` Songs folder updated: ${te}`),k(te),M()},Y=(H,te)=>{console.log(` Song updated: ${te.path}`),s(De=>{const rt=De.findIndex(Ue=>Ue.path===te.path);if(rt!==-1){const Ue=[...De];return Ue[rt]={...Ue[rt],...te.metadata},Ue}return De}),a(De=>{const rt=De.findIndex(Ue=>Ue.path===te.path);if(rt!==-1){const Ue=[...De];return Ue[rt]={...Ue[rt],...te.metadata},Ue}return De})};return window.kaiAPI.events.on("library:scanProgress",z),window.kaiAPI.events.on("library:scanComplete",$),window.kaiAPI.events.on("library:folderSet",q),window.kaiAPI.events.on("library:songUpdated",Y),()=>{window.kaiAPI.events.removeListener("library:scanProgress",z),window.kaiAPI.events.removeListener("library:scanComplete",$),window.kaiAPI.events.removeListener("library:folderSet",q),window.kaiAPI.events.removeListener("library:songUpdated",Y)}}},[]),T.useEffect(()=>{if(e!=null&&e.socket){const R=$=>{console.log(` Library refreshed from remote: ${$.count} songs`),M()},z=$=>{console.log(` Song updated: ${$.path}`),s(q=>{const Y=q.findIndex(H=>H.path===$.path);if(Y!==-1){const H=[...q];return H[Y]={...H[Y],...$.metadata},H}return q}),a(q=>{const Y=q.findIndex(H=>H.path===$.path);if(Y!==-1){const H=[...q];return H[Y]={...H[Y],...$.metadata},H}return q})};return e.socket.on("library-refreshed",R),e.socket.on("library:songUpdated",z),()=>{e.socket.off("library-refreshed",R),e.socket.off("library:songUpdated",z)}}},[e]),T.useEffect(()=>{M()},[]);const M=async()=>{try{f(!0);const R=await e.getSongsFolder();if(console.log(" Songs folder:",R),k(R),R){const z=await e.getCachedLibrary();console.log(" Cached library result:",z);const $=z.files||[];console.log(" Library songs count:",$.length),s($),I($)}else console.log(" No songs folder set")}catch(R){console.error("Failed to load library:",R)}finally{f(!1)}},I=R=>{const z=new Set;R.forEach(q=>{const Y=q.artist||q.title||q.name;if(Y){const H=Y.trim()[0].toUpperCase();/[A-Z]/.test(H)?z.add(H):z.add("#")}});let $=Array.from(z).sort();if($.includes("#")&&($=$.filter(q=>q!=="#"),$.push("#")),h($),!l&&$.length>0){const q=$.includes("A")?"A":$[0];N(q,1,R)}},N=(R,z,$=r)=>{c(R),g(z),m("");const Y=$.filter(H=>{const te=H.artist||H.title||H.name;if(!te)return!1;const De=te.trim()[0].toUpperCase();return R==="#"?!/[A-Z]/.test(De):De===R}).sort((H,te)=>{const De=(H.artist||H.title||"").toLowerCase(),rt=(te.artist||te.title||"").toLowerCase();return De.localeCompare(rt)});a(Y)},U=R=>{if(m(R),c(null),g(1),!R.trim()){a([]);return}const z=R.toLowerCase(),$=r.filter(q=>(q.title||"").toLowerCase().includes(z)||(q.artist||"").toLowerCase().includes(z)||(q.album||"").toLowerCase().includes(z));a($)},B=async()=>{try{const R=await e.setSongsFolder();R&&(k(R),await M())}catch(R){console.error("Failed to set folder:",R)}},G=async()=>{if(v)try{f(!0),await e.syncLibrary(),await M()}catch(R){console.error("Failed to sync:",R)}finally{f(!1),C(null)}},ae=async()=>{if(v)try{f(!0),await e.scanLibrary(),await M()}catch(R){console.error("Failed to refresh:",R)}finally{f(!1),C(null)}},he=async R=>{try{await e.addToQueue({path:R.path,title:R.title,artist:R.artist,duration:R.duration})}catch(z){console.error("Failed to add to queue:",z)}},nt=R=>{console.log(" Opening song info modal for:",R.title),w(R)},se=Math.ceil(i.length/E),D=(d-1)*E,b=D+E,O=i.slice(D,b),J=()=>{if(se<=7)return Array.from({length:se},(H,te)=>te+1);const z=[],$=Math.floor(4/2);z.push(1);let q=Math.max(2,d-$),Y=Math.min(se-1,d+$);d<=$+2&&(Y=Math.min(6,se-1)),d>=se-$-1&&(q=Math.max(2,se-7+2)),q>2&&z.push("...");for(let H=q;H<=Y;H++)z.push(H);return Y<se-1&&z.push("..."),se>1&&z.push(se),z},ue=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),"#"];return o.jsxs("div",{className:"library-panel",children:[o.jsxs("div",{className:"library-header",children:[o.jsxs("div",{className:"library-controls",children:[t&&o.jsxs("button",{onClick:B,className:"library-btn",children:[o.jsx("span",{className:"material-icons",children:"folder_open"}),"Set Songs Folder"]}),o.jsxs("button",{onClick:G,className:"library-btn",disabled:!v||p,children:[o.jsx("span",{className:"material-icons",children:"sync"}),"Sync"]}),n&&o.jsxs("button",{onClick:ae,className:"library-btn",disabled:!v||p,children:[o.jsx("span",{className:"material-icons",children:"refresh"}),"Full Refresh"]}),o.jsx("div",{className:"library-search",children:o.jsx("input",{type:"text",placeholder:"Search songs...",value:S,onChange:R=>U(R.target.value)})})]}),o.jsxs("div",{className:"library-info",children:[o.jsxs("span",{children:[r.length," songs"]}),v&&o.jsx("span",{children:v})]}),x&&o.jsxs("div",{className:"library-scan-progress",children:[o.jsx("div",{className:"scan-progress-bar",children:o.jsx("div",{className:"scan-progress-fill",style:{width:`${x.total>0?Math.round(x.current/x.total*100):0}%`}})}),o.jsxs("div",{className:"scan-progress-text",children:["Scanning: ",x.current," / ",x.total," files (",x.total>0?Math.round(x.current/x.total*100):0,"%)"]})]})]}),!S&&!x&&o.jsxs("div",{className:"alphabet-nav",children:[o.jsx("div",{className:"alphabet-title",children:"Browse by Artist:"}),o.jsx("div",{className:"alphabet-buttons",children:ue.map(R=>{const z=u.includes(R),$=l===R;return o.jsx("button",{className:`alphabet-btn ${$?"active":""} ${z?"":"disabled"}`,onClick:()=>z&&N(R,1),disabled:!z,children:R},R)})})]}),p?o.jsx("div",{className:"library-loading",children:"Loading library..."}):i.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"library-table-container",children:o.jsxs("table",{className:"library-table",children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Artist"}),o.jsx("th",{children:"Album"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Key"}),o.jsx("th",{children:"Duration"}),o.jsx("th",{children:"Year"}),o.jsx("th",{children:"Actions"})]})}),o.jsx("tbody",{children:O.map((R,z)=>o.jsxs("tr",{children:[o.jsxs("td",{children:[o.jsx("span",{className:"format-icon",children:Xs(R.format)}),R.title]}),o.jsx("td",{children:R.artist}),o.jsx("td",{children:R.album||"-"}),o.jsx("td",{children:R.genre||"-"}),o.jsx("td",{children:R.key||"-"}),o.jsx("td",{children:Ds(R.duration)}),o.jsx("td",{children:R.year||"-"}),o.jsx("td",{children:o.jsxs("div",{className:"table-actions",children:[o.jsx("button",{className:"library-action-btn queue-btn",onClick:()=>he(R),title:"Add to Queue",children:o.jsx("span",{className:"material-icons",children:"playlist_add"})}),o.jsx("button",{className:"library-action-btn info-btn",onClick:()=>nt(R),title:"Song Info",children:o.jsx("span",{className:"material-icons",children:"info"})})]})})]},z))})]})}),se>1&&!x&&o.jsxs("div",{className:"library-pagination",children:[o.jsx("button",{onClick:()=>g(d-1),disabled:d===1,children:"Previous"}),o.jsx("div",{className:"page-numbers",children:J().map((R,z)=>R==="..."?o.jsx("span",{className:"page-ellipsis",children:"..."},`ellipsis-${z}`):o.jsx("button",{className:`page-number ${R===d?"active":""}`,onClick:()=>g(R),children:R},R))}),o.jsxs("span",{className:"page-info",children:["(",i.length," songs)"]}),o.jsx("button",{onClick:()=>g(d+1),disabled:d===se,children:"Next"})]})]}):o.jsxs("div",{className:"library-empty",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-message",children:v?"No songs found":"No songs library set"}),o.jsx("div",{className:"empty-detail",children:v?"Try syncing or refreshing your library":'Click "Set Songs Folder" to choose your music library'})]}),y&&o.jsx(Jh,{song:y,onClose:()=>w(null)})]})}function ep({effects:e=[],currentEffect:t=null,disabledEffects:n=[],searchTerm:r="",currentCategory:s="all",onSearch:i,onCategoryChange:a,onSelectEffect:l,onRandomEffect:c,onEnableEffect:u,onDisableEffect:h}){let d=[...e];if(s!=="all"&&(d=d.filter(m=>m.category===s)),r.trim()){const m=r.toLowerCase();d=d.filter(v=>{var k,p,f;return((k=v.name)==null?void 0:k.toLowerCase().includes(m))||((p=v.displayName)==null?void 0:p.toLowerCase().includes(m))||((f=v.author)==null?void 0:f.toLowerCase().includes(m))})}const g=[{id:"all",label:"All"},{id:"geiss",label:"Geiss"},{id:"martin",label:"Martin"},{id:"flexi",label:"Flexi"},{id:"shifter",label:"Shifter"},{id:"other",label:"Other"}],S=m=>m.replace(/[^a-zA-Z0-9-_\s]/g,"_");return o.jsxs("div",{className:"effects-container",children:[o.jsxs("div",{className:"effects-header",children:[o.jsx("div",{className:"effects-search",children:o.jsx("input",{type:"text",placeholder:"Search effects...",value:r,onChange:m=>i&&i(m.target.value)})}),o.jsxs("div",{className:"effects-info",children:[o.jsx("span",{id:"effectsCount",children:s==="all"&&!r.trim()?`${e.length} effects`:`${d.length} of ${e.length} effects`}),c&&o.jsxs("button",{onClick:c,className:"effects-btn",children:[o.jsx("span",{className:"material-icons",children:"casino"}),"Random"]})]})]}),o.jsxs("div",{className:"effects-content",children:[o.jsx("div",{className:"effects-categories",children:g.map(m=>o.jsx("button",{className:`category-btn ${s===m.id?"active":""}`,onClick:()=>a&&a(m.id),children:m.label},m.id))}),o.jsx("div",{className:"effects-list",children:d.length===0?o.jsxs("div",{className:"effects-loading",children:[o.jsx("span",{className:"material-icons loading-icon",children:"search_off"}),o.jsx("div",{className:"loading-message",children:"No effects found"})]}):o.jsx("div",{className:"effects-grid",children:d.map(m=>{const v=t===m.name,k=n.includes(m.name),f=`../../static/images/butterchurn-screenshots/${S(m.name)}.png`;return o.jsxs("div",{className:`effect-item ${v?"active":""} ${k?"disabled":""}`,onClick:()=>!k&&l&&l(m.name),children:[o.jsxs("div",{className:"effect-preview",children:[o.jsx("img",{src:f,alt:m.displayName,className:"effect-screenshot",onError:y=>{y.target.style.display="none",y.target.nextElementSibling.style.display="flex"}}),o.jsx("div",{className:"effect-fallback",style:{display:"none"},children:o.jsx("span",{className:"material-icons",children:"image_not_supported"})})]}),o.jsxs("div",{className:`effect-info ${k?"disabled":""}`,children:[o.jsx("div",{className:"effect-category",children:m.category}),o.jsx("div",{className:"effect-name",children:m.displayName}),o.jsxs("div",{className:"effect-author",children:["by ",m.author]}),o.jsxs("div",{className:"effect-actions",children:[o.jsx("button",{className:"effect-action-btn primary",onClick:y=>{y.stopPropagation(),!k&&l&&l(m.name)},disabled:k,children:"Use"}),o.jsx("button",{className:"effect-action-btn",onClick:y=>{y.stopPropagation(),k?u&&u(m.name):h&&h(m.name)},children:k?"Enable":"Disable"})]})]})]},m.name)})})})]})]})}function tp({bridge:e}){const[t,n]=T.useState([]),[r,s]=T.useState(null),[i,a]=T.useState([]),[l,c]=T.useState(""),[u,h]=T.useState("all");T.useEffect(()=>{e!=null&&e.app&&(e.app.effectsData={effects:t,currentEffect:r,disabledEffects:i})},[e,t,r,i]),T.useEffect(()=>{g(),S()},[]),T.useEffect(()=>{var M;if(!((M=window.kaiAPI)!=null&&M.events)||t.length===0)return;const f=(I,N)=>{console.log(" Received effects:select from admin:",N),m(N)},y=()=>{console.log(" Received effects:next from admin");const I=t.filter(B=>!i.includes(B.name));if(I.length===0)return;const U=(I.findIndex(B=>B.name===r)+1)%I.length;m(I[U].name)},w=()=>{console.log(" Received effects:previous from admin");const I=t.filter(B=>!i.includes(B.name));if(I.length===0)return;const N=I.findIndex(B=>B.name===r),U=N<=0?I.length-1:N-1;m(I[U].name)},x=()=>{console.log(" Received effects:random from admin"),v()},C=(I,N)=>{console.log(" Received effects:disable from admin:",N),p(N)},E=(I,N)=>{console.log(" Received effects:enable from admin:",N),k(N)};return window.kaiAPI.events.on("effects:select",f),window.kaiAPI.events.on("effects:next",y),window.kaiAPI.events.on("effects:previous",w),window.kaiAPI.events.on("effects:random",x),window.kaiAPI.events.on("effects:disable",C),window.kaiAPI.events.on("effects:enable",E),()=>{window.kaiAPI.events.removeListener("effects:select",f),window.kaiAPI.events.removeListener("effects:next",y),window.kaiAPI.events.removeListener("effects:previous",w),window.kaiAPI.events.removeListener("effects:random",x),window.kaiAPI.events.removeListener("effects:disable",C),window.kaiAPI.events.removeListener("effects:enable",E)}},[t,r,i]);const d=f=>{let y="Unknown",w=f,x="other";if(f.includes(" - ")){const E=f.split(" - ");E.length>=2&&(y=E[0].trim(),w=E.slice(1).join(" - ").trim())}const C=f.toLowerCase();return C.includes("geiss")||y.toLowerCase().includes("geiss")?x="geiss":C.includes("martin")||y.toLowerCase().includes("martin")?x="martin":C.includes("flexi")||y.toLowerCase().includes("flexi")?x="flexi":(C.includes("shifter")||y.toLowerCase().includes("shifter"))&&(x="shifter"),{author:y,displayName:w,category:x}},g=()=>{try{if(!window.butterchurnPresets||typeof window.butterchurnPresets.getPresets!="function"){console.error("Butterchurn presets not available");return}const f=window.butterchurnPresets.getPresets(),y=Object.keys(f).map(w=>{const x=d(w);return{name:w,displayName:x.displayName,author:x.author,category:x.category,preset:f[w]}});console.log(" Loaded",y.length,"Butterchurn presets"),n(y)}catch(f){console.error("Failed to load effects:",f)}},S=async()=>{var f;try{if((f=window.kaiAPI)!=null&&f.settings){const y=await window.kaiAPI.settings.get("waveformPreferences");y!=null&&y.disabledEffects&&a(y.disabledEffects)}}catch(y){console.error("Failed to load disabled effects:",y)}},m=f=>{var w;const y=t.find(x=>x.name===f);if(y){s(f);try{const x=e==null?void 0:e.app;if(x&&x.player&&x.player.karaokeRenderer){const C=x.player.karaokeRenderer;C.setButterchurnPreset&&(console.log(" Applying effect:",y.displayName),C.setButterchurnPreset(y.preset))}x&&typeof x.updateEffectDisplay=="function"&&setTimeout(()=>x.updateEffectDisplay(),100),(w=window.kaiAPI)!=null&&w.renderer&&window.kaiAPI.renderer.updateEffectsState({current:f})}catch(x){console.error("Failed to apply effect:",x)}}},v=()=>{const f=t.filter(x=>!i.includes(x.name));if(f.length===0)return;const y=Math.floor(Math.random()*f.length),w=f[y];console.log(" Random effect:",w.displayName),m(w.name)},k=async f=>{var w;const y=i.filter(x=>x!==f);a(y);try{if((w=window.kaiAPI)!=null&&w.settings){const x=await window.kaiAPI.settings.get("waveformPreferences")||{};x.disabledEffects=y,await window.kaiAPI.settings.set("waveformPreferences",x)}}catch(x){console.error("Failed to save disabled effects:",x)}},p=async f=>{var w;const y=[...i,f];a(y);try{if((w=window.kaiAPI)!=null&&w.settings){const x=await window.kaiAPI.settings.get("waveformPreferences")||{};x.disabledEffects=y,await window.kaiAPI.settings.set("waveformPreferences",x)}}catch(x){console.error("Failed to save disabled effects:",x)}};return o.jsx(ep,{effects:t,currentEffect:r,disabledEffects:i,searchTerm:l,currentCategory:u,onSearch:c,onCategoryChange:h,onSelectEffect:m,onRandomEffect:v,onEnableEffect:k,onDisableEffect:p})}function np({requests:e,onApprove:t,onReject:n}){const r=async l=>{t&&await t(l)},s=async l=>{n&&await n(l)},i=e.filter(l=>l.status==="pending"),a=e.filter(l=>l.status!=="pending");return o.jsxs("div",{className:"requests-panel",children:[i.length>0&&o.jsxs("div",{className:"requests-section",children:[o.jsxs("h3",{children:["Pending Approval (",i.length,")"]}),o.jsx("div",{className:"requests-list",children:i.map(l=>o.jsxs("div",{className:"request-item pending",children:[o.jsxs("div",{className:"request-info",children:[o.jsxs("div",{className:"request-song",children:[o.jsx("strong",{children:l.song.title}),l.song.artist&&o.jsxs("span",{children:[" - ",l.song.artist]})]}),o.jsxs("div",{className:"request-meta",children:[o.jsxs("span",{className:"requester",children:["From: ",l.requesterName]}),l.message&&o.jsxs("span",{className:"message",children:['"',l.message,'"']})]})]}),o.jsxs("div",{className:"request-actions",children:[o.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>r(l.id),children:" Approve"}),o.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>s(l.id),children:" Reject"})]})]},l.id))})]}),a.length>0&&o.jsxs("div",{className:"requests-section",children:[o.jsx("h3",{children:"Recent Requests"}),o.jsx("div",{className:"requests-list",children:a.slice(0,10).map(l=>o.jsx("div",{className:`request-item ${l.status}`,children:o.jsxs("div",{className:"request-info",children:[o.jsxs("div",{className:"request-song",children:[o.jsx("strong",{children:l.song.title}),l.song.artist&&o.jsxs("span",{children:[" - ",l.song.artist]})]}),o.jsxs("div",{className:"request-meta",children:[o.jsxs("span",{className:"requester",children:["From: ",l.requesterName]}),o.jsx("span",{className:`status-badge ${l.status}`,children:l.status})]})]})},l.id))})]}),e.length===0&&o.jsx("div",{className:"requests-empty",children:o.jsx("p",{children:"No song requests yet"})})]})}function rp(){const[e,t]=T.useState([]);T.useEffect(()=>{const i=document.getElementById("requestsBadge");if(i){const a=e.filter(l=>l.status==="pending").length;a>0?(i.textContent=a,i.style.display="inline-flex"):i.style.display="none"}},[e]),T.useEffect(()=>{var a;n();const i=setInterval(n,5e3);if((a=window.kaiAPI)!=null&&a.events){const l=(h,d)=>{console.log(" New song request:",d),n()},c=(h,d)=>{console.log(" Request approved:",d),n()},u=(h,d)=>{console.log(" Request rejected:",d),n()};return window.kaiAPI.events.on("songRequest:new",l),window.kaiAPI.events.on("songRequest:approved",c),window.kaiAPI.events.on("songRequest:rejected",u),()=>{clearInterval(i),window.kaiAPI.events.removeListener("songRequest:new",l),window.kaiAPI.events.removeListener("songRequest:approved",c),window.kaiAPI.events.removeListener("songRequest:rejected",u)}}return()=>clearInterval(i)},[]);const n=async()=>{try{const i=await window.kaiAPI.webServer.getSongRequests();t(i||[])}catch(i){console.error("Failed to load requests:",i)}},r=async i=>{try{await window.kaiAPI.webServer.approveRequest(i),await n()}catch(a){console.error("Failed to approve request:",a)}},s=async i=>{try{await window.kaiAPI.webServer.rejectRequest(i),await n()}catch(a){console.error("Failed to reject request:",a)}};return o.jsx(np,{requests:e,onApprove:r,onReject:s})}function sp({lyricsData:e,selectedLineIndex:t,onLineSelect:n,vocalsWaveform:r,songDuration:s,currentPosition:i,isPlaying:a}){const l=T.useRef(null),c=T.useRef([]),u=3800,h=120;T.useEffect(()=>{const m=l.current;if(!m)return;const v=m.getContext("2d"),k=m.width,p=m.height;if(v.clearRect(0,0,k,p),v.fillStyle="rgba(0, 0, 0, 0.5)",v.fillRect(0,0,k,p),r&&r.length>0&&d(v,r,k,p),s>0&&e&&e.length>0){c.current=[];const f=[],y=[];e.forEach((w,x)=>{w.disabled!==!0&&(w.backup===!0?f.push({line:w,index:x}):y.push({line:w,index:x}))}),f.forEach(({line:w,index:x})=>{g(v,w,x,s,k,p,"rgba(255, 200, 0, 0.35)","rgba(255, 200, 0, 0.7)",t===x)}),y.forEach(({line:w,index:x})=>{g(v,w,x,s,k,p,"rgba(0, 100, 255, 0.35)","rgba(0, 255, 255, 0.9)",t===x)})}if(i>0&&s>0){const f=i/s*k;v.strokeStyle="rgba(255, 255, 255, 0.9)",v.lineWidth=2,v.beginPath(),v.moveTo(f,0),v.lineTo(f,p),v.stroke(),v.fillStyle="rgba(255, 255, 255, 0.9)";const y=p*.1,w=6;v.beginPath(),v.moveTo(f,y),v.lineTo(f-w,0),v.lineTo(f+w,0),v.closePath(),v.fill(),v.beginPath(),v.moveTo(f,p-y),v.lineTo(f-w,p),v.lineTo(f+w,p),v.closePath(),v.fill()}},[e,t,r,s,i,a]);const d=(m,v,k,p)=>{const f=p/2,y=p/256;m.strokeStyle="#ffffff",m.lineWidth=1,m.beginPath();for(let w=0;w<v.length;w++){const x=w/v.length*k,C=v[w],E=f-C*y;w===0?m.moveTo(x,E):m.lineTo(x,E)}m.stroke(),m.beginPath();for(let w=0;w<v.length;w++){const x=w/v.length*k,C=v[w],E=f+C*y;w===0?m.moveTo(x,E):m.lineTo(x,E)}m.stroke(),m.strokeStyle="rgba(255, 255, 255, 0.3)",m.lineWidth=1,m.beginPath(),m.moveTo(0,f),m.lineTo(k,f),m.stroke()},g=(m,v,k,p,f,y,w,x,C)=>{const E=v.start||v.startTimeSec||0,I=(v.end||v.endTimeSec||E+3)-E;if(I>0){const N=E/p*f,U=I/p*f,B=y*.05,G=y-B*2;c.current.push({x:N,y:B,width:U,height:G,lineIndex:k}),m.fillStyle=w,m.fillRect(N,B,U,G),C&&(m.strokeStyle=x,m.lineWidth=2,m.strokeRect(N,B,U,G))}},S=m=>{if(!c.current.length||!s)return;const v=l.current,k=v.getBoundingClientRect(),p=v.width/k.width,f=v.height/k.height,y=(m.clientX-k.left)*p,w=(m.clientY-k.top)*f;for(let x=c.current.length-1;x>=0;x--){const C=c.current[x];if(y>=C.x&&y<=C.x+C.width&&w>=C.y&&w<=C.y+C.height){n(C.lineIndex);const E=document.querySelector(`.lyric-line-editor[data-index="${C.lineIndex}"]`);E&&E.scrollIntoView({behavior:"smooth",block:"center"});break}}};return o.jsx("div",{className:"lyrics-waveform-container",children:o.jsx("canvas",{ref:l,width:u,height:h,onClick:S,style:{width:"100%",height:"auto",cursor:"pointer",display:"block"}})})}function ip({selectedLine:e,vocalsWaveform:t,songDuration:n,currentPosition:r,isPlaying:s}){const i=T.useRef(null),a=3800,l=120;T.useEffect(()=>{const h=i.current;if(!h)return;const d=h.getContext("2d"),g=h.width,S=h.height;if(d.clearRect(0,0,g,S),d.fillStyle="rgba(0, 0, 0, 0.5)",d.fillRect(0,0,g,S),!e||!t)return;const m=e.start||e.startTimeSec||0,v=e.end||e.endTimeSec||m+3,k=v-m;if(c(d,t,m,v,n,g,S),e.word_timing&&Array.isArray(e.word_timing)&&u(d,e.word_timing,k,g,S),s&&r>=m&&r<=v){const f=(r-m)/k*g;d.strokeStyle="rgba(255, 255, 255, 0.9)",d.lineWidth=2,d.beginPath(),d.moveTo(f,0),d.lineTo(f,S),d.stroke()}},[e,t,n,r,s]);const c=(h,d,g,S,m,v,k)=>{if(!d||d.length===0)return;const p=d.length/m,f=Math.floor(g*p),y=Math.floor(S*p),w=d.slice(f,y);if(w.length===0)return;const x=k/2,C=k/256;h.strokeStyle="#ffffff",h.lineWidth=1,h.beginPath();for(let E=0;E<w.length;E++){const M=E/w.length*v,I=w[E],N=x-I*C;E===0?h.moveTo(M,N):h.lineTo(M,N)}h.stroke(),h.beginPath();for(let E=0;E<w.length;E++){const M=E/w.length*v,I=w[E],N=x+I*C;E===0?h.moveTo(M,N):h.lineTo(M,N)}h.stroke(),h.strokeStyle="rgba(255, 255, 255, 0.3)",h.lineWidth=1,h.beginPath(),h.moveTo(0,x),h.lineTo(v,x),h.stroke()},u=(h,d,g,S,m)=>{if(!d||d.length===0)return;const v=m*.05,k=m-v*2,p="rgba(0, 255, 100, 0.35)",f="rgba(0, 255, 100, 0.7)";d.forEach(([y,w])=>{const x=y/g*S,C=(w-y)/g*S;h.fillStyle=p,h.fillRect(x,v,C,k),h.strokeStyle=f,h.lineWidth=1,h.strokeRect(x,v,C,k)})};return o.jsx("div",{className:"lyrics-waveform-container",children:o.jsx("canvas",{ref:i,width:a,height:l,style:{width:"100%",height:"auto",cursor:"crosshair",display:"block"}})})}function ap({line:e,index:t,isSelected:n,onSelect:r,onUpdate:s,onDelete:i,onAddAfter:a,onPlaySection:l,canAddAfter:c}){const u=e.start||e.startTimeSec||0,h=e.end||e.endTimeSec||u+3,d=e.text||"",g=e.disabled===!0,S=e.backup===!0,m=w=>{const x=parseFloat(w.target.value)||0;s(t,{...e,start:x,startTimeSec:x})},v=w=>{const x=parseFloat(w.target.value)||0;s(t,{...e,end:x,endTimeSec:x})},k=w=>{s(t,{...e,text:w.target.value})},p=w=>{s(t,{...e,backup:w.target.checked})},f=()=>{s(t,{...e,disabled:!g})},y=w=>{w.stopPropagation(),r(t),l(u,h)};return o.jsxs("div",{className:`lyric-line-editor ${g?"disabled":""} ${S?"backup":""} ${n?"selected":""}`,"data-index":t,"data-start-time":u,"data-end-time":h,onClick:()=>r(t),children:[o.jsx("span",{className:"line-number",onClick:y,children:t+1}),o.jsxs("div",{className:"time-inputs",children:[o.jsx("input",{type:"number",className:"time-input start-time",value:u.toFixed(1),onChange:m,step:"0.1",min:"0",onClick:w=>w.stopPropagation()}),o.jsx("span",{className:"time-separator",children:""}),o.jsx("input",{type:"number",className:"time-input end-time",value:h.toFixed(1),onChange:v,step:"0.1",min:"0",onClick:w=>w.stopPropagation()})]}),o.jsx("input",{type:"text",className:"text-input",value:d,onChange:k,placeholder:"Enter lyrics...",onClick:w=>w.stopPropagation()}),o.jsx("div",{className:"line-controls",children:o.jsxs("label",{className:"checkbox-label",onClick:w=>w.stopPropagation(),children:[o.jsx("input",{type:"checkbox",className:"backup-checkbox",checked:S,onChange:p}),o.jsx("span",{className:"checkbox-custom"}),"Backup"]})}),o.jsxs("div",{className:"line-actions",children:[o.jsx("button",{className:`btn-icon toggle-btn ${g?"toggle-disabled":"toggle-enabled"}`,title:g?"Enable line":"Disable line",onClick:w=>{w.stopPropagation(),f()},children:o.jsx("span",{className:"material-icons",children:g?"visibility_off":"visibility"})}),o.jsx("button",{className:"btn-icon delete-btn",title:"Delete line",onClick:w=>{w.stopPropagation(),confirm("Delete this lyric line?")&&i(t)},children:o.jsx("span",{className:"material-icons",children:"delete"})}),o.jsx("button",{className:"btn-icon add-after-btn",title:c?"Add line after":"Not enough space (need 0.6s gap)",disabled:!c,onClick:w=>{w.stopPropagation(),a(t)},children:o.jsx("span",{className:"material-icons",children:"add"})})]})]})}function op({message:e,type:t="info",onClose:n,duration:r=3e3}){return T.useEffect(()=>{if(r>0){const s=setTimeout(n,r);return()=>clearTimeout(s)}},[r,n]),o.jsx("div",{className:`toast toast-${t}`,onClick:n,children:o.jsxs("div",{className:"toast-content",children:[o.jsx("span",{className:"material-icons toast-icon",children:t==="success"?"check_circle":t==="error"?"error":"info"}),o.jsx("span",{className:"toast-message",children:e})]})})}function lp({rejection:e,rejectionIndex:t,onAccept:n,onDelete:r}){const s=async()=>{try{await navigator.clipboard.writeText(e.new_text)}catch(i){console.error("Failed to copy text:",i)}};return o.jsxs("div",{className:"lyric-rejection-box",children:[o.jsxs("div",{className:"rejection-header",children:[o.jsxs("span",{className:"rejection-label",children:[o.jsx("span",{className:"material-icons",children:"block"}),"Rejected Update (Line ",e.line_num,")"]}),o.jsx("button",{className:"rejection-delete-btn",title:"Delete this rejection",onClick:()=>r(t),children:o.jsx("span",{className:"material-icons",children:"delete"})})]}),o.jsxs("div",{className:"rejection-content",children:[o.jsxs("div",{className:"rejection-text-pair",children:[o.jsxs("div",{className:"rejection-text old-text",children:[o.jsx("label",{children:"Original:"}),o.jsx("div",{className:"text-content",children:e.old_text})]}),o.jsxs("div",{className:"rejection-text new-text",children:[o.jsx("label",{children:"Proposed:"}),o.jsx("div",{className:"text-content",children:e.new_text}),o.jsxs("div",{className:"rejection-actions",children:[o.jsxs("button",{className:"copy-text-btn",title:"Copy proposed text",onClick:s,children:[o.jsx("span",{className:"material-icons",children:"content_copy"}),"Copy"]}),o.jsxs("button",{className:"accept-text-btn",title:"Accept proposed text and replace current lyric",onClick:()=>n(t),children:[o.jsx("span",{className:"material-icons",children:"check_circle"}),"Accept"]})]})]})]}),o.jsxs("div",{className:"rejection-details",children:[o.jsxs("span",{className:"rejection-reason",children:["Reason: ",e.reason]}),e.retention_rate!==void 0&&o.jsxs("span",{className:"rejection-retention",children:["Retention: ",(e.retention_rate*100).toFixed(1),"% (min: ",(e.min_required*100).toFixed(1),"%)"]})]})]})]})}function _l(e){if(!e||isNaN(e))return"0:00";const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n.toString().padStart(2,"0")}`}function cp({suggestion:e,suggestionIndex:t,onAccept:n,onDelete:r}){const s=async()=>{try{await navigator.clipboard.writeText(e.suggested_text)}catch(l){console.error("Failed to copy text:",l)}},i=_l(e.start_time),a=_l(e.end_time);return o.jsxs("div",{className:"lyric-suggestion-box",children:[o.jsxs("div",{className:"suggestion-header",children:[o.jsxs("span",{className:"suggestion-label",children:[o.jsx("span",{className:"material-icons",children:"lightbulb"}),"Suggested Missing Line (",i," - ",a,")"]}),o.jsx("button",{className:"suggestion-delete-btn",title:"Delete this suggestion",onClick:()=>r(t),children:o.jsx("span",{className:"material-icons",children:"delete"})})]}),o.jsxs("div",{className:"suggestion-content",children:[o.jsxs("div",{className:"suggestion-text-display",children:[o.jsx("label",{children:"Suggested Text:"}),o.jsx("div",{className:"suggested-text-content",children:e.suggested_text})]}),o.jsxs("div",{className:"suggestion-details",children:[o.jsxs("span",{className:"suggestion-confidence",children:["Confidence: ",e.confidence]}),o.jsxs("span",{className:"suggestion-reason",children:["Reason: ",e.reason]}),e.pitch_activity&&o.jsxs("span",{className:"suggestion-pitch",children:["Pitch Activity: ",e.pitch_activity]})]}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsxs("button",{className:"accept-suggestion-btn",title:"Add this as a new lyric line",onClick:()=>n(t),children:[o.jsx("span",{className:"material-icons",children:"add_circle"}),"Add as New Line"]}),o.jsxs("button",{className:"copy-suggestion-btn",title:"Copy suggested text",onClick:s,children:[o.jsx("span",{className:"material-icons",children:"content_copy"}),"Copy Text"]})]})]})]})}function up({bridge:e}){var ko;const[t,n]=T.useState(""),[r,s]=T.useState([]),[i,a]=T.useState(!1),[l,c]=T.useState(null),[u,h]=T.useState(null),[d,g]=T.useState(!1),[S,m]=T.useState("metadata"),[v,k]=T.useState({title:"",artist:"",album:"",year:"",genre:"",key:""}),[p,f]=T.useState([]),[y,w]=T.useState([]),[x,C]=T.useState(null),[E,M]=T.useState(0),[I,N]=T.useState([]),[U,B]=T.useState([]),[G,ae]=T.useState(!1),[he,nt]=T.useState([]),[se,D]=T.useState(null),[b,O]=T.useState(!1),[J,ue]=T.useState(0),[R,z]=T.useState(null),[$,q]=T.useState(null),Y=T.useRef(null),[H,te]=T.useState(null);T.useEffect(()=>{const P=A=>{const L=A.target;if(!(L.tagName==="INPUT"||L.tagName==="TEXTAREA")&&!(S!=="lyrics"||!p.length))switch(A.key.toLowerCase()){case"q":A.preventDefault(),De();break;case"o":A.preventDefault(),rt();break;case"p":A.preventDefault(),Ue();break;case"a":A.preventDefault(),mo(-.1);break;case"s":A.preventDefault(),mo(.1);break;case"k":A.preventDefault(),go(-.1);break;case"l":A.preventDefault(),go(.1);break}};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[S,p,x,he]);const De=()=>{if(!(x===null||x===0)){for(let P=x-1;P>=0;P--)if(!p[P].disabled){C(P);return}}},rt=()=>{if(x===null){for(let P=0;P<p.length;P++)if(!p[P].disabled){C(P);return}return}if(!(x>=p.length-1)){for(let P=x+1;P<p.length;P++)if(!p[P].disabled){C(P);return}}},Ue=()=>{if(x===null||!p[x])return;const P=p[x],A=P.start||P.startTimeSec||0,L=P.end||P.endTimeSec||A+3;So(A,L)},mo=P=>{if(x===null||!p[x])return;const A=p[x],L=A.start||A.startTimeSec||0,_=Math.max(0,L+P),W={...A,start:_,startTimeSec:_};Zs(x,W)},go=P=>{if(x===null||!p[x])return;const A=p[x],L=A.end||A.endTimeSec||0,_=Math.max(0,L+P),W={...A,end:_,endTimeSec:_};Zs(x,W)},Ku=async P=>{if(n(P),!P.trim()){s([]);return}try{a(!0);const A=await e.searchSongs(P);s(A.songs||[])}catch(A){console.error("Search failed:",A)}finally{a(!1)}},Yu=async P=>{var A,L,_,W,Z,K,Ce,ft,Ee,fn,Qt,hn,pn,Po;try{console.log(" Loading song for editing:",P.path);const pe=await e.loadSongForEditing(P.path);if(pe.success){if(c(P),h(pe.data),k({title:((A=pe.data.metadata)==null?void 0:A.title)||P.title||"",artist:((L=pe.data.metadata)==null?void 0:L.artist)||P.artist||"",album:((_=pe.data.metadata)==null?void 0:_.album)||P.album||"",year:((W=pe.data.metadata)==null?void 0:W.year)||P.year||"",genre:((Z=pe.data.metadata)==null?void 0:Z.genre)||P.genre||"",key:((K=pe.data.metadata)==null?void 0:K.key)||P.key||""}),pe.data.format==="kai"){const Co=[...pe.data.lyrics||[]].sort((xe,Eo)=>{const md=xe.start||xe.startTimeSec||0,gd=Eo.start||Eo.startTimeSec||0;return md-gd});f(JSON.parse(JSON.stringify(Co))),w(JSON.parse(JSON.stringify(Co))),M(((Ce=pe.data.metadata)==null?void 0:Ce.duration)||((ft=pe.data.songJson)==null?void 0:ft.duration_sec)||0);const hd=((Qt=(fn=(Ee=pe.data.songJson)==null?void 0:Ee.meta)==null?void 0:fn.corrections)==null?void 0:Qt.rejected)||[];N(hd.map(xe=>({line_num:xe.line,start_time:xe.start,end_time:xe.end,old_text:xe.old,new_text:xe.new,reason:xe.reason,retention_rate:xe.word_retention,min_required:.5})));const pd=((Po=(pn=(hn=pe.data.songJson)==null?void 0:hn.meta)==null?void 0:pn.corrections)==null?void 0:Po.missing_lines_suggested)||[];B(pd.map(xe=>({suggested_text:xe.suggested_text,start_time:xe.start,end_time:xe.end,confidence:xe.confidence,reason:xe.reason,pitch_activity:xe.pitch_activity}))),ae(!1)}else f([]),w([]),M(0),N([]),B([]),ae(!1);s([]),n(""),m(pe.data.format==="kai"?"lyrics":"metadata"),pe.data.format==="kai"&&pe.data.audioFiles&&Xu(pe.data.audioFiles)}}catch(pe){console.error("Failed to load song:",pe)}},Xu=async P=>{var A;try{wo();const L=new(window.AudioContext||window.webkitAudioContext);D(L);const _=P.map(K=>{const Ce=new Audio(K.downloadUrl);Ce.crossOrigin="anonymous",Ce.preload="auto",Ce.volume=1;const ft=L.createMediaElementSource(Ce),Ee=L.createGain();ft.connect(Ee),Ee.connect(L.destination);const Qt=!K.name.toLowerCase().includes("vocal");return Ee.gain.value=Qt?0:1,{name:K.name,audio:Ce,source:ft,gainNode:Ee,muted:Qt,audioData:K.audioData}});nt(_),console.log(` Loaded ${_.length} audio sources for playback`);const W=P.find(K=>K.name.toLowerCase().includes("vocal")),Z=_.find(K=>K.name.toLowerCase().includes("vocal"));Z?(yo(Z.audio),vo(Z.audio,W==null?void 0:W.audioData)):_[0]&&(yo(_[0].audio),vo(_[0].audio,(A=P[0])==null?void 0:A.audioData))}catch(L){console.error("Failed to load audio files:",L)}},yo=P=>{const A=()=>{z(null),O(!1)};P.addEventListener("pause",A)};T.useEffect(()=>{if(b&&he.length>0){const P=()=>{var L;const A=(L=he[0])==null?void 0:L.audio;A&&!A.paused&&(ue(A.currentTime),Y.current=requestAnimationFrame(P))};return Y.current=requestAnimationFrame(P),()=>{Y.current&&cancelAnimationFrame(Y.current)}}},[b,he]),T.useEffect(()=>{R!==null&&J>=R&&(he.forEach(({audio:P})=>P.pause()),z(null),O(!1))},[J,R,he]);const vo=async(P,A)=>{try{let L;if(A&&(A instanceof ArrayBuffer?L=A:A.buffer instanceof ArrayBuffer&&(L=A.buffer.slice(A.byteOffset,A.byteOffset+A.byteLength))),!L&&(P!=null&&P.src)&&(L=await(await fetch(P.src)).arrayBuffer()),!L)throw new Error("No audio data available for waveform analysis");const _=new(window.AudioContext||window.webkitAudioContext),Z=(await _.decodeAudioData(L)).getChannelData(0),K=3800,Ce=Math.floor(Z.length/K),ft=new Int8Array(K);for(let Ee=0;Ee<K;Ee++){const fn=Ee*Ce,Qt=Math.min(fn+Ce,Z.length);let hn=0;for(let pn=fn;pn<Qt;pn++)hn=Math.max(hn,Math.abs(Z[pn]));ft[Ee]=Math.floor(hn*127)}q(ft),_.close(),console.log(" Waveform analysis complete")}catch(L){console.error("Failed to analyze waveform:",L)}},wo=()=>{he.forEach(({audio:P,source:A})=>{P.pause(),P.currentTime=0;try{A.disconnect()}catch{}}),se&&se.close(),nt([]),D(null),O(!1)},Ju=()=>{he.length&&(b?(he.forEach(({audio:P})=>P.pause()),O(!1)):(he.forEach(({audio:P})=>P.play()),O(!0)))},Zu=P=>{nt(A=>A.map((L,_)=>{if(_===P){const W=!L.muted;return L.gainNode.gain.value=W?0:1,{...L,muted:W}}return L}))};T.useEffect(()=>()=>wo(),[]);const dt=(P,A="success")=>{te({message:P,type:A})},Zs=(P,A)=>{f(L=>L.map((_,W)=>W===P?A:_)),ae(!0)},ed=P=>{f(A=>A.filter((L,_)=>_!==P)),C(null),ae(!0)},td=P=>{const A=p[P],L=p[P+1],_=A.end||A.endTimeSec||0,Z=(L&&(L.start||L.startTimeSec)||_+3)-_,K=Z*.8,Ce=Z*.1,ft={start:_+Ce,startTimeSec:_+Ce,end:_+Ce+K,endTimeSec:_+Ce+K,text:""};f(Ee=>[...Ee.slice(0,P+1),ft,...Ee.slice(P+1)]),ae(!0)},nd=()=>{const P=p[0];if(!P){f([{start:0,startTimeSec:0,end:3,endTimeSec:3,text:""}]),ae(!0);return}const _=(P.start||P.startTimeSec||0)*.8,W={start:0,startTimeSec:0,end:_,endTimeSec:_,text:""};f(Z=>[W,...Z]),ae(!0)},xo=()=>{const P=p[0];return P?(P.start||P.startTimeSec||0)>=.6:!0},So=async(P,A)=>{if(!he.length){console.warn("No audio elements available for playback");return}console.log(` Playing section: ${P}s - ${A}s`),z(null),he.forEach(({audio:L})=>{L.currentTime=P});try{const L=he.map(({audio:_})=>_.play());await Promise.all(L),O(!0),console.log(" Audio playback started")}catch(L){console.error("Failed to play audio:",L),te({message:`Failed to play audio: ${L.message}`,type:"error"});return}setTimeout(()=>{z(A)},50)},rd=P=>{const A=p[P],L=p[P+1];if(!L)return!0;const _=A.end||A.endTimeSec||0;return(L.start||L.startTimeSec||0)-_>=.6},dn=(P,A)=>{k(L=>({...L,[P]:A}))},sd=async()=>{if(!(!l||!u))try{g(!0);const P=[...p].sort((_,W)=>{const Z=_.start||_.startTimeSec||0,K=W.start||W.startTimeSec||0;return Z-K}),A={path:l.path,format:u.format,metadata:{...v,rejections:I,suggestions:U},...u.format==="kai"&&{lyrics:P}},L=await e.saveSongEdits(A);L.success?(console.log(" Song saved successfully"),dt("Song saved successfully","success"),ae(!1),w(JSON.parse(JSON.stringify(p)))):(console.error(" Save failed:",L.error),dt(`Save failed: ${L.error}`,"error"))}catch(P){console.error("Failed to save song:",P),dt(`Save failed: ${P.message}`,"error")}finally{g(!1)}},id=()=>{c(null),h(null),k({title:"",artist:"",album:"",year:"",genre:"",key:""}),f([])},ad=async()=>{if(l)try{await e.addToQueue(l),console.log(" Added to queue:",l.path),dt(`Added "${v.title||l.title}" to queue`,"success")}catch(P){console.error("Failed to add to queue:",P),dt("Failed to add to queue","error")}},od=()=>{if(!p||p.length===0)return;const P=p.map(W=>W.text||"").join(`
`),A=new Blob([P],{type:"text/plain"}),L=URL.createObjectURL(A),_=document.createElement("a");_.href=L,_.download=`${v.title||(l==null?void 0:l.title)||"lyrics"}.txt`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(L),dt("Lyrics exported successfully","success")},ld=()=>{confirm("Reset all changes to original lyrics?")&&(f(JSON.parse(JSON.stringify(y))),ae(!1),dt("Reset to original lyrics","success"))},cd=P=>{const A=I[P];if(!A)return;let L=-1;for(let _=0;_<p.length;_++){const W=p[_],Z=W.start||W.startTimeSec||0,K=W.end||W.endTimeSec||0;if(A.start_time!==void 0&&A.end_time!==void 0){if(Math.abs(Z-A.start_time)<.1&&Math.abs(K-A.end_time)<.1){L=_;break}}else if(A.old_text&&W.text===A.old_text){L=_;break}}if(L===-1){const _=A.line_num-1;_>=0&&_<p.length&&(L=_)}if(L>=0&&L<p.length){const _={...p[L],text:A.new_text};f(W=>W.map((Z,K)=>K===L?_:Z)),N(W=>W.filter((Z,K)=>K!==P)),ae(!0),dt("Accepted proposed text","success")}else dt("Could not find matching lyric line","error")},ud=P=>{N(A=>A.filter((L,_)=>_!==P)),ae(!0)},dd=P=>{const A=U[P];if(!A)return;let L=p.length;for(let W=0;W<p.length;W++){const Z=p[W],K=Z.start||Z.startTimeSec||0;if(A.start_time<K){L=W;break}}const _={start:A.start_time,startTimeSec:A.start_time,end:A.end_time,endTimeSec:A.end_time,text:A.suggested_text};f(W=>[...W.slice(0,L),_,...W.slice(L)]),B(W=>W.filter((Z,K)=>K!==P)),ae(!0),dt("Added suggested line","success")},fd=P=>{B(A=>A.filter((L,_)=>_!==P)),ae(!0)};return o.jsxs("div",{className:"song-editor",children:[l?o.jsxs("div",{className:"editor-edit-view",children:[o.jsxs("div",{className:"editor-header",children:[o.jsxs("div",{className:"editor-title-section",children:[o.jsx("h2",{children:l.title}),o.jsxs("p",{className:"editor-subtitle",children:[l.artist,"  ",(ko=u.format)==null?void 0:ko.toUpperCase()]})]}),o.jsxs("div",{className:"editor-actions",children:[o.jsxs("button",{onClick:ad,className:"btn btn-secondary",children:[o.jsx("span",{className:"material-icons",children:"playlist_add"}),"Add to Queue"]}),o.jsxs("button",{onClick:id,className:"btn btn-secondary",children:[o.jsx("span",{className:"material-icons",children:"close"}),"Close"]}),o.jsxs("button",{onClick:sd,className:"btn btn-primary",disabled:d,style:G?{background:"#007acc"}:{},children:[o.jsx("span",{className:"material-icons",children:"save"}),d?"Saving...":G?"Save*":"Save"]})]})]}),u.format==="kai"&&o.jsxs("div",{className:"editor-tabs",children:[o.jsx("button",{className:`editor-tab ${S==="lyrics"?"active":""}`,onClick:()=>m("lyrics"),children:"Lyrics"}),o.jsx("button",{className:`editor-tab ${S==="metadata"?"active":""}`,onClick:()=>m("metadata"),children:"Metadata"})]}),(S==="metadata"||u.format!=="kai")&&o.jsxs("div",{className:"editor-form",children:[o.jsx("h3",{children:"Metadata"}),o.jsxs("div",{className:"form-grid",children:[o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Title"}),o.jsx("input",{type:"text",value:v.title,onChange:P=>dn("title",P.target.value)})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Artist"}),o.jsx("input",{type:"text",value:v.artist,onChange:P=>dn("artist",P.target.value)})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Album"}),o.jsx("input",{type:"text",value:v.album,onChange:P=>dn("album",P.target.value)})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Year"}),o.jsx("input",{type:"text",value:v.year,onChange:P=>dn("year",P.target.value)})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Genre"}),o.jsx("input",{type:"text",value:v.genre,onChange:P=>dn("genre",P.target.value)})]}),o.jsxs("div",{className:"form-field",children:[o.jsx("label",{children:"Key"}),o.jsx("input",{type:"text",value:v.key,onChange:P=>dn("key",P.target.value)})]})]})]}),u.format==="kai"&&S==="lyrics"&&o.jsxs(o.Fragment,{children:[o.jsx(sp,{lyricsData:p,selectedLineIndex:x,onLineSelect:C,vocalsWaveform:$,songDuration:E,currentPosition:J,isPlaying:b}),o.jsx(ip,{selectedLine:x!==null?p[x]:null,vocalsWaveform:$,songDuration:E,currentPosition:J,isPlaying:b}),he.length>0&&o.jsxs("div",{className:"audio-playback-controls",children:[o.jsxs("button",{onClick:Ju,className:"btn btn-primary",children:[o.jsx("span",{className:"material-icons",children:b?"pause":"play_arrow"}),b?"Pause":"Play"]}),o.jsx("div",{className:"audio-mixer",children:he.map((P,A)=>o.jsxs("div",{className:"mixer-channel",children:[o.jsx("span",{className:"channel-name",children:P.name}),o.jsxs("button",{onClick:()=>Zu(A),className:`btn btn-sm ${P.muted?"btn-danger":"btn-success"}`,children:[o.jsx("span",{className:"material-icons",children:P.muted?"volume_off":"volume_up"}),P.muted?"Muted":"On"]})]},A))}),o.jsxs("button",{onClick:od,className:"btn btn-secondary",disabled:!p||p.length===0,title:"Export lyrics as text file",children:[o.jsx("span",{className:"material-icons",children:"download"}),"Export"]}),o.jsxs("button",{onClick:ld,className:"btn btn-secondary",disabled:!G,title:"Reset to original lyrics",children:[o.jsx("span",{className:"material-icons",children:"restore"}),"Reset"]}),o.jsxs("button",{onClick:nd,className:"btn",disabled:!xo(),title:xo()?"Add line at beginning":"Not enough space (need 0.6s gap)",children:[o.jsx("span",{className:"material-icons",children:"add"}),"Add First Line"]})]}),o.jsxs("div",{className:"lyrics-editor-scroll-container",children:[o.jsx("div",{className:"lyrics-lines",children:p&&p.length>0?p.map((P,A)=>o.jsx(ap,{line:P,index:A,isSelected:x===A,onSelect:C,onUpdate:Zs,onDelete:ed,onAddAfter:td,onPlaySection:So,canAddAfter:rd(A)},`lyric-${A}`)):o.jsx("div",{className:"no-lyrics-message",children:"No lyrics available. Load a KAI file with lyrics to edit."})}),(I.length>0||U.length>0)&&o.jsxs("div",{className:"ai-corrections-section",children:[o.jsx("h3",{children:"AI Corrections & Suggestions"}),I.map((P,A)=>o.jsx(lp,{rejection:P,rejectionIndex:A,onAccept:cd,onDelete:ud},`rejection-${A}`)),U.map((P,A)=>o.jsx(cp,{suggestion:P,suggestionIndex:A,onAccept:dd,onDelete:fd},`suggestion-${A}`))]})]})]})]}):o.jsxs("div",{className:"editor-search-view",children:[o.jsxs("div",{className:"editor-search-bar",children:[o.jsx("input",{type:"text",placeholder:"Search by title, artist, or album...",value:t,onChange:P=>Ku(P.target.value),className:"editor-search-input"}),i&&o.jsx("span",{className:"editor-search-spinner",children:""}),r.length>0&&o.jsx("div",{className:"editor-search-dropdown",children:r.map((P,A)=>o.jsxs("div",{className:"search-dropdown-item",onClick:()=>Yu(P),children:[o.jsx("span",{className:"search-format-icon",children:Xs(P.format)}),o.jsxs("div",{className:"search-dropdown-info",children:[o.jsx("div",{className:"search-dropdown-title",children:P.title}),o.jsxs("div",{className:"search-dropdown-meta",children:[P.artist," ",P.album&&` ${P.album}`]})]})]},A))})]}),t&&!i&&r.length===0&&o.jsxs("div",{className:"editor-empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-message",children:"No songs found"}),o.jsx("div",{className:"empty-detail",children:"Try a different search term"})]}),!t&&o.jsxs("div",{className:"editor-empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("div",{className:"empty-message",children:"Search for a song to get started"}),o.jsx("div",{className:"empty-detail",children:"You can edit metadata and lyrics for any song in your library"})]})]}),H&&o.jsx(op,{message:H.message,type:H.type,onClose:()=>te(null)})]})}function dp({mixer:e,mixerState:t,onSetMasterGain:n,onToggleMasterMute:r,onGainChange:s,onMuteToggle:i,className:a=""}){const l=t||e||{},c=n||s,u=r||i,h=[{id:"PA",label:"PA (Main)",description:"Music + Mic to audience"},{id:"IEM",label:"IEM (Monitors)",description:"Vocals only (mono)"},{id:"mic",label:"Mic Input",description:"Microphone gain"}],d=(m,v)=>{c&&c(m,parseFloat(v))},g=m=>{u&&u(m)},S=(m,v)=>{v.target.value=0,d(m,0)};return o.jsx("div",{className:`mixer-strips ${a}`,children:h.map(m=>{var p,f;const v=((p=l[m.id])==null?void 0:p.gain)??0,k=((f=l[m.id])==null?void 0:f.muted)??!1;return o.jsxs("div",{className:"mixer-strip master-fader","data-bus":m.id,children:[o.jsxs("div",{className:"fader-label",children:[o.jsx("div",{className:"fader-name",children:m.label}),o.jsx("div",{className:"fader-description",children:m.description})]}),o.jsxs("div",{className:"gain-control",children:[o.jsx("input",{type:"range",className:"gain-slider",min:"-60",max:"12",step:"0.5",value:v,onChange:y=>d(m.id,y.target.value),onDoubleClick:y=>S(m.id,y),"data-bus":m.id}),o.jsxs("div",{className:"gain-value",children:[v.toFixed(1)," dB"]})]}),o.jsx("button",{className:`mute-btn ${k?"active":""}`,onClick:()=>g(m.id),"data-bus":m.id,children:"MUTE"})]},m.id)})})}function fp({devices:e={pa:[],iem:[],input:[]},selected:t={pa:"",iem:"",input:""},settings:n={iemMonoVocals:!0,micToSpeakers:!0,enableMic:!0},onDeviceChange:r,onSettingChange:s,onRefreshDevices:i}){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"audio-settings-section",children:[o.jsxs("h3",{children:["Audio Devices",o.jsx("button",{onClick:i,className:"refresh-btn",title:"Refresh device list",children:""})]}),o.jsxs("div",{className:"device-selector",children:[o.jsx("label",{children:"PA Output:"}),o.jsxs("select",{id:"paDeviceSelect",value:t.pa||"",onChange:a=>r&&r("pa",a.target.value),children:[o.jsx("option",{value:"",children:"Default"}),e.pa&&e.pa.map(a=>o.jsx("option",{value:a.deviceId,children:a.label||a.deviceId},a.deviceId))]})]}),o.jsxs("div",{className:"device-selector",children:[o.jsx("label",{children:"IEM Output:"}),o.jsxs("select",{id:"iemDeviceSelect",value:t.iem||"",onChange:a=>r&&r("iem",a.target.value),children:[o.jsx("option",{value:"",children:"Default"}),e.iem&&e.iem.map(a=>o.jsx("option",{value:a.deviceId,children:a.label||a.deviceId},a.deviceId))]})]}),o.jsx("div",{className:"device-selector",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",id:"iemMonoVocals",checked:n.iemMonoVocals??!0,onChange:a=>s&&s("iemMonoVocals",a.target.checked)}),"IEM Vocals in Mono (for single earpiece)"]})})]}),o.jsxs("div",{className:"audio-settings-section",children:[o.jsx("h3",{children:"Mic Options"}),o.jsxs("div",{className:"device-selector",children:[o.jsx("label",{children:"Mic Input:"}),o.jsxs("select",{id:"inputDeviceSelect",value:t.input||"",onChange:a=>r&&r("input",a.target.value),children:[o.jsx("option",{value:"",children:"Default"}),e.input&&e.input.map(a=>o.jsx("option",{value:a.deviceId,children:a.label||a.deviceId},a.deviceId))]})]}),o.jsxs("div",{className:"waveform-controls",children:[o.jsxs("label",{className:"audio-checkbox",children:[o.jsx("input",{type:"checkbox",id:"micToSpeakers",checked:n.micToSpeakers??!0,onChange:a=>s&&s("micToSpeakers",a.target.checked)}),o.jsx("span",{children:"Mic to Speakers"})]}),o.jsxs("label",{className:"audio-checkbox",children:[o.jsx("input",{type:"checkbox",id:"enableMic",checked:n.enableMic??!0,onChange:a=>s&&s("enableMic",a.target.checked)}),o.jsx("span",{children:"Enable Mic"})]})]})]})]})}function hp({bridge:e}){const[t,n]=T.useState({PA:{gain:0,muted:!1},IEM:{gain:0,muted:!1},mic:{gain:0,muted:!1}}),[r,s]=T.useState({pa:[],iem:[],input:[]}),[i,a]=T.useState({pa:"",iem:"",input:""}),[l,c]=T.useState({iemMonoVocals:!0,micToSpeakers:!0,enableMic:!0});T.useEffect(()=>{var v,k;if(!e)return;const m=(v=e.onMixerChanged)==null?void 0:v.call(e,p=>{const f={PA:p.PA||{gain:0,muted:!1},IEM:p.IEM||{gain:0,muted:!1},mic:p.mic||{gain:0,muted:!1}};n(f)});return(k=e.getMixerState)==null||k.call(e).then(p=>{const f={PA:p.PA||{gain:0,muted:!1},IEM:p.IEM||{gain:0,muted:!1},mic:p.mic||{gain:0,muted:!1}};n(f)}).catch(console.error),()=>m&&m()},[e]),T.useEffect(()=>{if(!e)return;(async()=>{var v,k,p,f;try{const y=await((v=e.getAudioSettings)==null?void 0:v.call(e));y&&c(y);const w=await((k=e.getAudioDevices)==null?void 0:k.call(e)),x=w.filter(I=>I.maxOutputChannels>0),C=w.filter(I=>I.maxInputChannels>0);s({pa:x,iem:x,input:C});const E=await((p=e.getDevicePreferences)==null?void 0:p.call(e)),M={};for(const[I,N]of Object.entries(E||{})){if(!N)continue;const U=I==="input"?C:x;let B=U.find(G=>G.deviceId===N.id);if(!B&&N.name&&(B=U.find(G=>G.label===N.name||G.name===N.name)),B){const G=I.toLowerCase();M[G]=B.deviceId,await((f=e.setAudioDevice)==null?void 0:f.call(e,I,B.deviceId))}}Object.keys(M).length>0&&a(I=>({...I,...M}))}catch(y){console.error("Failed to load devices and preferences:",y)}})()},[e]);const u=(m,v)=>{var k;(k=e==null?void 0:e.setMasterGain)==null||k.call(e,m,v)},h=m=>{var v;(v=e==null?void 0:e.toggleMasterMute)==null||v.call(e,m)},d=async(m,v)=>{var p,f,y;const k=m==="pa"?"PA":m==="iem"?"IEM":m;try{await((p=e==null?void 0:e.setAudioDevice)==null?void 0:p.call(e,k,v)),a(C=>({...C,[m]:v}));const x=(m==="input"?r.input:r.pa).find(C=>C.deviceId===v);if(x){const C=await((f=e.getDevicePreferences)==null?void 0:f.call(e))||{};C[k]={id:v,name:x.label||x.name,deviceKind:x.deviceKind},await((y=e.saveDevicePreferences)==null?void 0:y.call(e,C))}}catch(w){console.error("Failed to change device:",w)}},g=async(m,v)=>{var k;c(p=>({...p,[m]:v}));try{await((k=e.saveAudioSettings)==null?void 0:k.call(e,{[m]:v}))}catch(p){console.error("Failed to save audio setting:",p)}},S=()=>{var m;(m=e==null?void 0:e.getAudioDevices)==null||m.call(e).then(v=>{const k=v.filter(f=>f.maxOutputChannels>0),p=v.filter(f=>f.maxInputChannels>0);s({pa:k,iem:k,input:p})}).catch(console.error)};return o.jsxs("div",{className:"mixer-tab-container",children:[o.jsxs("div",{className:"mixer-section",children:[o.jsx("h2",{children:"Audio Mixer"}),o.jsx(dp,{mixerState:t,onSetMasterGain:u,onToggleMasterMute:h})]}),o.jsx(fp,{devices:r,selected:i,settings:l,onDeviceChange:d,onSettingChange:g,onRefreshDevices:S})]})}function pp({queue:e=[],currentIndex:t=-1,currentSongId:n=null,onPlayFromQueue:r,onRemoveFromQueue:s,onLoad:i,onRemove:a,onClearQueue:l,onClear:c,onShuffleQueue:u,onReorderQueue:h,onQuickSearch:d,className:g=""}){const[S,m]=T.useState(null),[v,k]=T.useState(null),p=r||i,f=s||a,y=l||c,w=(I,N)=>{h&&(m(N),I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("text/html",I.currentTarget))},x=(I,N)=>{!h||S===null||(I.preventDefault(),I.dataTransfer.dropEffect="move",k(N))},C=()=>{k(null)},E=(I,N)=>{if(!(!h||S===null)){if(I.preventDefault(),S!==N){const U=e[S];h(U.id,N)}m(null),k(null)}},M=()=>{m(null),k(null)};return e.length===0?o.jsxs("div",{className:`player-queue-section ${g}`,children:[d&&o.jsxs("div",{className:"quick-search-controls",children:[o.jsx("input",{type:"text",id:"quickLibrarySearch",placeholder:"Search...",onInput:I=>d(I.target.value)}),o.jsx("div",{className:"quick-search-dropdown",id:"quickSearchResults",style:{display:"none"},children:o.jsx("div",{className:"no-search-message",children:"Type to search your library"})})]}),o.jsxs("div",{className:"player-queue-header",children:[o.jsx("h4",{children:"Queue"}),o.jsxs("div",{className:"queue-actions",children:[y&&o.jsx("button",{onClick:y,className:"queue-action-btn",title:"Clear Queue",children:o.jsx("span",{className:"material-icons",children:"delete"})}),u&&o.jsx("button",{onClick:u,className:"queue-action-btn",title:"Shuffle",children:o.jsx("span",{className:"material-icons",children:"shuffle"})})]})]}),o.jsx("div",{className:"player-queue-list",children:o.jsxs("div",{className:"player-queue-empty",children:[o.jsx("span",{className:"material-icons empty-icon",children:"queue_music"}),o.jsx("div",{className:"empty-message",children:"Queue is empty"})]})})]}):o.jsxs("div",{className:`player-queue-section ${g}`,children:[d&&o.jsxs("div",{className:"quick-search-controls",children:[o.jsx("input",{type:"text",id:"quickLibrarySearch",placeholder:"Search...",onInput:I=>d(I.target.value)}),o.jsx("div",{className:"quick-search-dropdown",id:"quickSearchResults",style:{display:"none"},children:o.jsx("div",{className:"no-search-message",children:"Type to search your library"})})]}),o.jsxs("div",{className:"player-queue-header",children:[o.jsx("h4",{children:"Queue"}),o.jsxs("div",{className:"queue-actions",children:[y&&o.jsx("button",{onClick:y,className:"queue-action-btn",title:"Clear Queue",children:o.jsx("span",{className:"material-icons",children:"delete"})}),u&&o.jsx("button",{onClick:u,className:"queue-action-btn",title:"Shuffle",children:o.jsx("span",{className:"material-icons",children:"shuffle"})})]})]}),o.jsx("div",{className:"player-queue-list",children:e.map((I,N)=>{let U=!1;t>=0&&N===t?U=!0:typeof n=="number"&&(U=I.id===n);const B=U?"player-queue-item current":"player-queue-item",G=I.requester?`  Singer: ${I.requester}`:"",nt=`${B}${S===N?" dragging":""}${v===N?" drag-over":""}`;return o.jsxs("div",{className:nt,"data-item-id":I.id,draggable:!!h,onDragStart:se=>w(se,N),onDragOver:se=>x(se,N),onDragLeave:C,onDrop:se=>E(se,N),onDragEnd:M,children:[o.jsx("div",{className:"queue-item-number",children:N+1}),o.jsxs("div",{className:"queue-item-info",children:[o.jsx("div",{className:"queue-item-title",title:I.title,children:I.title}),o.jsxs("div",{className:"queue-item-artist",title:`${I.artist}${G}`,children:[I.artist,G]})]}),o.jsxs("div",{className:"queue-item-actions",children:[p&&o.jsx("button",{onClick:()=>p(I.id||I.path),className:"queue-item-btn",title:"Load Song",children:o.jsx("span",{className:"material-icons",children:"queue_play_next"})}),f&&o.jsx("button",{onClick:()=>f(I.id),className:"queue-item-btn",title:"Remove",children:o.jsx("span",{className:"material-icons",children:"close"})})]})]},I.id)})})]})}function mp({bridge:e}){const[t,n]=T.useState([]),[r,s]=T.useState(-1),[i,a]=T.useState([]),[l,c]=T.useState(!1),[u,h]=T.useState(""),d=T.useRef(null),g=T.useRef(null);T.useEffect(()=>{var x,C;if(!e)return;const w=(x=e.onQueueChanged)==null?void 0:x.call(e,E=>{if(n(E.queue||[]),E.currentSong&&E.currentSong.queueItemId){const I=(E.queue||[]).findIndex(N=>N.id===E.currentSong.queueItemId);s(I)}else s(-1)});return(C=e.getQueue)==null||C.call(e).then(E=>{if(n(E.queue||[]),E.currentSong&&E.currentSong.queueItemId){const I=(E.queue||[]).findIndex(N=>N.id===E.currentSong.queueItemId);s(I)}else s(-1)}).catch(console.error),()=>w&&w()},[e]),T.useEffect(()=>{var x;if(!e)return;const w=(x=e.onCurrentSongChanged)==null?void 0:x.call(e,C=>{if(C&&C.queueItemId){console.log(" Matching by queueItemId:",C.queueItemId,"in queue:",t.map(M=>M.id));const E=t.findIndex(M=>M.id===C.queueItemId);console.log("   Found at index:",E),s(E)}else console.log(" No queueItemId, setting currentIndex to -1"),s(-1)});return()=>w&&w()},[e,t]);const S=async w=>{if(h(w),!w.trim()){c(!1),a([]);return}try{const x=await e.searchSongs(w);if(!x.success||!x.songs){a([]),c(!0);return}a(x.songs.slice(0,8)),c(!0)}catch(x){console.error("Quick search error:",x),a([]),c(!0)}},m=async w=>{const x={path:w.path,title:w.title||w.name.replace(".kai",""),artist:w.artist||"Unknown Artist",duration:w.duration,requester:"KJ",addedVia:"ui"};await e.addToQueue(x),h(""),c(!1),a([])},v=async w=>{await e.playFromQueue(w)},k=async w=>{await e.removeFromQueue(w)},p=async()=>{t.length>0&&confirm("Are you sure you want to clear the queue?")&&await e.clearQueue()},f=async()=>{console.warn("Shuffle not implemented in bridge yet")},y=async(w,x)=>{await e.reorderQueue(w,x)};return T.useEffect(()=>{const w=x=>{g.current&&!g.current.contains(x.target)&&d.current&&!d.current.contains(x.target)&&c(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),o.jsxs("div",{className:"queue-tab-container",children:[o.jsxs("div",{className:"quick-search-section",children:[o.jsx("input",{ref:d,type:"text",className:"quick-search-input",placeholder:"Quick search library...",value:u,onChange:w=>S(w.target.value),onFocus:()=>u&&c(!0)}),l&&o.jsx("div",{ref:g,className:"quick-search-dropdown",children:i.length===0?o.jsx("div",{className:"no-search-message",children:u?"No matches found":"Type to search your library"}):i.map(w=>o.jsxs("div",{className:"quick-search-item",children:[o.jsxs("div",{className:"quick-search-info",children:[o.jsxs("div",{className:"quick-search-title",children:[o.jsx("span",{className:"format-icon",children:Xs(w.format)}),w.title]}),o.jsx("div",{className:"quick-search-artist",children:w.artist})]}),o.jsx("button",{className:"quick-search-add-btn",onClick:()=>m(w),title:"Add to Queue",children:o.jsx("span",{className:"material-icons",children:"playlist_add"})})]},w.path))})]}),o.jsx(pp,{queue:t,currentIndex:r,onPlayFromQueue:v,onRemoveFromQueue:k,onClearQueue:p,onShuffleQueue:f,onReorderQueue:y})]})}function gp({currentSong:e,onMenuClick:t,sidebarCollapsed:n=!1,className:r=""}){const s=e!=null&&e.format?Xs(e.format):"",i=e!=null&&e.isLoading?" Loading...":e?`${e.title||"Unknown"} - ${e.artist||"Unknown Artist"}`:"No song loaded";return o.jsxs("div",{className:`song-info-bar ${r}`,children:[o.jsx("div",{className:"song-info-left",children:t&&o.jsx("button",{onClick:t,className:"hamburger-btn-info",children:o.jsx("span",{className:"material-icons",children:n?"menu_open":"menu"})})}),o.jsx("div",{className:"song-info-center",children:o.jsxs("div",{className:"song-info",children:[s&&o.jsx("span",{className:"format-icon",children:s}),o.jsx("span",{className:"song-display",children:i})]})}),o.jsx("div",{className:"song-info-right"})]})}function yp({bridge:e}){const[t,n]=T.useState(null),[r,s]=T.useState(!1);T.useEffect(()=>{var l,c,u;if(!e)return;const a=(l=e.onCurrentSongChanged)==null?void 0:l.call(e,h=>{n(h)});return(c=e.getQueue)==null||c.call(e).then(h=>{h.currentSong&&n(h.currentSong)}).catch(console.error),(u=e.api)==null||u.settings.get("sidebarCollapsed",!1).then(h=>{s(h);const d=document.querySelector(".sidebar");d&&h&&d.classList.add("collapsed")}).catch(console.error),()=>a&&a()},[e]);const i=async()=>{var c;const a=document.querySelector(".sidebar");if(!a)return;const l=!r;s(l),l?a.classList.add("collapsed"):a.classList.remove("collapsed");try{await((c=e.api)==null?void 0:c.settings.set("sidebarCollapsed",l))}catch(u){console.error("Failed to save sidebar state:",u)}};return o.jsx(gp,{currentSong:t,onMenuClick:i,sidebarCollapsed:r})}function vp({playback:e,currentSong:t,currentEffect:n,isLoading:r,onPlay:s,onPause:i,onRestart:a,onNext:l,onSeek:c,onPreviousEffect:u,onNextEffect:h,onOpenCanvasWindow:d,className:g=""}){const{isPlaying:S,position:m=0,duration:v=0}=e||{},k=r!==void 0?r:(t==null?void 0:t.isLoading)||!1,p=y=>{if(!v||!c)return;const w=y.currentTarget.getBoundingClientRect(),x=y.clientX-w.left,E=Math.max(0,Math.min(1,x/w.width))*v;c(E)},f=v>0?m/v*100:0;return o.jsxs("div",{className:`transport-extended ${g}`,children:[o.jsxs("div",{className:"play-controls",children:[o.jsx("button",{onClick:a,title:"Restart Track",className:"transport-btn",disabled:k,children:o.jsx("span",{className:"material-icons",children:"replay"})}),o.jsx("button",{onClick:S?i:s,title:k?"Loading...":S?"Pause":"Play",className:"transport-btn play-pause-btn",disabled:k,children:k?o.jsx("span",{className:"material-icons rotating",children:"hourglass_empty"}):o.jsx("span",{className:"material-icons",children:S?"pause":"play_arrow"})}),o.jsx("button",{onClick:l,title:"Next Track",className:"transport-btn",disabled:k,children:o.jsx("span",{className:"material-icons",children:"skip_next"})}),o.jsx("div",{className:"progress-container",children:o.jsxs("div",{className:"progress-bar",onClick:p,children:[o.jsx("div",{className:"progress-fill",style:{width:`${f}%`}}),o.jsx("div",{className:"progress-handle",style:{left:`${f}%`}})]})}),o.jsxs("div",{className:"time-display",children:[o.jsx("span",{children:Ds(m)}),o.jsx("span",{children:"/"}),o.jsx("span",{children:Ds(v)})]})]}),o.jsxs("div",{className:"effects-controls",children:[u&&o.jsx("button",{onClick:u,title:"Previous Effect",children:" FX"}),o.jsx("span",{className:"current-effect-name",children:n||"Effect"}),h&&o.jsx("button",{onClick:h,title:"Next Effect",children:"FX "}),d&&o.jsx("button",{onClick:d,className:"icon-btn",title:"Open Canvas Window",children:o.jsx("span",{className:"material-icons",children:"open_in_new"})})]})]})}function wp({bridge:e}){const[t,n]=T.useState({isPlaying:!1,position:0,duration:0}),[r,s]=T.useState(null),[i,a]=T.useState("");T.useEffect(()=>{var p,f,y,w,x;if(!e)return;const k=[];return k.push((p=e.onPlaybackStateChanged)==null?void 0:p.call(e,C=>{n(C)})),k.push((f=e.onCurrentSongChanged)==null?void 0:f.call(e,C=>{s(C)})),k.push((y=e.onEffectChanged)==null?void 0:y.call(e,C=>{a(C.current||"")})),Promise.all([(w=e.getPlaybackState)==null?void 0:w.call(e).then(n).catch(()=>{}),(x=e.getQueue)==null?void 0:x.call(e).then(C=>{C.currentSong&&s(C.currentSong)}).catch(()=>{})]),()=>{k.forEach(C=>C&&C())}},[e]);const l=()=>{var k;return(k=e.play)==null?void 0:k.call(e)},c=()=>{var k;return(k=e.pause)==null?void 0:k.call(e)},u=()=>{var k;return(k=e.restart)==null?void 0:k.call(e)},h=()=>{var k;return(k=e.playNext)==null?void 0:k.call(e)},d=k=>{var p;return(p=e.seek)==null?void 0:p.call(e,k)},g=()=>{var k;return(k=e.previousEffect)==null?void 0:k.call(e)},S=()=>{var k;return(k=e.nextEffect)==null?void 0:k.call(e)},m=()=>{var k,p;(p=(k=window.kaiAPI)==null?void 0:k.window)!=null&&p.openCanvas&&window.kaiAPI.window.openCanvas()},v=(r==null?void 0:r.isLoading)||!1;return o.jsx(vp,{playback:t,currentSong:r,currentEffect:i,isLoading:v,onPlay:l,onPause:c,onRestart:u,onNext:h,onSeek:d,onPreviousEffect:g,onNextEffect:S,onOpenCanvasWindow:m})}function xp({bridge:e}){const[t,n]=T.useState("Ready"),[r,s]=T.useState(null),[i,a]=T.useState(null),[l,c]=T.useState(0);T.useEffect(()=>{if(!e)return;const h=[];if(e.onLatencyUpdate){const g=e.onLatencyUpdate(S=>{a(S)});g&&h.push(g)}if(e.onXRunUpdate){const g=e.onXRunUpdate(S=>{c(S)});g&&h.push(g)}e.getServerUrl&&e.getServerUrl().then(g=>{s(g||null)}).catch(console.error);const d=setInterval(()=>{e.getServerUrl&&e.getServerUrl().then(g=>{s(g||null)}).catch(console.error)},5e3);return()=>{h.forEach(g=>g&&g()),clearInterval(d)}},[e]);const u=()=>{r&&(e!=null&&e.openExternal)&&e.openExternal(r)};return o.jsxs("div",{className:"status-bar",children:[o.jsx("div",{className:"status-left",children:o.jsx("span",{children:t})}),o.jsx("div",{className:"status-center",children:r&&o.jsxs("span",{className:"web-url-display",onClick:u,title:"Click to open in browser",children:[" ",r]})}),o.jsxs("div",{className:"status-right",children:[o.jsxs("span",{children:["Latency: ",i!==null?`${i.toFixed(1)} ms`:"-- ms"]}),o.jsxs("span",{children:["XRuns: ",l]})]})]})}function Sp({requestsCount:e=0}){const[t,n]=T.useState("player"),r=[{id:"player",label:"Player"},{id:"library",label:"Library"},{id:"mixer",label:"Audio Settings"},{id:"effects",label:"Effects"},{id:"requests",label:"Song Requests",badge:e},{id:"server",label:"Server"},{id:"editor",label:"Lyrics Editor"}],s=i=>{var l,c,u;document.querySelectorAll(".tab-pane").forEach(h=>{h.classList.remove("active")});const a=document.getElementById(`${i}-tab`);a&&a.classList.add("active"),n(i),i==="player"&&((u=(c=(l=window.kaiPlayerApp)==null?void 0:l.player)==null?void 0:c.karaokeRenderer)!=null&&u.resizeHandler)&&setTimeout(()=>{window.kaiPlayerApp.player.karaokeRenderer.resizeHandler()},10)};return o.jsx("div",{className:"tab-nav",children:r.map(i=>o.jsxs("button",{className:`tab-btn ${t===i.id?"active":""}`,onClick:()=>s(i.id),children:[i.label,i.badge>0&&o.jsx("span",{className:"tab-badge",children:i.badge})]},i.id))})}function kp({bridge:e}){const[t,n]=T.useState(null),[r,s]=T.useState(null),[i,a]=T.useState({serverName:"Loukai Karaoke",port:3069,allowSongRequests:!0,requireKJApproval:!0,streamVocalsToClients:!1}),[l,c]=T.useState(""),[u,h]=T.useState(!1),[d,g]=T.useState(0),[S,m]=T.useState(0),[v,k]=T.useState(null);T.useEffect(()=>{if(!e)return;(async()=>{try{const B=await e.getServerUrl();if(n(B),B){const ae=new URL(B).port;s(ae)}const G=await e.getServerSettings();if(G&&a({serverName:G.serverName||"Loukai Karaoke",port:G.port||3069,allowSongRequests:G.allowSongRequests!==!1,requireKJApproval:G.requireKJApproval!==!1,streamVocalsToClients:G.streamVocalsToClients===!0}),e.getAdminPasswordStatus){const ae=await e.getAdminPasswordStatus();h(ae)}p()}catch(B){console.error("Failed to load server data:",B)}})();const U=setInterval(()=>{e.getServerUrl&&e.getServerUrl().then(B=>{if(n(B),B){const G=new URL(B).port;s(G)}}).catch(console.error),p()},5e3);return()=>clearInterval(U)},[e]);const p=async()=>{try{if(!(e!=null&&e.getRequests))return;const N=await e.getRequests(),U=N.filter(B=>B.status==="pending").length;g(U),m(N.length)}catch{}},f=async()=>{try{await e.updateServerSettings(i),E("Settings saved successfully","success")}catch(N){console.error("Failed to save settings:",N),E("Failed to save settings","error")}},y=async()=>{const N=l.trim();if(!N){E("Please enter a password","error");return}if(N.length<6){E("Password must be at least 6 characters","error");return}try{e.setAdminPassword&&(await e.setAdminPassword(N),c(""),h(!0),E("Admin password set successfully","success"))}catch(U){console.error("Failed to set password:",U),E("Failed to set admin password","error")}},w=()=>{t&&(e!=null&&e.openExternal)&&e.openExternal(t)},x=async()=>{try{r&&(e!=null&&e.openExternal)&&e.openExternal(`http://localhost:${r}/admin`)}catch(N){console.error("Failed to open admin panel:",N)}},C=async()=>{if(confirm("Are you sure you want to clear all song requests? This cannot be undone."))try{e.clearAllRequests&&(await e.clearAllRequests(),E("All requests cleared","success"),p())}catch(N){console.error("Failed to clear requests:",N),E("Failed to clear requests","error")}},E=(N,U="info")=>{k({text:N,type:U}),setTimeout(()=>k(null),3e3)},M=(N,U)=>{a(B=>({...B,[N]:U}))},I=!!t;return o.jsxs("div",{className:"server-container",children:[v&&o.jsx("div",{className:`server-message ${v.type}`,children:v.text}),o.jsxs("div",{className:"server-header",children:[o.jsx("h2",{children:"Web Server Settings"}),o.jsxs("div",{className:"server-status",children:[o.jsx("span",{className:`status-indicator ${I?"online":"offline"}`}),o.jsx("span",{children:I?`Running on port ${r}`:"Not running"})]})]}),o.jsxs("div",{className:"server-content",children:[o.jsxs("div",{className:"server-section",children:[o.jsx("h3",{children:"Server Control"}),o.jsx("div",{className:"server-controls",children:o.jsxs("div",{className:"control-row",children:[o.jsx("label",{children:"Server Status:"}),o.jsxs("div",{className:"control-group",children:[o.jsx("span",{children:t||"Not running"}),o.jsxs("button",{className:"action-btn",onClick:w,disabled:!I,children:[o.jsx("span",{className:"material-icons",children:"open_in_new"}),"Open in Browser"]})]})]})})]}),o.jsxs("div",{className:"server-section",children:[o.jsx("h3",{children:"General Settings"}),o.jsxs("div",{className:"settings-grid",children:[o.jsxs("div",{className:"setting-row",children:[o.jsx("label",{htmlFor:"serverName",children:"Server Name:"}),o.jsx("input",{type:"text",id:"serverName",className:"setting-input",placeholder:"Loukai Karaoke",value:i.serverName,onChange:N=>M("serverName",N.target.value)})]}),o.jsxs("div",{className:"setting-row",children:[o.jsx("label",{htmlFor:"serverPort",children:"Port:"}),o.jsx("input",{type:"number",id:"serverPort",className:"setting-input",placeholder:"3069",min:"1024",max:"65535",value:i.port,onChange:N=>M("port",parseInt(N.target.value)||3069)})]}),o.jsx("div",{className:"setting-description",children:"Server must be restarted for port changes to take effect"}),o.jsx("div",{className:"setting-row",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",id:"allowSongRequests",checked:i.allowSongRequests,onChange:N=>M("allowSongRequests",N.target.checked)}),o.jsx("span",{children:"Allow Song Requests"})]})}),o.jsx("div",{className:"setting-row",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",id:"requireKJApproval",checked:i.requireKJApproval,onChange:N=>M("requireKJApproval",N.target.checked)}),o.jsx("span",{children:"Require KJ Approval"})]})}),o.jsx("div",{className:"setting-row",children:o.jsxs("label",{className:"checkbox-label",children:[o.jsx("input",{type:"checkbox",id:"streamVocalsToClients",checked:i.streamVocalsToClients,onChange:N=>M("streamVocalsToClients",N.target.checked)}),o.jsx("span",{children:"Stream Vocals to Clients (LAN only)"})]})}),o.jsx("div",{className:"setting-row",children:o.jsxs("button",{className:"save-btn",onClick:f,children:[o.jsx("span",{className:"material-icons",children:"save"}),"Save Settings"]})})]})]}),o.jsxs("div",{className:"server-section",children:[o.jsx("h3",{children:"Admin Security"}),o.jsxs("div",{className:"settings-grid",children:[o.jsxs("div",{className:"setting-row",children:[o.jsx("label",{htmlFor:"adminPassword",children:"Admin Password:"}),o.jsxs("div",{className:"password-group",children:[o.jsx("input",{type:"password",id:"adminPassword",className:"setting-input",placeholder:"Enter new admin password",value:l,onChange:N=>c(N.target.value)}),o.jsxs("button",{className:"action-btn",onClick:y,children:[o.jsx("span",{className:"material-icons",children:"security"}),"Set Password"]})]})]}),o.jsx("div",{className:"setting-description",children:"KJs will need this password to access the admin panel"}),o.jsx("div",{className:"setting-row",children:o.jsx("div",{className:`password-status ${u?"set":""}`,children:u?"Admin password is set":"No admin password set"})})]})]}),o.jsxs("div",{className:"server-section",children:[o.jsx("h3",{children:"Song Requests"}),o.jsxs("div",{className:"requests-summary",children:[o.jsxs("div",{className:"summary-stats",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-value",children:d}),o.jsx("span",{className:"stat-label",children:"Pending"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("span",{className:"stat-value",children:S}),o.jsx("span",{className:"stat-label",children:"Total"})]})]}),o.jsxs("div",{className:"requests-actions",children:[o.jsxs("button",{className:"action-btn",onClick:x,children:[o.jsx("span",{className:"material-icons",children:"admin_panel_settings"}),"Open Admin Panel"]}),o.jsxs("button",{className:"action-btn danger",onClick:C,children:[o.jsx("span",{className:"material-icons",children:"delete_sweep"}),"Clear All Requests"]})]})]})]})]})]})}function Pp({bridge:e,waveformSettings:t=null,autotuneSettings:n=null,onWaveformChange:r=null,onAutotuneChange:s=null}){const[i,a]=T.useState({enableWaveforms:!0,enableEffects:!0,randomEffectOnSong:!1,showUpcomingLyrics:!0,overlayOpacity:.7}),[l,c]=T.useState({enabled:!1,strength:50,speed:20});T.useEffect(()=>{if(!e)return;(async()=>{var g,S;try{const m=await((g=e.getWaveformPreferences)==null?void 0:g.call(e));m&&a(k=>({...k,...m}));const v=await((S=e.getAutotunePreferences)==null?void 0:S.call(e));v&&c(k=>({...k,...v}))}catch(m){console.error("Failed to load preferences:",m)}})()},[e]),T.useEffect(()=>{t&&a(d=>({...d,...t}))},[t]),T.useEffect(()=>{n&&c(d=>({...d,...n}))},[n]),T.useEffect(()=>{var S,m;if(!e)return;const d=(S=e.onSettingsChanged)==null?void 0:S.call(e,"waveform",v=>{console.log(" VisualizationSettings received waveform update:",v),a(k=>({...k,...v}))}),g=(m=e.onSettingsChanged)==null?void 0:m.call(e,"autotune",v=>{console.log(" VisualizationSettings received autotune update:",v),c(k=>({...k,...v}))});return()=>{d==null||d(),g==null||g()}},[e]);const u=async(d,g)=>{var m;const S={...i,[d]:g};a(S),r&&r(S);try{await((m=e.saveWaveformPreferences)==null?void 0:m.call(e,S))}catch(v){console.error("Failed to save waveform preferences:",v)}},h=async(d,g)=>{var m,v,k;const S={...l,[d]:g};c(S),s&&s(S);try{await((m=e.saveAutotunePreferences)==null?void 0:m.call(e,S)),d==="enabled"?await((v=e.setAutotuneEnabled)==null?void 0:v.call(e,g)):await((k=e.setAutotuneSettings)==null?void 0:k.call(e,S))}catch(p){console.error("Failed to save autotune preferences:",p)}};return o.jsxs("div",{className:"visualization-settings",children:[o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Waveform Options"}),o.jsxs("div",{className:"waveform-controls",children:[o.jsxs("label",{className:"setting-checkbox",children:[o.jsx("input",{type:"checkbox",checked:i.enableWaveforms,onChange:d=>u("enableWaveforms",d.target.checked)}),o.jsx("span",{children:"Enable Waveforms"})]}),o.jsxs("label",{className:"setting-checkbox",children:[o.jsx("input",{type:"checkbox",checked:i.enableEffects,onChange:d=>u("enableEffects",d.target.checked)}),o.jsx("span",{children:"Enable Background Effects"})]}),o.jsxs("label",{className:"setting-checkbox",children:[o.jsx("input",{type:"checkbox",checked:i.randomEffectOnSong,onChange:d=>u("randomEffectOnSong",d.target.checked)}),o.jsx("span",{children:"Random Effect on New Song"})]}),o.jsxs("label",{className:"setting-checkbox",children:[o.jsx("input",{type:"checkbox",checked:i.showUpcomingLyrics,onChange:d=>u("showUpcomingLyrics",d.target.checked)}),o.jsx("span",{children:"Show Upcoming Lyrics"})]}),o.jsxs("div",{className:"slider-control",children:[o.jsxs("label",{children:["Overlay Opacity: ",o.jsx("span",{className:"slider-value",children:i.overlayOpacity.toFixed(2)})]}),o.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:i.overlayOpacity,onChange:d=>u("overlayOpacity",parseFloat(d.target.value))})]})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h3",{children:"Auto-Tune"}),o.jsxs("div",{className:"autotune-controls",children:[o.jsxs("label",{className:"setting-checkbox",children:[o.jsx("input",{type:"checkbox",checked:l.enabled,onChange:d=>h("enabled",d.target.checked)}),o.jsx("span",{children:"Enable Auto-Tune"})]}),o.jsxs("div",{className:"slider-control",children:[o.jsxs("label",{children:["Strength: ",o.jsxs("span",{className:"slider-value",children:[l.strength,"%"]})]}),o.jsx("input",{type:"range",min:"0",max:"100",value:l.strength,onChange:d=>h("strength",parseInt(d.target.value))})]}),o.jsxs("div",{className:"slider-control",children:[o.jsxs("label",{children:["Speed: ",o.jsx("span",{className:"slider-value",children:l.speed})]}),o.jsx("input",{type:"range",min:"1",max:"100",value:l.speed,onChange:d=>h("speed",parseInt(d.target.value))})]})]})]})]})}function Cp(){if(console.log("Butterchurn libraries loaded:",{butterchurn:typeof window.butterchurn,presets:typeof window.butterchurnPresets}),window.butterchurnPresets&&typeof window.butterchurnPresets.getPresets=="function"){const e=window.butterchurnPresets.getPresets();console.log("SUCCESS: Butterchurn loaded with",Object.keys(e).length,"presets available")}else return console.error("FAILED: Butterchurn presets not properly loaded"),!1;try{const e=document.createElement("canvas"),t=e.getContext("webgl2")||e.getContext("webgl");if(console.log("WebGL context test:",{hasWebGL:!!t,version:t?t.getParameter(t.VERSION):"none",renderer:t?t.getParameter(t.RENDERER):"none"}),!t)return console.error("FAILED: WebGL not available - Butterchurn effects will not work"),!1}catch(e){return console.error("WebGL test error:",e),!1}return!0}let va=null;function Ep(e){va=e}function Zn(){return va||console.warn("App instance not yet initialized"),va}async function Np(e,t,n){var c,u,h,d,g;if(e.player.currentFormat="cdg",e.player.currentPlayer=e.player.cdgPlayer,e.player.currentPlayer.onSongEnded(()=>e.handleSongEnded()),!e.kaiPlayer){console.error(" Audio engine not initialized"),e.updateStatus("Error: Audio engine not ready");return}const r=e.kaiPlayer.audioContexts.PA,s=e.kaiPlayer.outputNodes.PA.masterGain,i=r.createGain();i.connect(s);const a=r.createAnalyser();a.fftSize=2048,i.connect(a),e.player.cdgPlayer.setAudioContext(r,i,a),await e.player.cdgPlayer.loadSong(t);const l=await window.kaiAPI.settings.get("waveformPreferences",{enableEffects:!0,randomEffectOnSong:!1,overlayOpacity:.7});await e.player.karaokeRenderer.ensureInputDeviceSelection(),e.player.cdgPlayer.setOverlayOpacity(l.overlayOpacity),e.player.cdgPlayer.setEffectsEnabled(l.enableEffects),await Tp(e,t,l),e.player.onSongLoaded(n),(c=window.kaiAPI)!=null&&c.renderer&&window.kaiAPI.renderer.songLoaded({path:((u=e.currentSong)==null?void 0:u.originalFilePath)||((h=e.currentSong)==null?void 0:h.filePath),metadata:n,isLoading:!1,title:(n==null?void 0:n.title)||"CDG Song",artist:(n==null?void 0:n.artist)||"Unknown Artist",format:"cdg",duration:((d=e.player.cdgPlayer)==null?void 0:d.getDuration())||0,requester:((g=e.currentSong)==null?void 0:g.requester)||"KJ"}),e.updateStatus(`Loaded: ${(n==null?void 0:n.title)||"CDG Song"}`)}async function Ap(e,t,n){var r;if(e.player.currentFormat="kai",e.player.currentPlayer=e.kaiPlayer,e.player.currentPlayer.onSongEnded(()=>e.handleSongEnded()),e.kaiPlayer&&e.currentSong){const s={...e.currentSong,audio:e.currentSong.audio?{...e.currentSong.audio,sources:e.currentSong.audio.sources?[...e.currentSong.audio.sources]:[]}:null};await e.kaiPlayer.reinitialize(),await e.kaiPlayer.loadSong(s),!e.currentSong.audio&&s.audio&&(e.currentSong.audio=s.audio),!e.currentSong.lyrics&&s.lyrics&&(e.currentSong.lyrics=s.lyrics)}if(e.player&&e.currentSong){e.player.karaokeRenderer&&e.player.karaokeRenderer.reinitialize();const s={...n,lyrics:e.currentSong.lyrics,duration:e.kaiPlayer?e.kaiPlayer.getDuration():((r=e.currentSong.metadata)==null?void 0:r.duration)||0,audio:e.currentSong.audio};e.player.onSongLoaded(s);const i=await window.kaiAPI.settings.get("waveformPreferences",{enableWaveforms:!0,enableEffects:!0,randomEffectOnSong:!1,showUpcomingLyrics:!0,overlayOpacity:.7});e.player.karaokeRenderer&&(e.player.karaokeRenderer.setWaveformsEnabled(i.enableWaveforms),e.player.karaokeRenderer.setEffectsEnabled(i.enableEffects),e.player.karaokeRenderer.setShowUpcomingLyrics(i.showUpcomingLyrics),e.player.karaokeRenderer.waveformPreferences.overlayOpacity=i.overlayOpacity,i.enableWaveforms&&setTimeout(()=>{e.player.karaokeRenderer.startMicrophoneCapture()},100),setTimeout(()=>e.updateEffectDisplay(),100),await Qu(e,i))}await new Promise(s=>setTimeout(s,500)),e._pendingMetadata=null}async function Tp(e,t,n){e.player.karaokeRenderer.effectsCanvas&&e.player.karaokeRenderer.butterchurn&&(e.player.cdgPlayer.setEffectsCanvas(e.player.karaokeRenderer.effectsCanvas,e.player.karaokeRenderer.butterchurn),await e.player.karaokeRenderer.setMusicAudio(t.audio.mp3),await Qu(e,n))}async function Qu(e,t){t.randomEffectOnSong&&e.player.karaokeRenderer.butterchurn&&(e.randomEffectTimeout&&clearTimeout(e.randomEffectTimeout),e.randomEffectTimeout=setTimeout(async()=>{try{await window.kaiAPI.effects.random()}catch(n){console.error("Failed to apply random effect:",n)}},500))}class Js{constructor(){if(this.constructor===Js)throw new Error("PlayerInterface is abstract and cannot be instantiated directly");this.isPlaying=!1,this.stateReportInterval=null,this.onSongEndedCallback=null}async play(){throw new Error("play() must be implemented by subclass")}async pause(){throw new Error("pause() must be implemented by subclass")}async seek(t){throw new Error("seek() must be implemented by subclass")}getCurrentPosition(){throw new Error("getCurrentPosition() must be implemented by subclass")}getDuration(){throw new Error("getDuration() must be implemented by subclass")}async loadSong(t){throw new Error("loadSong() must be implemented by subclass")}reportStateChange(){var t;if((t=window.kaiAPI)!=null&&t.renderer){const n={isPlaying:this.isPlaying,position:this.getCurrentPosition(),duration:this.getDuration()};window.kaiAPI.renderer.updatePlaybackState(n)}}startStateReporting(){this.stopStateReporting(),this.stateReportInterval=setInterval(()=>{this.isPlaying&&this.reportStateChange()},100)}stopStateReporting(){this.stateReportInterval&&(clearInterval(this.stateReportInterval),this.stateReportInterval=null)}resetPosition(){this.isPlaying&&this.pause(),this.stopStateReporting(),this.isPlaying=!1}onSongEnded(t){this.onSongEndedCallback=t}_triggerSongEnd(){this.stopStateReporting(),this.isPlaying=!1,this.onSongEndedCallback&&this.onSongEndedCallback()}getFormat(){throw new Error("getFormat() must be implemented by subclass")}destroy(){this.stopStateReporting(),this.isPlaying&&this.pause()}}class jp extends Js{constructor(){super(),this.audioContexts={PA:null,IEM:null},this.outputDevices={PA:"default",IEM:"default"},this.inputDevice="default",this.currentPosition=0,this.songData=null,this.audioBuffers=new Map,this.outputNodes={PA:{sourceNodes:new Map,gainNodes:new Map,masterGain:null},IEM:{sourceNodes:new Map,gainNodes:new Map,masterGain:null}},this.startTime=0,this.pauseTime=0,this.microphoneStream=null,this.microphoneSource=null,this.microphoneGain=null,this.autoTuneNode=null,this.autoTuneWorkletLoaded=!1,this.mixerState={PA:{gain:0,muted:!1},IEM:{gain:0,muted:!1,mono:!0},mic:{gain:0,muted:!1},stems:[],autotuneSettings:{enabled:!1,strength:50,speed:5},micToSpeakers:!0,enableMic:!0}}async initialize(){try{await this.loadDevicePreferences();const t={};this.outputDevices.PA!=="default"&&"sinkId"in AudioContext.prototype&&(t.sinkId=this.outputDevices.PA),this.audioContexts.PA=new(window.AudioContext||window.webkitAudioContext)(t),this.outputNodes.PA.masterGain=this.audioContexts.PA.createGain(),this.outputNodes.PA.masterGain.connect(this.audioContexts.PA.destination);const n=this.mixerState.PA.muted?0:this.dbToLinear(this.mixerState.PA.gain);this.outputNodes.PA.masterGain.gain.value=n;const r={};this.outputDevices.IEM!=="default"&&"sinkId"in AudioContext.prototype&&(r.sinkId=this.outputDevices.IEM),this.audioContexts.IEM=new(window.AudioContext||window.webkitAudioContext)(r),this.outputNodes.IEM.masterGain=this.audioContexts.IEM.createGain(),this.outputNodes.IEM.masterGain.connect(this.audioContexts.IEM.destination);const s=this.mixerState.IEM.muted?0:this.dbToLinear(this.mixerState.IEM.gain);return this.outputNodes.IEM.masterGain.gain.value=s,await this.loadAutoTuneWorklet(),await this.loadMicSettings(),!0}catch(t){return console.error("Failed to initialize dual audio contexts:",t),!1}}async loadDevicePreferences(){var t,n,r,s,i,a,l,c,u,h;try{if(window.kaiAPI.settings){const d=await window.kaiAPI.settings.get("devicePreferences",null);(t=d==null?void 0:d.PA)!=null&&t.id&&(this.outputDevices.PA=d.PA.id),(n=d==null?void 0:d.IEM)!=null&&n.id&&(this.outputDevices.IEM=d.IEM.id),(r=d==null?void 0:d.input)!=null&&r.id&&(this.inputDevice=d.input.id)}if((s=window.kaiAPI)!=null&&s.app){const d=await window.kaiAPI.app.getState();d!=null&&d.mixer&&(typeof((i=d.mixer.PA)==null?void 0:i.gain)=="number"&&(this.mixerState.PA.gain=d.mixer.PA.gain),typeof((a=d.mixer.PA)==null?void 0:a.muted)=="boolean"&&(this.mixerState.PA.muted=d.mixer.PA.muted),typeof((l=d.mixer.IEM)==null?void 0:l.gain)=="number"&&(this.mixerState.IEM.gain=d.mixer.IEM.gain),typeof((c=d.mixer.IEM)==null?void 0:c.muted)=="boolean"&&(this.mixerState.IEM.muted=d.mixer.IEM.muted),typeof((u=d.mixer.mic)==null?void 0:u.gain)=="number"&&(this.mixerState.mic.gain=d.mixer.mic.gain),typeof((h=d.mixer.mic)==null?void 0:h.muted)=="boolean"&&(this.mixerState.mic.muted=d.mixer.mic.muted))}}catch(d){console.error("Failed to load device preferences:",d)}}async setOutputDevice(t,n){try{if(!["PA","IEM"].includes(t))return console.error("Invalid bus type:",t),!1;const r=this.isPlaying,s=this.currentPosition;r&&this.pause(),this.outputDevices[t]=n,this.audioContexts[t]&&await this.audioContexts[t].close();const i={};return n!=="default"&&"sinkId"in AudioContext.prototype&&(i.sinkId=n),this.audioContexts[t]=new(window.AudioContext||window.webkitAudioContext)(i),this.outputNodes[t].masterGain=this.audioContexts[t].createGain(),this.outputNodes[t].masterGain.connect(this.audioContexts[t].destination),this.outputNodes[t].sourceNodes.clear(),this.outputNodes[t].gainNodes.clear(),this.songData&&await this.reloadAudioBuffersForBus(t),r&&this.songData&&(this.currentPosition=s,await this.play()),!0}catch(r){return console.error(`Failed to set ${t} output device:`,r),!1}}async loadSong(t){var n;return this.songData=t,this.resetPosition(),this.currentPosition=0,this.startTime=0,this.pauseTime=0,this.monitoringStartTime=null,this.stopSongEndMonitoring(),this.mixerState.stems=(((n=t.audio)==null?void 0:n.sources)||[]).map((r,s)=>({id:r.name||r.filename,name:r.name||r.filename,gain:r.gain||0,index:s})),await this.loadAudioBuffers(t),this.reportSongLoaded(),this.reportStateChange(),!0}reportSongLoaded(){var t,n,r;if((t=window.kaiAPI)!=null&&t.renderer&&this.songData){const s=this.getDuration();window.kaiAPI.renderer.songLoaded({path:this.songData.originalFilePath||this.songData.filePath,title:((n=this.songData.metadata)==null?void 0:n.title)||"Unknown",artist:((r=this.songData.metadata)==null?void 0:r.artist)||"Unknown",duration:s,isLoading:!1,format:"kai"}),this.reportMixerState()}}reportMixerState(){var t;(t=window.kaiAPI)!=null&&t.renderer&&this.mixerState&&window.kaiAPI.renderer.updateMixerState(this.mixerState)}async loadAudioBuffers(t){var r;if(!((r=t.audio)!=null&&r.sources)){console.warn("No audio sources found in song data");return}this.audioContext||await this.initialize();for(const s of t.audio.sources)try{if(s.audioData&&s.audioData.length>0){const i=s.audioData.buffer.slice(s.audioData.byteOffset,s.audioData.byteOffset+s.audioData.byteLength),a=await this.audioContexts.PA.decodeAudioData(i);this.audioBuffers.set(s.name,a)}else console.warn(`No audio data for source: ${s.name}`)}catch(i){console.error(`Failed to decode audio for ${s.name}:`,i)}let n=0;for(const[s,i]of this.audioBuffers)i.duration>n&&(n=i.duration);n>0?(this.songData.metadata||(this.songData.metadata={}),this.songData.metadata.duration=n):console.warn("No audio buffers loaded, duration remains 0")}async reloadAudioBuffersForBus(t){var n,r;if(!(!((r=(n=this.songData)==null?void 0:n.audio)!=null&&r.sources)||!this.audioContexts[t])){for(const s of this.songData.audio.sources)if(s.audioData&&s.audioData.length>0)try{if(!this.audioBuffers.has(s.name)){const i=s.audioData.buffer.slice(s.audioData.byteOffset,s.audioData.byteOffset+s.audioData.byteLength),a=await this.audioContexts[t].decodeAudioData(i);this.audioBuffers.set(s.name,a)}}catch(i){console.error(`Failed to reload audio buffer for ${t} - ${s.name}:`,i)}}}async play(){return this.songData?!this.audioContexts.PA||!this.audioContexts.IEM?(console.error("Audio contexts not initialized"),!1):(this.audioContexts.PA.state==="suspended"&&await this.audioContexts.PA.resume(),this.audioContexts.IEM.state==="suspended"&&await this.audioContexts.IEM.resume(),this.isPlaying=!0,this.stopAllSources(),this.createAudioGraph(),this.startAudioSources(),this.startSongEndMonitoring(),this.startStateReporting(),this.reportStateChange(),!0):(console.error("No song loaded"),!1)}async pause(){return this.isPlaying=!1,this.audioContexts.PA&&(this.pauseTime=this.audioContexts.PA.currentTime),this.stopAllSources(),this.stopSongEndMonitoring(),this.stopStateReporting(),this.reportStateChange(),!0}async seek(t){return this.currentPosition=t,this.isPlaying&&(this.stopAllSources(),this.startAudioSources()),this.reportStateChange(),!0}stopAllSources(){this.outputNodes.PA.sourceNodes.size+this.outputNodes.IEM.sourceNodes.size,this.outputNodes.PA.sourceNodes.forEach((t,n)=>{try{t.stop(),t.disconnect()}catch{}}),this.outputNodes.PA.sourceNodes.clear(),this.outputNodes.IEM.sourceNodes.forEach((t,n)=>{try{t.stop(),t.disconnect()}catch{}}),this.outputNodes.IEM.sourceNodes.clear()}createAudioGraph(){!this.audioContexts.PA||!this.audioContexts.IEM||(this.outputNodes.PA.gainNodes.clear(),this.outputNodes.IEM.gainNodes.clear(),this.mixerState.stems.forEach(t=>{const n=this.audioContexts.PA.createGain();n.connect(this.outputNodes.PA.masterGain),this.outputNodes.PA.gainNodes.set(t.name,n);const r=this.audioContexts.IEM.createGain();if(this.isVocalStem(t.name)&&this.mixerState.iemMonoVocals){const s=this.audioContexts.IEM.createChannelMerger(1);r.connect(s),s.connect(this.outputNodes.IEM.masterGain)}else r.connect(this.outputNodes.IEM.masterGain);this.outputNodes.IEM.gainNodes.set(t.name,r),this.updateStemGain(t)}))}startAudioSources(){if(!this.audioContexts.PA||!this.audioContexts.IEM)return;const t=Math.max(this.audioContexts.PA.currentTime,this.audioContexts.IEM.currentTime)+.1;this.startTime=t,this.mixerState.stems.forEach(n=>{const r=this.audioBuffers.get(n.name),s=this.outputNodes.PA.gainNodes.get(n.name),i=this.outputNodes.IEM.gainNodes.get(n.name);if(r&&s&&i)try{const a=Math.min(this.currentPosition,r.duration);if(this.isVocalStem(n.name)){const c=this.audioContexts.IEM.createBufferSource();c.buffer=r,c.connect(i),c.start(t,a),this.outputNodes.IEM.sourceNodes.set(n.name,c)}else{const c=this.audioContexts.PA.createBufferSource();c.buffer=r,c.connect(s),c.start(t,a),this.outputNodes.PA.sourceNodes.set(n.name,c),c.onended=()=>{this.isPlaying&&setTimeout(()=>this.checkForSongEnd(),10)}}}catch(a){console.error(`Failed to start source for ${n.name}:`,a)}else console.warn(`No audio buffer or gain nodes for stem: ${n.name}`)}),this.outputNodes.PA.gainNodes.forEach((n,r)=>{})}isVocalStem(t){const n=["vocals","vocal","voice","lead","singing","vox"],r=t.toLowerCase();return n.some(s=>r.includes(s))}updateStemGain(t){const n=this.outputNodes.PA.gainNodes.get(t.name),r=this.outputNodes.IEM.gainNodes.get(t.name),s=this.isVocalStem(t.name);if(!this.audioContexts.PA||!this.audioContexts.IEM)return;const i=Math.pow(10,t.gain/20);s&&r?r.gain.setValueAtTime(i,this.audioContexts.IEM.currentTime):!s&&n&&n.gain.setValueAtTime(i,this.audioContexts.PA.currentTime)}setMasterGain(t,n){if(!["PA","IEM","mic"].includes(t))return!1;if(this.mixerState[t].gain=n,t==="PA"&&this.outputNodes.PA.masterGain){const r=this.dbToLinear(n);this.outputNodes.PA.masterGain.gain.setValueAtTime(r,this.audioContexts.PA.currentTime)}else if(t==="IEM"&&this.outputNodes.IEM.masterGain){const r=this.dbToLinear(n);this.outputNodes.IEM.masterGain.gain.setValueAtTime(r,this.audioContexts.IEM.currentTime)}return this.reportMixerState(),!0}toggleMasterMute(t){if(!["PA","IEM","mic"].includes(t))return!1;this.mixerState[t].muted=!this.mixerState[t].muted;const n=this.mixerState[t].muted;if(t==="PA"&&this.outputNodes.PA.masterGain){const r=n?0:this.dbToLinear(this.mixerState.PA.gain);this.outputNodes.PA.masterGain.gain.setValueAtTime(r,this.audioContexts.PA.currentTime)}else if(t==="IEM"&&this.outputNodes.IEM.masterGain){const r=n?0:this.dbToLinear(this.mixerState.IEM.gain);this.outputNodes.IEM.masterGain.gain.setValueAtTime(r,this.audioContexts.IEM.currentTime)}return this.reportMixerState(),!0}setMasterMute(t,n){if(!["PA","IEM","mic"].includes(t))return!1;if(this.mixerState[t].muted=n,t==="PA"&&this.outputNodes.PA.masterGain){const r=n?0:this.dbToLinear(this.mixerState.PA.gain);this.outputNodes.PA.masterGain.gain.setValueAtTime(r,this.audioContexts.PA.currentTime)}else if(t==="IEM"&&this.outputNodes.IEM.masterGain){const r=n?0:this.dbToLinear(this.mixerState.IEM.gain);this.outputNodes.IEM.masterGain.gain.setValueAtTime(r,this.audioContexts.IEM.currentTime)}return!0}getCurrentPosition(){if(this.isPlaying&&this.audioContexts.PA&&this.startTime>0){const t=this.audioContexts.PA.currentTime-this.startTime,n=this.currentPosition+t,r=this.getDuration();return r>0?Math.min(n,r):n}return this.currentPosition}getCurrentTime(){return this.getCurrentPosition()}getDuration(){var t,n;return((n=(t=this.songData)==null?void 0:t.metadata)==null?void 0:n.duration)||0}getMixerState(){return{PA:this.mixerState.PA,IEM:this.mixerState.IEM,mic:this.mixerState.mic,stems:this.mixerState.stems,isPlaying:this.isPlaying,position:this.getCurrentPosition(),duration:this.getDuration()}}async loadAutoTuneWorklet(){try{if(!this.audioContexts.PA)return;await this.audioContexts.PA.audioWorklet.addModule("js/autoTuneWorklet.js"),this.autoTuneWorkletLoaded=!0}catch(t){console.error("Failed to load auto-tune worklet:",t),this.autoTuneWorkletLoaded=!1}}async startMicrophoneInput(t="default"){try{if(!this.mixerState.enableMic)return;this.stopMicrophoneInput();const n={audio:{deviceId:t!=="default"?{exact:t}:void 0,channelCount:1,sampleRate:44100,echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1}};this.microphoneStream=await navigator.mediaDevices.getUserMedia(n),this.microphoneSource=this.audioContexts.PA.createMediaStreamSource(this.microphoneStream),this.microphoneGain=this.audioContexts.PA.createGain(),this.microphoneGain.gain.value=1,this.microphoneSource.connect(this.microphoneGain),this.mixerState.micToSpeakers&&(this.autoTuneWorkletLoaded&&this.mixerState.autotuneSettings.enabled?await this.enableAutoTune():this.microphoneGain.connect(this.outputNodes.PA.masterGain))}catch(n){console.error("Failed to start microphone input:",n),this.stopMicrophoneInput()}}async enableAutoTune(){try{if(!this.autoTuneWorkletLoaded||!this.microphoneGain)return;this.autoTuneNode||(this.autoTuneNode=new AudioWorkletNode(this.audioContexts.PA,"auto-tune-processor")),this.microphoneGain.disconnect(),this.microphoneGain.connect(this.autoTuneNode),this.autoTuneNode.connect(this.outputNodes.PA.masterGain),this.autoTuneNode.port.postMessage({type:"setEnabled",value:this.mixerState.autotuneSettings.enabled}),this.autoTuneNode.port.postMessage({type:"setStrength",value:this.mixerState.autotuneSettings.strength}),this.autoTuneNode.port.postMessage({type:"setSpeed",value:this.mixerState.autotuneSettings.speed})}catch(t){console.error("Failed to enable auto-tune:",t)}}async disableAutoTune(){try{if(!this.microphoneGain)return;this.microphoneGain.disconnect(),this.autoTuneNode&&(this.autoTuneNode.disconnect(),this.autoTuneNode.port.postMessage({type:"setEnabled",value:!1})),this.mixerState.micToSpeakers&&this.microphoneGain.connect(this.outputNodes.PA.masterGain)}catch(t){console.error("Failed to disable auto-tune:",t)}}async setAutoTuneSettings(t){this.mixerState.autotuneSettings={...this.mixerState.autotuneSettings,...t},t.hasOwnProperty("enabled")&&(t.enabled?await this.enableAutoTune():await this.disableAutoTune()),this.autoTuneNode?(t.hasOwnProperty("strength")&&this.autoTuneNode.port.postMessage({type:"setStrength",value:t.strength}),t.hasOwnProperty("speed")&&this.autoTuneNode.port.postMessage({type:"setSpeed",value:t.speed})):t.enabled&&this.microphoneGain&&await this.enableAutoTune()}stopMicrophoneInput(){this.microphoneSource&&(this.microphoneSource.disconnect(),this.microphoneSource=null),this.microphoneGain&&(this.microphoneGain.disconnect(),this.microphoneGain=null),this.autoTuneNode&&(this.autoTuneNode.disconnect(),this.autoTuneNode=null),this.microphoneStream&&(this.microphoneStream.getTracks().forEach(t=>t.stop()),this.microphoneStream=null)}setMicrophoneGain(t){this.microphoneGain&&(this.microphoneGain.gain.value=t)}setIEMMonoVocals(t){return this.mixerState.iemMonoVocals=t,this.isPlaying?(this.stopAllSources(),this.createAudioGraph(),this.startAudioSources()):this.createAudioGraph(),!0}async loadMicSettings(){try{if(window.kaiAPI.settings){const t=await window.kaiAPI.settings.get("micToSpeakers",!0),n=await window.kaiAPI.settings.get("enableMic",!0),r=await window.kaiAPI.settings.get("iemMonoVocals",!0);this.mixerState.micToSpeakers=t,this.mixerState.enableMic=n,this.mixerState.iemMonoVocals=r}}catch(t){console.error("Failed to load mic settings:",t)}}setMicToSpeakers(t){this.mixerState.micToSpeakers=t,this.microphoneGain&&(this.microphoneGain.disconnect(),t&&(this.autoTuneWorkletLoaded&&this.mixerState.autotuneSettings.enabled?this.enableAutoTune():this.microphoneGain.connect(this.outputNodes.PA.masterGain)))}setEnableMic(t){this.mixerState.enableMic=t,t?this.startMicrophoneInput(this.inputDevice):this.stopMicrophoneInput()}stop(){this.isPlaying=!1,this.stopAllSources(),this.stopMicrophoneInput(),this.stopSongEndMonitoring(),this.audioContexts.PA&&(this.audioContexts.PA.close(),this.audioContexts.PA=null),this.audioContexts.IEM&&(this.audioContexts.IEM.close(),this.audioContexts.IEM=null),this.audioBuffers.clear(),this.outputNodes.PA.gainNodes.clear(),this.outputNodes.IEM.gainNodes.clear()}async reinitialize(){this.stop(),await new Promise(t=>setTimeout(t,200)),await this.initialize()}setOnSongEndedCallback(t){this.onSongEndedCallback=t}checkForSongEnd(){const t=this.getDuration(),n=this.getCurrentPosition(),r=this.monitoringStartTime?this.audioContexts.PA.currentTime-this.monitoringStartTime:0;this.isPlaying&&r>2&&t>3&&n>=t-.2&&(this.stopAllSources(),this.stopSongEndMonitoring(),this._triggerSongEnd())}startSongEndMonitoring(){this.songEndMonitor&&clearInterval(this.songEndMonitor),this.monitoringStartTime=this.audioContexts.PA.currentTime,this.songEndMonitor=setInterval(()=>{this.checkForSongEnd()},250)}stopSongEndMonitoring(){this.songEndMonitor&&(clearInterval(this.songEndMonitor),this.songEndMonitor=null)}dbToLinear(t){return Math.pow(10,t/20)}linearToDb(t){return 20*Math.log10(t)}getFormat(){return"kai"}}class Mp{constructor(t){this.canvas=document.getElementById(t),this.canvas&&(this.ctx=this.canvas.getContext("2d"),this.lyrics=null,this.songDuration=0,this.currentTime=0,this.animationFrame=null,this.isPlaying=!1,this.backupAnimations=new Map,this.lyricTransitions=new Map,this.cachedCurrentLine=-1,this.lastTimeForLineCalculation=-1,this.lineCalculationTolerance=.1,this.lockedUpcomingIndex=null,this.lastActiveLyricsBottom=null,this.frameCount=0,this.maxFPS=30,this.frameSkip=2,this.micStream=null,this.audioContext=null,this.analyser=null,this.micDataArray=null,this.waveformData=new Uint8Array(1440).fill(128),this.micGainNode=null,this.inputDevice="default",this.waveformPreferences={enableWaveforms:!0,micToSpeakers:!0,enableMic:!0,enableEffects:!0,overlayOpacity:.7,showUpcomingLyrics:!0},this.fpsHistory=[],this.lastFrameTime=performance.now(),this.frameUpdateTime=0,this.effectsCanvas=null,this.effectsGL=null,this.musicAnalyser=null,this.musicFrequencyData=null,this.butterchurn=null,this.currentPreset=null,this.presetList=[],this.effectType="butterchurn",this.butterchurnSourceNode=null,this.butterchurnAudioBuffer=null,this.originalAudioArrayBuffer=null,this.musicWorkletNode=null,this.cachedAnalysis={energy:0,bass:0,mid:0,treble:0,centroid:0},this.workletAvailable=!1,this.musicAudioBuffer=null,this.musicSourceNode=null,this.vocalsWaveformData=new Uint8Array(1920).fill(128),this.zeroPadding=new Uint8Array(1920).fill(128),this.waveformDataIndex=0,this.vocalsAudioBuffer=null,this.vocalsWaveformMaxLength=480,this.vocalsAnalyser=null,this.vocalsSource=null,this.preCalculatedVocalsWaveform=null,this.lastAudioDebugTime=0,this.audioDebugInterval=1e3,this.lastConditionsDebugTime=0,this.settings={fontSize:80,fontFamily:"bold Arial, sans-serif",lineHeight:140,textColor:"#ffffff",activeColor:"#00BFFF",upcomingColor:"#888888",backupColor:"#DAA520",lyricTransitionDuration:.4,lyricTransitionStartBefore:.4,backupActiveColor:"#FFD700",backgroundColor:"#1a1a1a",shadowColor:"#000000",linesVisible:1,maxWidth:.9,progressBarHeight:30,progressBarColor:"#007acc",progressBarBg:"#333333",progressBarMargin:100,backupFadeDuration:.8,backupMaxAlpha:.6,backupMinAlpha:0,backupAnimationEasing:"ease-out",waveformHeight:80,waveformColor:"#00ff00",waveformBackgroundColor:"#333333",waveformCurrentPosition:.75,vocalsWaveformHeight:60,vocalsWaveformColor:"#00bfff",vocalsWaveformGap:10},this.setupCanvas(),this.setupAdvancedVisualizations(),this.setupResponsiveCanvas(),this.startAnimation())}async setupAdvancedVisualizations(){this.effectsCanvas=document.createElement("canvas"),this.effectsCanvas.width=1920,this.effectsCanvas.height=1080;try{if(typeof window<"u"&&window.butterchurn&&window.butterchurnPresets){if(this.effectsGL=this.effectsCanvas.getContext("webgl2")||this.effectsCanvas.getContext("webgl"),this.effectsGL){let t=null;if(typeof window.butterchurn.createVisualizer=="function"?t=window.butterchurn:window.butterchurn.default&&typeof window.butterchurn.default.createVisualizer=="function"?t=window.butterchurn.default:typeof window.butterchurn=="function"&&(t=window.butterchurn),!t||typeof t.createVisualizer!="function")throw console.error("Butterchurn createVisualizer not found. Available methods:",t?Object.keys(t):"none"),new Error("Butterchurn API not compatible");this.butterchurnAudioContext=new(window.AudioContext||window.webkitAudioContext),this.butterchurn=t.createVisualizer(this.butterchurnAudioContext,this.effectsCanvas,{width:1920,height:1080,mesh_width:128,mesh_height:72,fps:30}),this.butterchurnAnalyser=this.butterchurnAudioContext.createAnalyser(),this.butterchurnAnalyser.fftSize=256,this.butterchurnFrequencyData=new Uint8Array(this.butterchurnAnalyser.frequencyBinCount),this.tryDecodeStoredAudioForButterchurn(),this.presetList=Object.keys(window.butterchurnPresets.getPresets());const n=["Rovastar - Fractopia","Rovastar - Altars Of Madness (Krash Mix)","Rovastar - Tunnel Runner","martin - disco ball","Krash - The Neverending Explosion","flexi - mindblob mix","Rovastar - Crystal High","martin - being & time"];if(this.currentPreset){if(this.presetList.includes(this.currentPreset)){const r=window.butterchurnPresets.getPresets()[this.currentPreset];this.butterchurn.loadPreset(r,0)}}else{const r=n.find(s=>this.presetList.includes(s))||this.presetList[0];if(r){const s=window.butterchurnPresets.getPresets()[r];this.butterchurn.loadPreset(s,0),this.currentPreset=r}}this.effectType="butterchurn",this.musicAudioBuffer&&!this.butterchurnAudioBuffer&&(this.needsButterchurnAudioDecode=!0)}}else throw console.warn("Butterchurn libraries not available, effects disabled"),new Error("Butterchurn not available")}catch(t){console.error("Butterchurn failed to load, effects disabled:",t),this.effectType="disabled"}this.effectsGL||console.warn("WebGL not available, effects disabled")}setupCanvas(){this.canvas.width=1920,this.canvas.height=1080,this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="left",this.ctx.textBaseline="middle"}setupResponsiveCanvas(){const t=()=>{const n=this.canvas.parentElement;if(!n)return;const r=n.getBoundingClientRect(),s=r.width,i=r.height;if(s===0||i===0){setTimeout(()=>t(),100);return}const a=16/9;let l,c;s/i>a?(c=i,l=c*a):(l=s,c=l/a),this.canvas.style.width=l+"px",this.canvas.style.height=c+"px"};t(),setTimeout(()=>t(),100),requestAnimationFrame(()=>t()),Kh(t),this.resizeHandler=t}loadLyrics(t,n=0){this.originalLyricsData=t||[],this.lyrics=this.parseLyricsData(t),this.songDuration=n}parseLyricsData(t){return!t||!Array.isArray(t)?[]:t.filter(r=>r.disabled!==!0).map((r,s)=>{if(typeof r=="object"&&r!==null){const i=this.parseWordsFromLine(r),a=r.text||r.lyrics||r.content||r.lyric||"";return{id:s,startTime:r.start||r.time||r.start_time||s*3,endTime:r.end||r.end_time||(r.start||r.time||s*3)+3,text:a,words:i,isBackup:r.backup===!0}}else{const i=r||"",a=this.estimateWordTiming(i,s*3);return{id:s,startTime:s*3,endTime:s*3+3,text:i,words:a,isBackup:!1}}}).filter(r=>r.text.trim().length>0)}parseWordsFromLine(t){if(t.words&&Array.isArray(t.words))return t.words.map(a=>({text:a.t||a.text||"",startTime:a.s||a.start||a.startTime||0,endTime:a.e||a.end||a.endTime||0}));const n=t.text||t.lyrics||t.content||t.lyric||"",r=t.start||t.time||t.start_time||0,i=(t.end||t.end_time||r+3)-r;return this.estimateWordTiming(n,r,i)}estimateWordTiming(t,n,r=3){const s=t.split(/\s+/).filter(a=>a.length>0);if(s.length===0)return[];const i=r/s.length;return s.map((a,l)=>({text:a,startTime:n+l*i,endTime:n+(l+1)*i}))}setCurrentTime(t){const n=this.currentTime;this.currentTime=t,this.isPlaying&&Math.abs(t-n)>1&&this.startMusicAnalysis()}async setMusicAudio(t){try{this.waveformAudioContext||(this.waveformAudioContext=new(window.AudioContext||window.webkitAudioContext)),this.butterchurnAudioContext||(this.butterchurnAudioContext=new(window.AudioContext||window.webkitAudioContext)),this.butterchurnAudioBuffer=null,this.originalAudioArrayBuffer=null;let n;if(t instanceof ArrayBuffer)n=t;else if(t&&t.buffer instanceof ArrayBuffer)n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);else if(t instanceof Uint8Array)n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);else return;this.originalAudioArrayBuffer=n.slice(0);const r=await this.waveformAudioContext.decodeAudioData(n.slice(0));this.butterchurn&&this.butterchurnAudioContext&&(this.butterchurnAudioBuffer=await this.butterchurnAudioContext.decodeAudioData(n.slice(0))),this.butterchurnAudioContext&&!this.butterchurnAnalyser&&(this.butterchurnAnalyser=this.butterchurnAudioContext.createAnalyser(),this.butterchurnAnalyser.fftSize=256,this.butterchurnFrequencyData=new Uint8Array(this.butterchurnAnalyser.frequencyBinCount)),this.setupMusicAnalysis(r,n)}catch(n){console.warn("Failed to load music audio for analysis:",n)}}async reinitializeButterchurn(){try{this.butterchurn&&this.butterchurn.destroy&&this.butterchurn.destroy(),this.butterchurn=null;let t=null;if(typeof window.butterchurn.createVisualizer=="function"?t=window.butterchurn:window.butterchurn.default&&typeof window.butterchurn.default.createVisualizer=="function"?t=window.butterchurn.default:typeof window.butterchurn=="function"&&(t=window.butterchurn),!t||typeof t.createVisualizer!="function"){console.error("Butterchurn createVisualizer not found during reinit");return}if(this.butterchurn=t.createVisualizer(this.butterchurnAudioContext,this.effectsCanvas,{width:1920,height:1080,mesh_width:128,mesh_height:72,fps:30}),window.butterchurnPresets&&window.butterchurnPresets.getPresets)if(this.presetList=Object.keys(window.butterchurnPresets.getPresets()),this.currentPreset&&this.presetList.includes(this.currentPreset)){const n=window.butterchurnPresets.getPresets()[this.currentPreset];this.butterchurn.loadPreset(n,0)}else{const n=["Geiss - Pulse Vertex v1.02","Rovastar & Geiss - Dynamic Noise v2.0","martin - volume bar spectrogram v1.0"];for(const r of n)if(this.presetList.includes(r)){this.butterchurn.loadPreset(window.butterchurnPresets.getPresets()[r],0),this.currentPreset=r;break}}}catch(t){console.error("Failed to reinitialize Butterchurn:",t)}}async setVocalsAudio(t){try{this.waveformAudioContext||(this.waveformAudioContext=new(window.AudioContext||window.webkitAudioContext));let n;if(t instanceof ArrayBuffer)n=t;else if(t&&t.buffer instanceof ArrayBuffer)n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);else if(t instanceof Uint8Array)n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);else return;this.vocalsAudioBuffer=await this.waveformAudioContext.decodeAudioData(n),this.preCalculateVocalsWaveform()}catch{}}async setupMusicAnalysis(t,n){if(this.effectsGL)try{const r=this.butterchurnAudioContext||this.waveformAudioContext;if(this.musicAudioBuffer=t,this.butterchurnAudioContext&&!this.butterchurnAudioBuffer&&n)try{this.butterchurnAudioBuffer=await this.butterchurnAudioContext.decodeAudioData(n.slice(0))}catch(s){console.warn("Failed to decode audio for Butterchurn context:",s)}try{await r.audioWorklet.addModule("./js/musicAnalysisWorklet.js"),this.workletAvailable=!0}catch{console.warn("AudioWorklet not available, falling back to AnalyserNode"),this.workletAvailable=!1}this.workletAvailable?(this.musicWorkletNode=new AudioWorkletNode(r,"music-analysis-processor"),this.musicWorkletNode.port.onmessage=s=>{s.data.type==="analysis"&&(this.cachedAnalysis=s.data.data)}):(this.musicAnalyser=r.createAnalyser(),this.musicAnalyser.fftSize=512,this.musicAnalyser.smoothingTimeConstant=.8,this.musicFrequencyData=new Uint8Array(this.musicAnalyser.frequencyBinCount))}catch(r){console.warn("Failed to setup music analysis:",r)}}async tryDecodeStoredAudioForButterchurn(){if(this.butterchurn&&this.butterchurnAudioContext&&this.originalAudioArrayBuffer&&!this.butterchurnAudioBuffer)try{if(this.butterchurnAudioBuffer=await this.butterchurnAudioContext.decodeAudioData(this.originalAudioArrayBuffer.slice(0)),!this.musicAudioBuffer&&this.waveformAudioContext)try{this.musicAudioBuffer=await this.waveformAudioContext.decodeAudioData(this.originalAudioArrayBuffer.slice(0))}catch(t){console.warn("Failed to decode audio for waveform:",t)}}catch(t){console.warn("Failed to decode stored audio for Butterchurn context:",t)}}analyzeMusicFrequencies(){if(this.workletAvailable&&this.musicWorkletNode)return this.cachedAnalysis;if(!this.musicAnalyser||!this.musicFrequencyData)return{energy:0,bass:0,mid:0,treble:0,centroid:0};this.musicAnalyser.getByteFrequencyData(this.musicFrequencyData);const t=this.musicFrequencyData.length,n=Math.floor(t*.1),r=Math.floor(t*.4);let s=0,i=0,a=0,l=0,c=0;for(let m=0;m<t;m++){const v=this.musicFrequencyData[m]/255;l+=v,c+=v*m,m<n?s+=v:m<r?i+=v:a+=v}const u=n>0?s/n:0,h=r-n>0?i/(r-n):0,d=t-r>0?a/(t-r):0,g=t>0?l/t:0,S=l>0?c/l/t:0;return{energy:Math.min(g*20,1),bass:Math.min(u*30,1),mid:Math.min(h*25,1),treble:Math.min(d*20,1),centroid:S}}renderWebGLEffects(){if(!this.effectsGL||!this.waveformPreferences.enableEffects)return;this.effectsGL;const t=this.analyzeMusicFrequencies();if(this.effectType==="butterchurn"&&this.butterchurn)try{const n={timeArray:new Uint8Array(1024),freqArray:new Uint8Array(1024)},r=Math.floor(t.bass*255),s=Math.floor(t.mid*255),i=Math.floor(t.treble*255);for(let a=0;a<1024;a++)a<341?n.freqArray[a]=r:a<682?n.freqArray[a]=s:n.freqArray[a]=i;if(this.butterchurn.render(),this.debugAudioLevels(),this.isPlaying&&this.butterchurnAnalyser&&!this.butterchurnSourceNode&&this.butterchurnAudioBuffer)this.startMusicAnalysis();else if(this.isPlaying&&!this.butterchurnSourceNode&&this.musicAudioBuffer&&!this.butterchurnAudioBuffer)try{}catch(a){console.warn("Failed to decode audio for Butterchurn:",a)}else if(this.isPlaying&&!this.butterchurnSourceNode){const a=performance.now();a-this.lastConditionsDebugTime>2e3&&(this.lastConditionsDebugTime=a)}}catch(n){console.error("Butterchurn render failed:",n)}}switchToNextPreset(){if(this.effectType==="butterchurn"&&this.butterchurn&&this.presetList.length){let n=(this.presetList.indexOf(this.currentPreset)+1)%this.presetList.length;const r=this.presetList.length;let s=0;for(;s<r&&this.isEffectDisabled(this.presetList[n]);)n=(n+1)%this.presetList.length,s++;this.isEffectDisabled(this.presetList[n])||this.switchToPreset(this.presetList[n])}}switchToPreviousPreset(){if(this.effectType==="butterchurn"&&this.butterchurn&&this.presetList.length){const t=this.presetList.indexOf(this.currentPreset);let n=t<=0?this.presetList.length-1:t-1;const r=this.presetList.length;let s=0;for(;s<r&&this.isEffectDisabled(this.presetList[n]);)n=n<=0?this.presetList.length-1:n-1,s++;this.isEffectDisabled(this.presetList[n])||this.switchToPreset(this.presetList[n])}}switchToPreset(t,n=2){if(this.effectType!=="butterchurn"||!this.butterchurn||!this.presetList.includes(t)){console.warn("Cannot switch to preset:",t);return}try{const r=window.butterchurnPresets.getPresets()[t];this.butterchurn.loadPreset(r,n),this.currentPreset=t}catch(r){console.error("Failed to switch preset:",r)}}isEffectDisabled(t){var n,r;return(r=(n=Zn())==null?void 0:n.effectsManager)!=null&&r.disabledEffects?Zn().effectsManager.disabledEffects.has(t):!1}setButterchurnPreset(t,n=1){if(this.effectType!=="butterchurn"||!this.butterchurn)return console.warn("Cannot set butterchurn preset - butterchurn not active"),!1;try{if(this.butterchurn.loadPreset(t,n),window.butterchurnPresets){const r=window.butterchurnPresets.getPresets();for(const[s,i]of Object.entries(r))if(i===t){this.currentPreset=s;break}}return!0}catch(r){return console.error("Failed to set butterchurn preset:",r),!1}}getAvailablePresets(){return this.presetList}getCurrentPreset(){return this.currentPreset}switchEffectType(t){t==="butterchurn"&&(this.effectType=t)}setPlaying(t){this.isPlaying=t,t?(this.startMicrophoneCapture(),this.startMusicAnalysis()):(this.stopMicrophoneCapture(),this.stopMusicAnalysis())}startMusicAnalysis(){if(this.musicAudioBuffer&&!(!this.effectsGL&&!this.butterchurn))try{if(this.stopMusicAnalysis(),this.butterchurn&&this.butterchurnAudioBuffer&&this.butterchurnAudioContext)try{this.butterchurnSourceNode&&(this.butterchurnSourceNode.disconnect(),this.butterchurnSourceNode=null),this.butterchurnSourceNode=this.butterchurnAudioContext.createBufferSource(),this.butterchurnSourceNode.buffer=this.butterchurnAudioBuffer,this.butterchurnAnalyser&&this.butterchurnSourceNode.connect(this.butterchurnAnalyser),this.butterchurn&&this.butterchurn.connectAudio&&(this.butterchurnVisualAnalyser=this.butterchurnAudioContext.createAnalyser(),this.butterchurnVisualAnalyser.fftSize=2048,this.butterchurnVisualAnalyser.smoothingTimeConstant=.8,this.butterchurnSourceNode.connect(this.butterchurnVisualAnalyser),this.butterchurn.connectAudio(this.butterchurnVisualAnalyser));const t=Math.max(0,this.currentTime);this.butterchurnSourceNode.start(0,t)}catch(t){console.warn("Failed to start Butterchurn offline analysis:",t)}}catch(t){console.error("Failed to start music analysis:",t)}}stopMusicAnalysis(){if(this.butterchurnSourceNode){try{this.butterchurnSourceNode.stop(),this.butterchurnSourceNode.disconnect()}catch{}this.butterchurnSourceNode=null}this.butterchurnVisualAnalyser&&(this.butterchurnVisualAnalyser=null),this.cachedAnalysis={energy:0,bass:0,mid:0,treble:0,centroid:0}}debugAudioLevels(){const t=performance.now();if(!(t-this.lastAudioDebugTime<this.audioDebugInterval)&&(this.lastAudioDebugTime=t,this.butterchurnAnalyser&&this.butterchurnFrequencyData)){this.butterchurnAnalyser.getByteFrequencyData(this.butterchurnFrequencyData);const r=this.butterchurnFrequencyData.reduce((a,l)=>a+l,0)/this.butterchurnFrequencyData.length,s=Math.max(...this.butterchurnFrequencyData),i=document.getElementById("statusText");i&&(i.textContent=`Audio: Avg=${r.toFixed(0)} Max=${s} State=${this.butterchurnAudioContext?this.butterchurnAudioContext.state:"none"}`)}}async startMicrophoneCapture(){if(this.waveformPreferences.enableMic)try{const t={audio:this.inputDevice?{deviceId:{exact:this.inputDevice}}:!0};this.micStream=await navigator.mediaDevices.getUserMedia(t),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser();const n=this.audioContext.createMediaStreamSource(this.micStream);n.connect(this.analyser),this.micGainNode=this.audioContext.createGain(),this.micGainNode.gain.setValueAtTime(.5,this.audioContext.currentTime),n.connect(this.micGainNode),this.analyser.fftSize=256,this.micDataArray=new Uint8Array(this.analyser.frequencyBinCount),await new Promise(r=>setTimeout(r,150))}catch{}}stopMicrophoneCapture(){this.micStream&&(this.micStream.getTracks().forEach(t=>t.stop()),this.micStream=null),this.micGainNode&&(this.micGainNode.disconnect(),this.micGainNode=null),this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.analyser=null,this.micDataArray=null,this.waveformData.fill(128)}preCalculateVocalsWaveform(){if(!this.vocalsAudioBuffer)return;const t=this.vocalsAudioBuffer.getChannelData(0),n=this.vocalsAudioBuffer.sampleRate,r=this.vocalsAudioBuffer.duration,s=n/240,i=Math.floor(r*240);this.preCalculatedVocalsWaveform=new Uint8Array(i);for(let a=0;a<r*240;a++){const l=Math.floor(a*s),c=Math.min(Math.floor((a+1)*s),t.length);let u=0,h=0;for(let S=l;S<c;S++)u=Math.max(u,t[S]),h=Math.min(h,t[S]);const d=Math.max(Math.abs(u),Math.abs(h)),g=Math.abs(u)>Math.abs(h)?128+Math.floor(d*127):128-Math.floor(d*127);this.preCalculatedVocalsWaveform[a]=Math.max(0,Math.min(255,g))}}updateWaveformData(){if(!this.analyser||!this.micDataArray)return;this.analyser.getByteTimeDomainData(this.micDataArray),this.lastMicTime||(this.lastMicTime=this.currentTime);const t=this.currentTime-this.lastMicTime,n=Math.floor(t*240);if(n>0){for(let s=0;s<1440-n;s++)this.waveformData[s]=this.waveformData[s+n];const r=Math.floor(this.micDataArray.length/n);for(let s=0;s<n;s++){const i=Math.min(s*r,this.micDataArray.length-1);this.waveformData[1440-n+s]=this.micDataArray[i]}this.lastMicTime=this.currentTime}}updateVocalsWaveformData(){if(this.preCalculatedVocalsWaveform){const t=Math.floor((this.currentTime-6)*240),n=t+1920;if(t>=0&&n<=this.preCalculatedVocalsWaveform.length)for(let r=0;r<1920;r++)this.vocalsWaveformData[r]=this.preCalculatedVocalsWaveform[t+r];else{const r=Math.max(0,t),s=Math.min(this.preCalculatedVocalsWaveform.length,n),i=r-t,a=n-s;let l=0;for(let c=0;c<i;c++)this.vocalsWaveformData[l++]=128;for(let c=r;c<s;c++)this.vocalsWaveformData[l++]=this.preCalculatedVocalsWaveform[c];for(let c=0;c<a;c++)this.vocalsWaveformData[l++]=128}}}updateWaveformDataAtFixedRate(){const t=Date.now();if(!this.lastMicUpdateTime){this.lastMicUpdateTime=t,this.micUpdateInterval=1e3/240;return}t-this.lastMicUpdateTime>=this.micUpdateInterval&&(this.updateWaveformData(),this.updateVocalsWaveformData(),this.lastMicUpdateTime=t)}drawVocalsWaveform(t,n){if(!this.isPlaying||!this.waveformPreferences.enableWaveforms)return;!this.waveformPreferences.enableMic&&this.waveformPreferences.enableWaveforms;const r=this.settings.vocalsWaveformHeight,s=this.settings.waveformHeight,i=this.settings.vocalsWaveformGap,a=n-s-i-r-20,l=t*this.settings.waveformCurrentPosition;this.ctx.strokeStyle=this.settings.vocalsWaveformColor,this.ctx.lineWidth=2,this.ctx.beginPath();const c=a+r/2;let u=!0;for(let h=0;h<t;h++){const d=(this.vocalsWaveformData[h]-128)/128,g=c+d*r*1.5;u?(this.ctx.moveTo(h,g),u=!1):this.ctx.lineTo(h,g)}this.ctx.stroke(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(l,a),this.ctx.lineTo(l,a+r),this.ctx.stroke(),this.ctx.strokeStyle="#666666",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,c),this.ctx.lineTo(t,c),this.ctx.stroke()}setWaveformsEnabled(t){this.waveformPreferences.enableWaveforms=t}setMicToSpeakers(t){this.waveformPreferences.micToSpeakers=t}setMicEnabled(t){this.waveformPreferences.enableMic=t,t&&this.isPlaying?this.startMicrophoneCapture():t||(this.stopMicrophoneCapture(),this.waveformData.fill(128))}setEffectsEnabled(t){this.waveformPreferences.enableEffects=t,!t&&this.effectsGL&&(this.effectsGL.clearColor(0,0,0,1),this.effectsGL.clear(this.effectsGL.COLOR_BUFFER_BIT))}drawMicrophoneWaveform(t,n){if(!this.isPlaying||!this.waveformPreferences.enableWaveforms||!this.waveformPreferences.enableMic||!this.micStream||!this.analyser)return;const r=this.settings.waveformHeight,s=n-r-20,i=t*this.settings.waveformCurrentPosition;this.ctx.strokeStyle=this.settings.waveformColor,this.ctx.lineWidth=2,this.ctx.beginPath();const a=s+r/2;let l=!0;for(let c=0;c<1440;c++){const u=(this.waveformData[c]-128)/128,h=a+u*r*1.5;l?(this.ctx.moveTo(c,h),l=!1):this.ctx.lineTo(c,h)}this.ctx.stroke(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(i,s+r),this.ctx.stroke(),this.ctx.strokeStyle="#666666",this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,a),this.ctx.lineTo(t,a),this.ctx.stroke()}startAnimation(){const t=n=>{const r=n-this.lastFrameTime;this.lastFrameTime=n,this.fpsHistory.push(1e3/r),this.fpsHistory.length>60&&this.fpsHistory.shift();const s=performance.now();this.draw(),this.frameUpdateTime=performance.now()-s,this.animationFrame=requestAnimationFrame(t)};this.animationFrame=requestAnimationFrame(t)}draw(){const t=this.canvas.width,n=this.canvas.height;this.frameCount++;const r=this.frameCount%120===0;if(r&&performance.now(),this.updateWaveformDataAtFixedRate(),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,t,n),r&&performance.now(),this.renderWebGLEffects(),r&&performance.now(),this.effectsCanvas&&(this.ctx.save(),this.ctx.globalAlpha=1,this.ctx.drawImage(this.effectsCanvas,0,0),this.ctx.restore()),this.ctx.save(),this.ctx.globalAlpha=this.waveformPreferences.overlayOpacity,this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,t,n),this.ctx.restore(),r&&performance.now(),this.drawVocalsWaveform(t,n),r&&performance.now(),this.drawMicrophoneWaveform(t,n),r&&performance.now(),!this.isPlaying&&Zn()&&Zn().currentSong){this.drawSongInfo(t,n,Zn().currentSong);return}if(!this.lyrics||this.lyrics.length===0)return;if(this.isInInstrumentalIntro()){this.drawInstrumentalIntro(t,n);return}if(this.isInInstrumentalOutro()){this.drawInstrumentalOutro(t,n);return}const s=this.findCurrentLine();if(s>=0&&s<this.lyrics.length?this.isInInstrumentalGap(s)?this.drawInstrumentalProgressBar(s,t,n):this.drawActiveLines(t,n):this.drawBackupOnlyProgressBar(t,n),r){performance.now(),this.fpsHistory.length>0&&this.fpsHistory.reduce((a,l)=>a+l,0)/this.fpsHistory.length;const i=1e3/60;this.frameUpdateTime/i*100}}findCurrentLine(){return Math.abs(this.currentTime-this.lastTimeForLineCalculation)<this.lineCalculationTolerance?this.cachedCurrentLine:(this.cachedCurrentLine=this.findCurrentMainLine(),this.lastTimeForLineCalculation=this.currentTime,this.cachedCurrentLine)}findCurrentMainLine(){if(!this.lyrics)return-1;for(let t=0;t<this.lyrics.length;t++){const n=this.lyrics[t];if(!n.isBackup&&this.currentTime>=n.startTime&&this.currentTime<=n.endTime)return t}for(let t=0;t<this.lyrics.length;t++)if(!this.lyrics[t].isBackup&&this.currentTime<this.lyrics[t].startTime){for(let n=t-1;n>=0;n--)if(!this.lyrics[n].isBackup)return n;return-1}for(let t=this.lyrics.length-1;t>=0;t--)if(!this.lyrics[t].isBackup)return t;return-1}drawCurrentLyricLine(t,n,r){if(t<0||t>=this.lyrics.length)return;const s=this.lyrics[t];this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center",this.ctx.fillStyle=this.settings.activeColor;let i="";if(s.text?i=s.text:s.words&&s.words.length>0&&(i=s.words.map(a=>a.text||a.word||a).join(" ")),i&&i.trim()!==""){const a=n*.9,l=i.split(" "),c=[];let u="";for(const S of l){const m=u?u+" "+S:S;this.ctx.measureText(m).width<=a?u=m:u?(c.push(u),u=S):c.push(S)}u&&c.push(u);const h=this.settings.lineHeight*.9,d=c.length*h;let g=r/2-d/2+h;c.forEach(S=>{this.drawTextWithBackground(S,n/2,g),g+=h})}}drawActiveLines(t,n,r=!1){if(!this.lyrics)return;this.updateBackupAnimations();const s=[],i=this.currentTime;for(let m=0;m<this.lyrics.length;m++){const v=this.lyrics[m];!v.isDisabled&&i>=v.startTime&&i<=v.endTime&&s.push({...v,index:m})}const a=s.filter(m=>!m.isBackup),l=s.filter(m=>m.isBackup),c=Math.max(1,a.length+l.length),u=this.settings.lineHeight*1.2,h=c*u;let d=n/2-h/2+u-180;a.forEach(m=>{d=this.drawSingleLine(m,t,d,!1)||d+u}),l.forEach(m=>{const v=this.backupAnimations.get(m.index),k=v?v.alpha:this.settings.backupMaxAlpha;d=this.drawSingleLine(m,t,d,!0,k)||d+u}),s.length>0&&(this.lastActiveLyricsBottom=d);const S=(this.lastActiveLyricsBottom||d)+10;this.startTransitionAnimations(s,S);for(const[m,v]of this.lyricTransitions.entries()){const k=this.lyrics[m];k&&this.drawTransitioningLine(k,t,v)}!r&&this.waveformPreferences.showUpcomingLyrics&&this.drawUpcomingLyrics(t,n,S)}drawSingleLine(t,n,r,s,i=1){s?this.ctx.font=`italic ${this.settings.fontSize}px ${this.settings.fontFamily}`:this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center",this.ctx.save(),s&&(this.ctx.globalAlpha=i),this.ctx.fillStyle=s?this.settings.backupActiveColor:this.settings.activeColor;let a="";if(t.text?a=t.text:t.words&&t.words.length>0&&(a=t.words.map(l=>l.text||l.word||l).join(" ")),a&&a.trim()!==""){const l=n*.9,c=a.split(" "),u=[];let h="";for(const g of c){const S=h?h+" "+g:g;this.ctx.measureText(S).width<=l?h=S:h?(u.push(h),h=g):u.push(g)}h&&u.push(h);let d=r;return u.forEach((g,S)=>{const m=r+S*this.settings.lineHeight*.8;if(d=m+this.settings.lineHeight*.8,s){const v=` ${g}`;this.drawTextWithBackground(v,n/2,m)}else this.drawTextWithBackground(g,n/2,m)}),this.ctx.restore(),d}return this.ctx.restore(),null}updateBackupAnimations(){if(!this.lyrics)return;const t=this.currentTime;for(let n=0;n<this.lyrics.length;n++){const r=this.lyrics[n];if(!r.isBackup||r.isDisabled){this.backupAnimations.delete(n);continue}const s=t>=r.startTime&&t<=r.endTime,i=this.backupAnimations.get(n)||{alpha:this.settings.backupMinAlpha,fadeDirection:0,lastStateChange:t};let a=s?this.settings.backupMaxAlpha:this.settings.backupMinAlpha,l=0;if(s&&i.alpha<this.settings.backupMaxAlpha?l=1:!s&&i.alpha>this.settings.backupMinAlpha&&(l=-1),l!==i.fadeDirection&&(i.fadeDirection=l,i.lastStateChange=t),i.fadeDirection!==0){const c=t-i.lastStateChange,u=Math.min(c/this.settings.backupFadeDuration,1),h=1-Math.pow(1-u,3);i.fadeDirection===1?i.alpha=this.settings.backupMinAlpha+(this.settings.backupMaxAlpha-this.settings.backupMinAlpha)*h:i.alpha=this.settings.backupMaxAlpha-(this.settings.backupMaxAlpha-this.settings.backupMinAlpha)*h,u>=1&&(i.fadeDirection=0,i.alpha=a)}this.backupAnimations.set(n,i)}for(const[n]of this.backupAnimations)n>=this.lyrics.length&&this.backupAnimations.delete(n)}wrapWordsToLines(t,n){const r=[];let s=[],i=0;return t.forEach((a,l)=>{const c=this.ctx.measureText(a.text).width,u=l>0?this.settings.wordSpacing:0,h=i+u+c;h<=n||s.length===0?(s.push(a),i=h):(s.length>0&&r.push(s),s=[a],i=c)}),s.length>0&&r.push(s),r}drawWordLine(t,n,r,s,i){const a=t.reduce((c,u,h)=>{const d=this.ctx.measureText(u.text).width,g=h<t.length-1?this.settings.wordSpacing:0;return c+d+g},0);let l=n-a/2;t.forEach((c,u)=>{const h=i&&this.currentTime>=c.startTime&&this.currentTime<=c.endTime;this.ctx.fillStyle=h?this.settings.activeColor:i?"#CCCCCC":this.settings.textColor,this.ctx.textAlign="left",this.drawTextWithBackground(c.text,l,r),h&&i&&this.drawBouncingBall(l,c,r);const d=this.ctx.measureText(c.text).width;l+=d+this.settings.wordSpacing})}isInInstrumentalIntro(){if(!this.lyrics||this.lyrics.length===0)return!1;const t=this.currentTime,n=this.lyrics[0];return n?n.startTime>5&&t<n.startTime:!1}isInInstrumentalOutro(){if(!this.lyrics||this.lyrics.length===0||!this.songDuration)return!1;const t=this.currentTime;let n=null;for(let s=this.lyrics.length-1;s>=0;s--){const i=this.lyrics[s];if(!i.isBackup&&!i.isDisabled){n=i;break}}if(!n)return!1;const r=this.songDuration-n.endTime;return t>n.endTime&&r>0}getLastMainSingerLine(){if(!this.lyrics)return null;for(let t=this.lyrics.length-1;t>=0;t--){const n=this.lyrics[t];if(!n.isBackup&&!n.isDisabled)return n}return null}isInInstrumentalGap(t){if(!this.lyrics||t<0)return!1;const n=this.currentTime,r=this.lyrics[t];let s=null;for(let c=t+1;c<this.lyrics.length;c++)if(!this.lyrics[c].isBackup&&!this.lyrics[c].isDisabled){s=this.lyrics[c];break}if(!r||!s)return!1;const i=r.endTime,a=s.startTime;return a-i<=5?!1:n>=i&&n<=a}isInMainSingerInstrumentalGap(){if(!this.lyrics)return{isInGap:!1};const t=this.currentTime;let n=null,r=-1;for(let l=0;l<this.lyrics.length;l++){const c=this.lyrics[l];!c.isBackup&&!c.isDisabled&&t>=c.endTime&&(n=c,r=l)}if(!n)return{isInGap:!1};let s=null;for(let l=r+1;l<this.lyrics.length;l++){const c=this.lyrics[l];if(!c.isBackup&&!c.isDisabled&&t<c.startTime){s=c;break}}if(!s)return{isInGap:!1};const i=s.startTime-n.endTime;if(i<=5)return{isInGap:!1};const a=t>=n.endTime&&t<=s.startTime;return{isInGap:a,lastMainLineIndex:r,nextMainLine:s,gapProgress:a?(t-n.endTime)/i:0}}drawInstrumentalProgressBar(t,n,r){if(!this.lyrics||t<0)return;const s=this.currentTime,i=this.lyrics[t];let a=null;for(let h=t+1;h<this.lyrics.length;h++)if(!this.lyrics[h].isBackup&&!this.lyrics[h].isDisabled){a=this.lyrics[h];break}if(!i||!a)return;const l=i.endTime,c=a.startTime,u=c-l;if(!(u<=5)&&s>=l&&s<=c){const h=(s-l)/u,d=n*.8,g=(n-d)/2,S=80;this.drawProgressBar(g,S,d,void 0,h,n),this.drawUpcomingLyricsPreview(a,n,r,h,S+this.settings.progressBarMargin),this.drawActiveLines(n,r,!0)}}drawInstrumentalIntro(t,n){if(!this.lyrics||this.lyrics.length===0)return;const r=this.currentTime,s=this.lyrics[0];if(!s)return;const i=s.startTime,a=r/i,l=t*.8,c=(t-l)/2,u=80;this.drawProgressBar(c,u,l,void 0,a,t),this.drawUpcomingLyricsPreview(s,t,n,a,u+this.settings.progressBarMargin)}drawInstrumentalOutro(t,n){const r=this.getLastMainSingerLine();if(!r)return;const s=this.currentTime,i=r.endTime,a=this.songDuration-i,l=Math.max(0,Math.min(1,(s-i)/a));this.drawProgressBar(void 0,void 0,void 0,void 0,l,t),this.ctx.fillStyle=this.settings.textColor,this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center";const c=t/2,u=n/2;this.drawTextWithBackground(" Instrumental Outro ",c,u)}drawBackupOnlyProgressBar(t,n){if(!this.lyrics)return;const r=this.currentTime;let s=null;for(let d=0;d<this.lyrics.length;d++)if(!this.lyrics[d].isBackup&&!this.lyrics[d].isDisabled&&r<this.lyrics[d].startTime){s=this.lyrics[d];break}if(!s)return;let i=0;for(let d=this.lyrics.length-1;d>=0;d--)if(!this.lyrics[d].isBackup&&!this.lyrics[d].isDisabled&&this.lyrics[d].endTime<=r){i=this.lyrics[d].endTime;break}const a=s.startTime-i;if(a<=5)return;const l=(r-i)/a,c=t*.8,u=(t-c)/2,h=80;this.drawProgressBar(u,h,c,void 0,l,t),this.drawUpcomingLyricsPreview(s,t,n,l,h+this.settings.progressBarMargin),this.drawActiveLines(t,n)}drawUpcomingLyricsPreview(t,n,r,s,i){if(!t)return;let a="";if(t.text?a=t.text:t.words&&t.words.length>0&&(a=t.words.map(m=>m.text||m.word||m).join(" ")),!a||a.trim()==="")return;this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center";const l=s>=1;this.ctx.fillStyle=l?this.settings.activeColor:this.settings.upcomingColor;const c=n*.9,u=a.split(" "),h=[];let d="";for(const m of u){const v=d?d+" "+m:m;this.ctx.measureText(v).width<=c?d=v:d?(h.push(d),d=m):h.push(m)}d&&h.push(d);const g=this.settings.lineHeight*.8;let S=i+60;h.forEach(m=>{this.drawTextWithBackground(m,n/2,S),S+=g})}wrapWordsToLinesPreview(t,n){const r=[];let s=[],i=0;return t.forEach((a,l)=>{const c=this.ctx.measureText(a).width,u=l>0?this.settings.wordSpacing:0,h=i+u+c;h<=n||s.length===0?(s.push(a),i=h):(s.length>0&&r.push(s),s=[a],i=c)}),s.length>0&&r.push(s),r}drawWordLinePreview(t,n,r,s,i,a){const l=t.reduce((u,h,d)=>{const g=this.ctx.measureText(h).width,S=d<t.length-1?this.settings.wordSpacing:0;return u+g+S},0);let c=n-l/2;t.forEach((u,h)=>{this.ctx.fillStyle=i,this.ctx.textAlign="left",a?(this.ctx.save(),this.ctx.shadowColor=this.settings.activeColor,this.ctx.shadowBlur=4,this.ctx.fillText(u,c,r),this.ctx.restore()):this.ctx.fillText(u,c,r);const d=this.ctx.measureText(u).width;c+=d+this.settings.wordSpacing})}drawTextWithBackground(t,n,r){const s=this.ctx.measureText(t),i=s.width,a=s.actualBoundingBoxAscent||this.settings.fontSize*.8,l=s.actualBoundingBoxDescent||this.settings.fontSize*.2,c=a+l,u=12,h=.1,d=(i+u*2)*(1+h),g=(c+u)*(1+h),S=n-d/2,m=r-a-(g-c)/2,v=12;this.ctx.save(),this.ctx.fillStyle="rgba(0, 0, 0, 0.65)",this.ctx.beginPath(),this.ctx.roundRect(S,m,d,g,v),this.ctx.fill(),this.ctx.restore(),this.ctx.fillText(t,n,r)}drawProgressBar(t,n,r,s,i,a){const l=t!==void 0?t:50,c=n!==void 0?n:50,u=r!==void 0?r:a-100,h=s!==void 0?s:this.settings.progressBarHeight;return this.ctx.fillStyle=this.settings.progressBarBg,this.ctx.fillRect(l,c,u,h),this.ctx.fillStyle=this.settings.progressBarColor,this.ctx.fillRect(l,c,u*Math.max(0,Math.min(1,i)),h),{barX:l,barY:c,barWidth:u,barHeight:h}}drawBouncingBall(t,n,r){const s=(this.currentTime-n.startTime)/(n.endTime-n.startTime),i=this.ctx.measureText(n.text).width,a=t+s*i,l=r-30+Math.sin(s*Math.PI*4)*5;this.ctx.save(),this.ctx.fillStyle=this.settings.ballColor,this.ctx.beginPath(),this.ctx.arc(a,l,this.settings.ballSize,0,Math.PI*2),this.ctx.fill(),this.ctx.restore()}drawSongInfo(t,n,r){var h,d,g;const s=this.ctx;s.save();const i=r.title||((h=r.metadata)==null?void 0:h.title)||((d=r.name)==null?void 0:d.replace(".kai",""))||"Unknown Title",a=r.artist||((g=r.metadata)==null?void 0:g.artist)||"Unknown Artist",l=r.requester,c=t/2,u=n/2;s.fillStyle="#ffffff",s.font="bold 72px Arial, sans-serif",s.textAlign="center",s.textBaseline="middle",s.shadowColor="rgba(0, 0, 0, 0.8)",s.shadowBlur=4,s.shadowOffsetX=2,s.shadowOffsetY=2,s.fillText(i,c,u-50),s.fillStyle="#cccccc",s.font="48px Arial, sans-serif",s.fillText(a,c,u+50),l&&(s.fillStyle="#aaaaaa",s.font="36px Arial, sans-serif",s.fillText(`Singer: ${l}`,c,u+120)),s.restore()}destroy(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.resizeHandler&&Hh("resize",this.resizeHandler),this.butterchurn&&this.butterchurn.destroy&&this.butterchurn.destroy(),this.butterchurn=null,this.butterchurnSourceNode&&(this.butterchurnSourceNode.disconnect(),this.butterchurnSourceNode=null),this.butterchurnAudioContext&&(this.butterchurnAudioContext.close(),this.butterchurnAudioContext=null),this.butterchurnAnalyser=null,this.butterchurnVisualAnalyser=null,this.butterchurnFrequencyData=null,this.butterchurnAudioBuffer=null,this.effectsCanvas=null,this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.stopMicrophoneCapture(),this.gl&&(this.gl=null)}reinitialize(){const t={...this.waveformPreferences};this.destroy(),this.lyrics=null,this.songDuration=0,this.currentTime=0,this.isPlaying=!1,this.cachedCurrentLine=-1,this.lastTimeForLineCalculation=-1,this.backupAnimations.clear(),this.waveformPreferences=t,this.setupCanvas(),this.setupAdvancedVisualizations(),this.setupResponsiveCanvas(),this.startAnimation(),this.waveformPreferences.enableMic&&setTimeout(async()=>{await this.ensureInputDeviceSelection(),this.startMicrophoneCapture()},200)}async ensureInputDeviceSelection(){try{if(window.kaiAPI.settings){const t=await window.kaiAPI.settings.get("devicePreferences");t&&t.input&&t.input.id&&(this.inputDevice=t.input.id)}}catch(t){console.warn("Failed to load input device preference:",t)}}setShowUpcomingLyrics(t){this.waveformPreferences.showUpcomingLyrics=t}drawUpcomingLyrics(t,n,r){if(!this.lyrics)return;const s=this.currentTime,i=5;if(this.lockedUpcomingIndex!==null&&this.lockedUpcomingIndex!==void 0){const u=this.lyrics[this.lockedUpcomingIndex];(!u||s>=u.startTime)&&(this.lockedUpcomingIndex=null)}if(this.lockedUpcomingIndex===null||this.lockedUpcomingIndex===void 0){let u=null,h=1/0;for(let d=0;d<this.lyrics.length;d++){const g=this.lyrics[d];!g.isDisabled&&!g.isBackup&&g.startTime>s&&g.startTime<=s+i&&g.startTime<h&&(u=d,h=g.startTime)}this.lockedUpcomingIndex=u}if(this.lockedUpcomingIndex===null||this.lockedUpcomingIndex===void 0)return;const a=this.lyrics[this.lockedUpcomingIndex];if(!a){this.lockedUpcomingIndex=null;return}if(s>=a.startTime){this.lockedUpcomingIndex=null;return}if(this.lyricTransitions.has(this.lockedUpcomingIndex))return;this.ctx.save(),this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center",this.ctx.fillStyle="#999999",this.ctx.globalAlpha=.8;let l=r,c="";a.text?c=a.text:a.words&&a.words.length>0&&(c=a.words.map(u=>u.text||u.word||u).join(" ")),c&&this.drawWrappedText(c,t/2,l,t*.9),this.ctx.restore()}drawWrappedText(t,n,r,s){const i=t.split(" ");let a="",l=0;const c=this.settings.fontSize*1.2;for(let u=0;u<i.length;u++){const h=a+(a?" ":"")+i[u];this.ctx.measureText(h).width>s&&a?(this.drawTextWithBackground(a,n,r),r+=c,l++,a=i[u]):a=h}return a&&(this.drawTextWithBackground(a,n,r),l++),l}updateLyricTransitions(t,n,r){const s=[];if(this.lyrics)for(let i=0;i<this.lyrics.length;i++){const a=this.lyrics[i];if(!a.isDisabled&&!a.isBackup&&a.startTime>n&&a.startTime<=n+5){s.push({...a,index:i});break}}for(const i of s){const a=i.startTime-n;if(a<=.5&&a>0&&!this.lyricTransitions.has(i.index)){let l;this.lastUpcomingDisplayY!==null&&this.lastUpcomingLineIndex===i.index?l=this.lastUpcomingDisplayY:l=r+50;const c=this.canvas.height/2-180;this.lyricTransitions.set(i.index,{startTime:n,duration:this.settings.lyricTransitionDuration,progress:0,startY:l,endY:c})}}for(const[i,a]of this.lyricTransitions.entries()){const l=n-a.startTime,c=this.lyrics[i];if(c&&n>=c.startTime&&n<=c.endTime)this.lyricTransitions.delete(i);else{const h=Math.min(1,l/a.duration);a.progress=h,a.progress>=1&&this.lyricTransitions.delete(i)}}}startTransitionAnimations(t,n){const r=this.currentTime;if(this.lockedUpcomingIndex!==null&&this.lockedUpcomingIndex!==void 0){const s=this.lyrics[this.lockedUpcomingIndex];if(s){const i=s.startTime-r;if(i<=this.settings.lyricTransitionStartBefore&&i>0&&!this.lyricTransitions.has(this.lockedUpcomingIndex)){const a=this.canvas.height,l=this.settings.lineHeight*1.2,c=t.filter(g=>!g.isBackup),h=Math.max(1,c.length)*l,d=a/2-h/2+l-180;this.lyricTransitions.set(this.lockedUpcomingIndex,{startTime:r,duration:this.settings.lyricTransitionDuration,progress:0,startY:n,endY:d})}}}for(const[s,i]of this.lyricTransitions.entries()){const a=r-i.startTime,l=this.lyrics[s];l&&r>=l.startTime&&r<=l.endTime?this.lyricTransitions.delete(s):(i.progress=Math.min(1,a/i.duration),i.progress>=1&&this.lyricTransitions.delete(s))}}drawTransitioningLine(t,n,r){const s=r.startY+(r.endY-r.startY)*r.progress,i={r:136,g:136,b:136},a={r:0,g:191,b:255},l=Math.round(i.r+(a.r-i.r)*r.progress),c=Math.round(i.g+(a.g-i.g)*r.progress),u=Math.round(i.b+(a.b-i.b)*r.progress),h=.8+(1-.8)*r.progress;this.ctx.save(),this.ctx.font=`${this.settings.fontSize}px ${this.settings.fontFamily}`,this.ctx.textAlign="center",this.ctx.fillStyle=`rgba(${l}, ${c}, ${u}, ${h})`;let d="";if(t.text?d=t.text:t.words&&t.words.length>0&&(d=t.words.map(g=>g.text||g.word||g).join(" ")),d){const g=n*.9,S=d.split(" "),m=[];let v="";for(const p of S){const f=v?v+" "+p:p;this.ctx.measureText(f).width<=g?v=f:v?(m.push(v),v=p):m.push(p)}v&&m.push(v);const k=this.settings.lineHeight*.8;m.forEach((p,f)=>{const y=s+f*k;this.drawTextWithBackground(p,n/2,y)})}this.ctx.restore()}}class Ip extends Js{constructor(t){if(super(),this.canvas=document.getElementById(t),!this.canvas){console.error("CDG canvas not found:",t);return}this.ctx=this.canvas.getContext("2d"),this.cdgPlayer=null,this.cdgData=null,this.currentTime=0,this.animationFrame=null,this.cdgCanvas=document.createElement("canvas"),this.cdgCanvas.width=300,this.cdgCanvas.height=216,this.cdgCtx=this.cdgCanvas.getContext("2d"),this.audioContext=null,this.audioSource=null,this.audioBuffer=null,this.startTime=0,this.pauseTime=0,this.gainNode=null,this.analyserNode=null,this.effectsCanvas=null,this.butterchurn=null,this.effectsEnabled=!0,this.overlayOpacity=.7}setOverlayOpacity(t){this.overlayOpacity=t}async loadSong(t){try{if(this.cdgData=t,this.resetPosition(),this.currentTime=0,this.startTime=0,this.pauseTime=0,typeof CDGraphics>"u")throw console.error(" CDGraphics library not loaded"),new Error("CDGraphics library not available");const n=t.cdg.data;let r;if(n instanceof Uint8Array||n instanceof Buffer)r=new ArrayBuffer(n.length||n.byteLength),new Uint8Array(r).set(n);else if(n.buffer instanceof ArrayBuffer)r=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);else if(n instanceof ArrayBuffer)r=n;else throw console.error(" Unknown buffer type:",n),new Error("Unknown buffer type");if(this.cdgPlayer=new CDGraphics(r),!this.audioContext)throw new Error("Audio context not set. Call setAudioContext() first.");const s=t.audio.mp3.buffer.slice(t.audio.mp3.byteOffset,t.audio.mp3.byteOffset+t.audio.mp3.byteLength);return this.audioBuffer=await this.audioContext.decodeAudioData(s),!0}catch(n){return console.error(" Failed to load CDG:",n),!1}}play(){if(!this.cdgPlayer||!this.audioBuffer){console.warn(" No CDG loaded");return}if(this.isPlaying=!0,this.audioSource){this.audioSource.onended=null;try{this.audioSource.stop()}catch{}this.audioSource=null}this.audioSource=this.audioContext.createBufferSource(),this.audioSource.buffer=this.audioBuffer,this.audioSource.connect(this.gainNode),this.analyserNode&&this.audioSource.connect(this.analyserNode);const t=this.audioBuffer.duration;this.audioSource.onended=()=>{const r=this.getCurrentTime();this.isPlaying&&r>=t-1&&this.handleSongEnd()};const n=this.pauseTime||0;this.audioSource.start(0,n),this.startTime=this.audioContext.currentTime-n,this.startRendering(),this.startStateReporting(),this.reportStateChange()}pause(){if(this.isPlaying=!1,this.pauseTime=this.getCurrentTime(),this.stopStateReporting(),this.reportStateChange(),this.audioSource){this.audioSource.onended=null;try{this.audioSource.stop()}catch{}this.audioSource=null}this.stopRendering()}seek(t){const n=this.isPlaying;n&&this.pause(),this.pauseTime=t,this.currentTime=t,n?this.play():this.renderFrame()}startRendering(){if(this.animationFrame)return;const t=()=>{this.isPlaying&&(this.renderFrame(),this.animationFrame=requestAnimationFrame(t))};t()}stopRendering(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}renderFrame(){if(!this.cdgPlayer)return;this.currentTime=this.getCurrentTime();const t=this.cdgPlayer.render(this.currentTime);if(!t||!t.imageData){console.warn(" No frame data at time:",this.currentTime);return}const n=t.imageData,r=n.data,s=r[0],i=r[1],a=r[2];this.cdgBackgroundColor={r:s,g:i,b:a};for(let S=0;S<r.length;S+=4){const m=r[S],v=r[S+1],k=r[S+2];m===s&&v===i&&k===a&&(r[S+3]=0)}if(this.cdgCtx.putImageData(n,0,0),this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.effectsEnabled&&this.effectsCanvas&&this.butterchurn)try{this.butterchurn.render(),this.ctx.drawImage(this.effectsCanvas,0,0,this.canvas.width,this.canvas.height)}catch{}const l=this.overlayOpacity||.7;this.ctx.save(),this.ctx.globalAlpha=l,this.ctx.fillStyle=`rgb(${s}, ${i}, ${a})`,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore();const c=5,u=300*c,h=216*c,d=(this.canvas.width-u)/2,g=0;this.ctx.imageSmoothingEnabled=!1,this.ctx.drawImage(this.cdgCanvas,d,g,u,h)}handleSongEnd(){this.stopRendering(),this._triggerSongEnd(),window.electronAPI&&window.electronAPI.queue&&window.electronAPI.queue.notifyComplete()}setEffectsCanvas(t,n){this.effectsCanvas=t,this.butterchurn=n}setEffectsEnabled(t){this.effectsEnabled=t}getCurrentTime(){return this.isPlaying&&this.audioContext?this.audioContext.currentTime-this.startTime:this.pauseTime||0}getCurrentPosition(){return this.getCurrentTime()}getDuration(){return this.audioBuffer?this.audioBuffer.duration:0}setAudioContext(t,n,r){this.audioContext=t,this.gainNode=n,this.analyserNode=r}destroy(){if(super.destroy(),this.stopRendering(),this.audioSource){try{this.audioSource.stop()}catch{}this.audioSource=null}this.audioBuffer=null,this.cdgPlayer=null,this.cdgData=null}getFormat(){return"cdg"}}class Lp{constructor(t=null){this.kaiPlayer=t,this.karaokeRenderer=new Mp("karaokeCanvas"),this.cdgPlayer=new Ip("karaokeCanvas"),this.currentFormat=null,this.currentPlayer=null,setTimeout(()=>{this.karaokeRenderer&&this.karaokeRenderer.resizeHandler&&this.karaokeRenderer.resizeHandler()},200),this.isPlaying=!1,this.init()}init(){this.setupEventListeners(),this.updateTimer=setInterval(()=>{this.isPlaying&&this.updatePosition()},100)}setupEventListeners(){}onSongLoaded(t){var s,i;let n=((s=this.currentPlayer)==null?void 0:s.getDuration())||(t==null?void 0:t.duration)||0;if(n===0&&(t!=null&&t.lyrics)&&Array.isArray(t.lyrics)){let a=0;for(const l of t.lyrics){const c=l.end||l.end_time||(l.start||l.time||0)+3;a=Math.max(a,c)}a>0&&(n=a+10)}const r=(t==null?void 0:t.lyrics)||null;if(r&&this.karaokeRenderer.loadLyrics(r,n),(i=t==null?void 0:t.audio)!=null&&i.sources){const a=t.audio.sources.find(c=>{var u;return c.name==="vocals"||((u=c.filename)==null?void 0:u.includes("vocals"))});a&&a.audioData&&this.karaokeRenderer.setVocalsAudio(a.audioData);const l=t.audio.sources.find(c=>{var u,h;return c.name==="music"||c.name==="instrumental"||c.name==="backing"||((u=c.filename)==null?void 0:u.includes("music"))||((h=c.filename)==null?void 0:h.includes("instrumental"))});if(l&&l.audioData)this.karaokeRenderer.setMusicAudio(l.audioData);else{const c=t.audio.sources.find(u=>{var h;return u.name!=="vocals"&&!((h=u.filename)!=null&&h.includes("vocals"))&&u.audioData});c&&c.audioData&&this.karaokeRenderer.setMusicAudio(c.audioData)}}this.pause()}updatePosition(){if(this.currentPlayer&&this.karaokeRenderer){const t=this.currentPlayer.getCurrentPosition();this.karaokeRenderer.setCurrentTime(t)}}async setPosition(t){if(!this.currentPlayer)return;const n=this.currentPlayer.getDuration(),r=Math.max(0,Math.min(n,t));try{await this.currentPlayer.seek(r)}catch(s){console.error("Seek error:",s)}this.karaokeRenderer&&(this.karaokeRenderer.setCurrentTime(r),this.karaokeRenderer.lockedUpcomingIndex=null)}async play(){this.isPlaying=!0,this.karaokeRenderer&&this.karaokeRenderer.setPlaying(!0)}async pause(){this.isPlaying=!1,this.karaokeRenderer&&this.karaokeRenderer.setPlaying(!1)}destroy(){this.updateTimer&&clearInterval(this.updateTimer),this.karaokeRenderer&&this.karaokeRenderer.destroy()}}class Rp{constructor(){this.senderPC=null,this.receiverPC=null,this.canvasStream=null,this.streamCaptureCanvas=null,this.streamingToChild=!1,this.pendingICECandidates=[],this.receiverPendingICE=[]}async setupSender(){try{console.log(" Setting up WebRTC sender");const t=document.getElementById("karaokeCanvas");if(!t)return{success:!1,error:"Canvas not found"};if(!this.streamCaptureCanvas){this.streamCaptureCanvas=document.createElement("canvas"),this.streamCaptureCanvas.width=1920,this.streamCaptureCanvas.height=1080,this.streamCaptureCanvas.style.display="none",document.body.appendChild(this.streamCaptureCanvas),this.canvasStream=this.streamCaptureCanvas.captureStream(60);const l=this.canvasStream.getVideoTracks()[0].getSettings();console.log(" Capture stream resolution:",l.width,"x",l.height),(l.width!==1920||l.height!==1080)&&console.error(" CAPTURE STREAM NOT 1080p! Actual:",l.width,"x",l.height)}const n=this.streamCaptureCanvas.getContext("2d"),r=()=>{this.streamingToChild&&(n.drawImage(t,0,0,1920,1080),requestAnimationFrame(r))};this.streamingToChild=!0,r();const s=this.canvasStream;if(s.getVideoTracks().length===0)return{success:!1,error:"No video track"};const i=new RTCPeerConnection({iceServers:[],iceCandidatePoolSize:10,bundlePolicy:"balanced",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});return s.getTracks().forEach(a=>{console.log(" Adding track:",a.kind),a.kind==="video"&&a.applyConstraints({width:{exact:1920},height:{exact:1080},frameRate:{exact:60}}).then(()=>{console.log(" Applied 1920x1080 constraints to track")}).catch(c=>{console.error(" Failed to apply constraints:",c)});const l=i.addTransceiver(a,{direction:"sendonly",streams:[s]});if(a.kind==="video"){const c=l.sender,u=async()=>{try{const h=c.getParameters();h.degradationPreference="maintain-resolution",h.encodings&&h.encodings.length>0&&(h.encodings[0].maxBitrate=5e7,h.encodings[0].maxFramerate=60,h.encodings[0].scaleResolutionDownBy=1,h.encodings[0].minBitrate=1e7),await c.setParameters(h),console.log(" Set maintain-resolution + no downscaling")}catch(h){console.error(" Failed to set encoding parameters:",h)}};u(),setTimeout(u,2e3),setTimeout(u,5e3)}}),i.onicecandidate=a=>{a.candidate&&(console.log(" Sender ICE candidate"),window.kaiAPI.canvas.sendICECandidate("sender",{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex}))},this.senderPC=i,console.log(" Sender setup complete"),{success:!0}}catch(t){return console.error(" Sender error:",t),{success:!1,error:t.message}}}async createOffer(){try{console.log(" Creating offer..."),this.senderPC.getTransceivers().forEach(r=>{if(r.sender&&r.sender.track&&r.sender.track.kind==="video"){const s=RTCRtpSender.getCapabilities("video");console.log(" Available video codecs:",s.codecs.map(a=>a.mimeType));const i=s.codecs.filter(a=>{var l;return!!(a.mimeType.includes("H264")&&((l=a.sdpFmtpLine)!=null&&l.includes("profile-level-id=42e01f"))||a.mimeType.includes("VP8"))}).sort((a,l)=>a.mimeType.includes("H264")?-1:l.mimeType.includes("H264")?1:0);i.length>0?(r.setCodecPreferences(i),console.log(" Set preferred codec for 1080p:",i[0].mimeType)):console.warn(" No preferred codecs found, using default")}});const n=await this.senderPC.createOffer({offerToReceiveVideo:!1,voiceActivityDetection:!1});return console.log(" Offer created"),console.log(" Setting local description..."),await this.senderPC.setLocalDescription(n),console.log(" Local description set on sender"),console.log(" Using original SDP - relying on encoding parameters for quality"),{type:n.type,sdp:n.sdp}}catch(t){return console.error(" Error in sender offer creation:",t),{error:t.message,stack:t.stack}}}async setAnswer(t){try{if(console.log(" Setting answer in sender..."),await this.senderPC.setRemoteDescription(new RTCSessionDescription(t)),console.log(" Remote description set on sender"),this.pendingICECandidates.length>0){console.log(` Flushing ${this.pendingICECandidates.length} pending ICE candidates`);for(const n of this.pendingICECandidates)try{await this.senderPC.addIceCandidate(new RTCIceCandidate(n)),console.log(" Added queued ICE candidate to sender")}catch(r){console.error(" Failed to add queued ICE candidate:",r)}this.pendingICECandidates=[]}return{success:!0}}catch(n){return console.error(" Error setting answer:",n),{success:!1,error:n.message}}}stopPainting(){this.streamingToChild=!1,console.log(" Stopped painting to capture canvas - child window closed")}getSenderStatus(){return this.senderPC?{connectionState:this.senderPC.connectionState,iceConnectionState:this.senderPC.iceConnectionState,iceGatheringState:this.senderPC.iceGatheringState}:{error:"Sender PC not initialized"}}async addICECandidate(t){if(!this.senderPC){console.warn(" Sender PC not initialized, ignoring ICE candidate");return}if(!this.senderPC.remoteDescription){console.log(" Queueing ICE candidate (remote description not set yet)"),this.pendingICECandidates.push(t);return}try{await this.senderPC.addIceCandidate(new RTCIceCandidate(t)),console.log(" Added ICE candidate to sender")}catch(n){console.error(" Failed to add ICE candidate:",n)}}async cleanupSender(){if(this.senderPC){try{this.senderPC.close(),console.log(" Sender PC closed")}catch(t){console.error("Error closing sender PC:",t)}this.senderPC=null}this.streamingToChild=!1,this.pendingICECandidates=[]}async setupReceiver(){try{console.log(" Setting up WebRTC receiver");const t=document.getElementById("video");if(!t)return{success:!1,error:"Video element not found"};const n=new RTCPeerConnection({iceServers:[],iceCandidatePoolSize:10,bundlePolicy:"balanced",rtcpMuxPolicy:"require"});return n.onicecandidate=r=>{if(r.candidate){console.log(" Receiver ICE candidate");const{ipcRenderer:s}=require("electron");s.invoke("canvas:sendICECandidate","receiver",{candidate:r.candidate.candidate,sdpMid:r.candidate.sdpMid,sdpMLineIndex:r.candidate.sdpMLineIndex})}},n.ontrack=r=>{console.log(" Received stream"),t.srcObject=r.streams[0],console.log(" Connected stream to video")},this.receiverPC=n,console.log(" Receiver setup complete"),{success:!0}}catch(t){return console.error(" Receiver error:",t),{success:!1,error:t.message}}}async setOfferAndCreateAnswer(t){try{if(!this.receiverPC)throw new Error("receiverPC not available");if(console.log(" Received offer in child window:",t.type),console.log(" Setting remote description..."),await this.receiverPC.setRemoteDescription(t),console.log(" Remote description set on receiver"),this.receiverPendingICE.length>0){console.log(` Flushing ${this.receiverPendingICE.length} pending ICE candidates`);for(const r of this.receiverPendingICE)try{await this.receiverPC.addIceCandidate(new RTCIceCandidate(r)),console.log(" Added queued ICE candidate to receiver")}catch(s){console.error(" Failed to add queued ICE candidate:",s)}this.receiverPendingICE=[]}console.log(" Creating answer...");const n=await this.receiverPC.createAnswer();return console.log(" Answer created:",n.type,n.sdp.length,"chars"),console.log(" Setting local description on receiver..."),await this.receiverPC.setLocalDescription(n),console.log(" Local description set on receiver"),{type:n.type,sdp:n.sdp}}catch(n){return console.error(" Error in receiver answer creation:",n),{error:n.message,stack:n.stack}}}async addReceiverICECandidate(t){if(!this.receiverPC){console.warn(" Receiver PC not initialized, ignoring ICE candidate");return}if(!this.receiverPC.remoteDescription){console.log(" Queueing ICE candidate for receiver (remote description not set yet)"),this.receiverPendingICE.push(t);return}try{await this.receiverPC.addIceCandidate(new RTCIceCandidate(t)),console.log(" Added ICE candidate to receiver")}catch(n){console.error(" Failed to add ICE candidate to receiver:",n)}}getReceiverStatus(){return this.receiverPC?{connectionState:this.receiverPC.connectionState,iceConnectionState:this.receiverPC.iceConnectionState,iceGatheringState:this.receiverPC.iceGatheringState}:{error:"Receiver PC not initialized"}}checkReceiverReady(){return{ready:!0,hasReceiverPC:!!this.receiverPC}}async cleanupReceiver(){if(this.receiverPC){try{this.receiverPC.close(),console.log(" Receiver PC closed")}catch(t){console.error("Error closing receiver PC:",t)}this.receiverPC=null}this.receiverPendingICE=[]}}const Kt=new Rp;class Dp{constructor(){this.currentSong=null,this.isPlaying=!1,this.currentPosition=0,this.devices=[],this.player=null,this.coaching=null,this.kaiPlayer=null,this.devicePreferences={PA:null,IEM:null,input:null},this.waveformPreferences={enableWaveforms:!0,micToSpeakers:!0,enableMic:!0,enableEffects:!0,randomEffectOnSong:!1,disabledEffects:[],overlayOpacity:.7,showUpcomingLyrics:!0},this.autoTunePreferences={enabled:!1,strength:50,speed:20},this.randomEffectTimeout=null,this.effectsData=null,Ep(this),this.init()}async init(){try{await this.setupEventListeners(),this.kaiPlayer=new jp,await this.kaiPlayer.initialize()}catch(t){console.error("Error during KaiPlayerApp init:",t);return}this.autoTunePreferences&&this.kaiPlayer&&this.kaiPlayer.setAutoTuneSettings&&this.kaiPlayer.setAutoTuneSettings(this.autoTunePreferences),this.kaiPlayer&&this.kaiPlayer.setOnSongEndedCallback(()=>{this.handleSongEnded()}),this.player=new Lp(this.kaiPlayer),Xh("player:initialized",{app:this,player:this.player}),await this.loadAndApplyAudioSettings(),this.player.karaokeRenderer&&(this.player.karaokeRenderer.waveformPreferences={...this.waveformPreferences}),this.updateStatus("Ready"),this.setupAdminIPCListeners(),await kaiAPI.app.getVersion()}async setupEventListeners(){window.kaiAPI&&window.kaiAPI.events&&(window.kaiAPI.events.on("preferences:updated",(n,r)=>{this.syncPreferencesFromMain(r)}),window.kaiAPI.events.on("waveform:settingsChanged",(n,r)=>{const s=this.player;if(!s)return;const i=s.currentFormat,a=s.karaokeRenderer,l=s.cdgPlayer;i==="kai"&&a?(r.enableWaveforms!==void 0&&a.setWaveformsEnabled(r.enableWaveforms),r.enableEffects!==void 0&&a.setEffectsEnabled(r.enableEffects),r.showUpcomingLyrics!==void 0&&a.setShowUpcomingLyrics(r.showUpcomingLyrics),r.overlayOpacity!==void 0&&(a.waveformPreferences.overlayOpacity=r.overlayOpacity)):i==="cdg"&&l&&(r.enableEffects!==void 0&&l.setEffectsEnabled(r.enableEffects),r.overlayOpacity!==void 0&&l.setOverlayOpacity(r.overlayOpacity))}),window.kaiAPI.events.on("autotune:settingsChanged",(n,r)=>{r.enabled!==void 0&&window.kaiAPI.autotune.setEnabled(r.enabled),(r.strength!==void 0||r.speed!==void 0)&&window.kaiAPI.autotune.setSettings(r)}),window.kaiAPI.events.on("player:togglePlayback",()=>{this.togglePlayback()}),window.kaiAPI.events.on("player:restart",()=>{this.restartTrack()}),window.kaiAPI.events.on("player:setPosition",(n,r)=>{var s;(s=this.player)==null||s.setPosition(r)}),window.kaiAPI.events.on("webrtc:setupSender",async()=>{const n=await Kt.setupSender(),{ipcRenderer:r}=require("electron");r.send("webrtc:setupSender-response",n)}),window.kaiAPI.events.on("webrtc:createOffer",async()=>{const n=await Kt.createOffer(),{ipcRenderer:r}=require("electron");r.send("webrtc:createOffer-response",n)}),window.kaiAPI.events.on("webrtc:setAnswer",async(n,r)=>{const s=await Kt.setAnswer(r),{ipcRenderer:i}=require("electron");i.send("webrtc:setAnswer-response",s)}),window.kaiAPI.events.on("webrtc:stopPainting",()=>{Kt.stopPainting()}),window.kaiAPI.events.on("webrtc:getSenderStatus",()=>{const n=Kt.getSenderStatus(),{ipcRenderer:r}=require("electron");r.send("webrtc:getSenderStatus-response",n)}),window.kaiAPI.events.on("webrtc:addICECandidate",async(n,r)=>{await Kt.addICECandidate(r)}),window.kaiAPI.events.on("webrtc:cleanupSender",async()=>{await Kt.cleanupSender()})),document.getElementById("karaokeCanvas").addEventListener("click",()=>{this.toggleCanvasFullscreen()}),document.addEventListener("fullscreenchange",()=>{}),document.addEventListener("fullscreenerror",n=>{console.error(" Canvas fullscreen error:",n)}),kaiAPI.mixer.onStateChange((n,r)=>{}),kaiAPI.events.on("effects:getList",n=>{var r;if((r=this.effectsData)!=null&&r.effects){const s=this.effectsData.effects.map(i=>({name:i.name,displayName:i.displayName||i.name,author:i.author||"Unknown",category:i.category||"uncategorized"}));n.sender.send("effects:getList-response",s)}else n.sender.send("effects:getList-response",[])}),kaiAPI.events.on("effects:getCurrent",n=>{var s;const r=((s=this.effectsData)==null?void 0:s.currentEffect)||null;n.sender.send("effects:getCurrent-response",r)}),kaiAPI.events.on("effects:getDisabled",n=>{var s;const r=((s=this.effectsData)==null?void 0:s.disabledEffects)||[];n.sender.send("effects:getDisabled-response",r)}),kaiAPI.mixer.onSetMasterGain((n,r)=>{const{bus:s,gainDb:i}=r;this.kaiPlayer&&this.kaiPlayer.setMasterGain(s,i)}),kaiAPI.mixer.onToggleMasterMute((n,r)=>{const{bus:s,muted:i}=r;this.kaiPlayer&&(i!==void 0?this.kaiPlayer.setMasterMute(s,i):this.kaiPlayer.toggleMasterMute(s))}),kaiAPI.mixer.onSetMasterMute((n,r)=>{const{bus:s,muted:i}=r;this.kaiPlayer&&this.kaiPlayer.setMasterMute(s,i)}),kaiAPI.song.onLoaded((n,r)=>{this.onSongLoaded(r)}),kaiAPI.song.onData(async(n,r)=>{var l,c,u,h,d;const s=this.currentSong&&this.currentSong.originalFilePath===r.originalFilePath;this.currentSong=r,s||(this.isPlaying=!1,this.kaiPlayer&&await this.kaiPlayer.pause(),(c=(l=this.player)==null?void 0:l.cdgPlayer)!=null&&c.isPlaying&&this.player.cdgPlayer.pause(),(h=(u=this.player)==null?void 0:u.currentPlayer)!=null&&h.isPlaying&&await this.player.currentPlayer.pause(),(d=this.player)!=null&&d.currentPlayer&&(this.player.currentPlayer.isPlaying=!1,this.player.currentPlayer.reportStateChange()));const i=this._pendingMetadata||r.metadata||{};r.format==="cdg"?await Np(this,r,i):await Ap(this,r,i),this._pendingMetadata=null})}async loadKaiFile(){var t,n,r,s;try{this.isPlaying=!1,this.kaiPlayer&&await this.kaiPlayer.pause(),(n=(t=this.player)==null?void 0:t.cdgPlayer)!=null&&n.isPlaying&&this.player.cdgPlayer.pause(),(r=this.player)!=null&&r.currentPlayer&&await this.player.currentPlayer.pause(),this.updateStatus("Loading KAI file...");const i=await kaiAPI.file.openKai();i&&i.success?(this.currentSong=i,this.updateStatus(`Loaded: ${((s=i.metadata)==null?void 0:s.title)||"Unknown Song"}`)):i&&this.updateStatus(`Error: ${i.error}`)}catch(i){console.error("Failed to load KAI file:",i),this.updateStatus("Error loading file")}}async onSongLoaded(t){this.kaiPlayer&&await this.kaiPlayer.pause(),this.player&&(await this.player.pause(),this.player.cdgPlayer&&this.player.cdgPlayer.isPlaying&&this.player.cdgPlayer.pause()),console.log(" Song loading started:",t),this._pendingMetadata=t}async togglePlayback(){var t,n,r,s;if(this.currentSong)try{this.isPlaying?((t=this.player)!=null&&t.currentPlayer&&await this.player.currentPlayer.pause(),this.isPlaying=!1,this.player&&await this.player.pause(),(n=this.player)!=null&&n.currentPlayer&&this.player.currentPlayer.reportStateChange()):(this.isPlaying=!0,(r=this.player)!=null&&r.currentPlayer&&await this.player.currentPlayer.play(),this.player&&await this.player.play(),(s=this.player)!=null&&s.currentPlayer&&this.player.currentPlayer.reportStateChange())}catch(i){console.error("Playback error:",i),this.updateStatus("Playback error")}}broadcastPlaybackState(){const t=this.kaiPlayer?this.kaiPlayer.getCurrentPosition():0,n=this.kaiPlayer?this.kaiPlayer.getDuration():0;typeof kaiAPI<"u"&&kaiAPI.renderer&&kaiAPI.renderer.sendPlaybackState({isPlaying:this.isPlaying,position:t,duration:n})}async handleSongEnded(){var t;this.isPlaying=!1,this.player&&(this.player.isPlaying=!1,this.player.karaokeRenderer&&this.player.karaokeRenderer.setPlaying(!1)),(t=this.player)!=null&&t.currentPlayer&&(this.player.currentPlayer.isPlaying=!1,this.player.currentPlayer.reportStateChange()),this.updateStatus("Song ended");try{const n=await kaiAPI.player.next();n.success&&n.song?(console.log(" Auto-loaded next song from queue:",n.song.title),this.updateStatus(`Loaded: ${n.song.title}`)):this.updateStatus("Queue empty")}catch(n){console.error("Failed to auto-load next song:",n)}}async seekRelative(t){if(!this.currentSong||!this.kaiPlayer)return;const n=Math.max(0,this.kaiPlayer.getCurrentPosition()+t);await this.kaiPlayer.seek(n)}async restartTrack(){var t;this.currentSong&&(t=this.player)!=null&&t.currentPlayer&&await this.player.currentPlayer.seek(0)}async nextTrack(){var t,n,r;this.isPlaying=!1,this.kaiPlayer&&await this.kaiPlayer.pause(),(n=(t=this.player)==null?void 0:t.cdgPlayer)!=null&&n.isPlaying&&this.player.cdgPlayer.pause(),(r=this.player)!=null&&r.currentPlayer&&(await this.player.currentPlayer.pause(),this.player.currentPlayer.isPlaying=!1,this.player.currentPlayer.reportStateChange());try{(await kaiAPI.player.next()).success}catch(s){console.error("Failed to play next track:",s)}}updateStatus(t){}async loadDevicePreferences(){try{const t=await window.kaiAPI.settings.get("devicePreferences",null);t&&(this.devicePreferences={...this.devicePreferences,...t})}catch(t){console.warn("Failed to load device preferences:",t)}}async saveDevicePreferences(){try{await window.kaiAPI.settings.set("devicePreferences",this.devicePreferences)}catch(t){console.warn("Failed to save device preferences:",t)}}async loadAndApplyAudioSettings(){try{const t=await window.kaiAPI.settings.get("micToSpeakers",!0),n=await window.kaiAPI.settings.get("enableMic",!0);this.player&&this.player.karaokeRenderer&&(this.player.karaokeRenderer.waveformPreferences.micToSpeakers=t,this.player.karaokeRenderer.waveformPreferences.enableMic=n)}catch(t){console.error("Failed to load audio settings:",t)}}async saveWaveformPreferences(){try{await window.kaiAPI.settings.set("waveformPreferences",this.waveformPreferences)}catch(t){console.warn("Failed to save waveform preferences:",t)}}syncPreferencesFromMain(t){var n,r;if(t.autoTune&&(this.autoTunePreferences={...this.autoTunePreferences,...t.autoTune},this.kaiPlayer&&this.kaiPlayer.setAutoTuneSettings(this.autoTunePreferences)),t.effects||t.enableWaveforms!==void 0){const s={enableWaveforms:t.enableWaveforms,enableEffects:t.enableEffects,randomEffectOnSong:t.randomEffectOnSong,overlayOpacity:t.overlayOpacity,showUpcomingLyrics:t.showUpcomingLyrics};Object.assign(this.waveformPreferences,s),this.player&&this.player.karaokeRenderer&&(this.player.karaokeRenderer.waveformPreferences={...this.waveformPreferences})}if(t.microphone){if(t.microphone.enabled!==void 0&&this.kaiPlayer)if(t.microphone.enabled){const s=((r=(n=this.devicePreferences)==null?void 0:n.input)==null?void 0:r.id)||this.kaiPlayer.inputDevice||"default";this.kaiPlayer.startMicrophoneInput(s)}else this.kaiPlayer.stopMicrophoneInput();t.microphone.gain!==void 0&&this.kaiPlayer&&this.kaiPlayer.setMicrophoneGain(t.microphone.gain)}t.iemMonoVocals!==void 0&&this.kaiPlayer&&this.kaiPlayer.setIEMMonoVocals(t.iemMonoVocals)}async saveAutoTunePreferences(){try{await window.kaiAPI.settings.set("autoTunePreferences",this.autoTunePreferences)}catch(t){console.warn("Failed to save auto-tune preferences:",t)}}async saveDevicePreference(t,n){try{const r=this.devices.find(s=>(s.id||s.deviceId)===n);r?this.devicePreferences[t]={id:n,name:r.name||r.label,deviceKind:r.deviceKind}:this.devicePreferences[t]={id:n},await window.kaiAPI.settings.set("devicePreferences",this.devicePreferences)}catch(r){console.warn("Failed to save device preference:",r)}}updateEffectDisplay(){}async toggleCanvasFullscreen(){try{const t=document.getElementById("karaokeCanvas");document.fullscreenElement?await document.exitFullscreen():await t.requestFullscreen()}catch(t){console.error(" Fullscreen toggle error:",t)}}setupAdminIPCListeners(){var t;(t=window.kaiAPI)!=null&&t.mixer&&(window.kaiAPI.mixer.onSetMasterGain((n,r)=>{const{bus:s,gainDb:i}=r;this.kaiPlayer&&this.kaiPlayer.setMasterGain(s,i)}),window.kaiAPI.mixer.onToggleMasterMute((n,r)=>{const{bus:s,muted:i}=r;this.kaiPlayer&&(i!==void 0?this.kaiPlayer.setMasterMute(s,i):this.kaiPlayer.toggleMasterMute(s))}))}}console.log(" Initializing application...");const Ke=po.getInstance();Qh(async()=>{console.log(" DOM ready, initializing app..."),Cp(),new Dp,await Ke.connect(),console.log(" ElectronBridge connected"),_p()});function _p(){console.log(" Mounting React components...");const e=document.getElementById("react-library-root");e&&(_e.createRoot(e).render(o.jsx(Qe.StrictMode,{children:o.jsx(Zh,{bridge:Ke,showSetFolder:!0,showFullRefresh:!0})})),console.log(" LibraryPanel mounted in library tab"));const t=document.getElementById("react-effects-root");t&&(_e.createRoot(t).render(o.jsx(Qe.StrictMode,{children:o.jsx(tp,{bridge:Ke})})),console.log(" EffectsPanel mounted in effects tab"));const n=document.getElementById("react-requests-root");n&&(_e.createRoot(n).render(o.jsx(Qe.StrictMode,{children:o.jsx(rp,{})})),console.log(" RequestsList mounted in requests tab"));const r=document.getElementById("react-editor-root");r&&(_e.createRoot(r).render(o.jsx(Qe.StrictMode,{children:o.jsx(up,{bridge:Ke})})),console.log(" SongEditor mounted in editor tab"));const s=document.getElementById("react-queue-root");s&&(_e.createRoot(s).render(o.jsx(Qe.StrictMode,{children:o.jsx(mp,{bridge:Ke})})),console.log(" QueueTab mounted in player sidebar"));const i=document.getElementById("mixer-tab");i&&(i.innerHTML='<div id="react-mixer-root"></div>',_e.createRoot(document.getElementById("react-mixer-root")).render(o.jsx(Qe.StrictMode,{children:o.jsx(hp,{bridge:Ke})})),console.log(" MixerTab mounted in mixer tab"));const a=document.getElementById("server-tab");a&&(a.innerHTML='<div id="react-server-root"></div>',_e.createRoot(document.getElementById("react-server-root")).render(o.jsx(Qe.StrictMode,{children:o.jsx(kp,{bridge:Ke})})),console.log(" ServerTab mounted in server tab"));const l=document.getElementById("react-song-info-root");l&&(_e.createRoot(l).render(o.jsx(Qe.StrictMode,{children:o.jsx(yp,{bridge:Ke})})),console.log(" SongInfoBar mounted"));const c=document.getElementById("react-transport-root");c&&(_e.createRoot(c).render(o.jsx(Qe.StrictMode,{children:o.jsx(wp,{bridge:Ke})})),console.log(" TransportControls mounted"));const u=document.getElementById("react-tab-nav-root");u&&(_e.createRoot(u).render(o.jsx(Qe.StrictMode,{children:o.jsx(Sp,{requestsCount:0})})),console.log(" TabNavigation mounted"));const h=document.getElementById("react-status-bar-root");h&&(_e.createRoot(h).render(o.jsx(Qe.StrictMode,{children:o.jsx(xp,{bridge:Ke})})),console.log(" StatusBar mounted"));const d=document.getElementById("react-visualization-root");d&&(_e.createRoot(d).render(o.jsx(Qe.StrictMode,{children:o.jsx(Pp,{bridge:Ke})})),console.log(" VisualizationSettings mounted")),console.log(" React mounted successfully!")}Yh(()=>{Ke.disconnect()});
//# sourceMappingURL=renderer.js.map
